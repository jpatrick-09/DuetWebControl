{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\store\\observer.js","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\store\\observer.js","mtime":1592248188730},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5lbmRzLXdpdGgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3RhcnRzLXdpdGgiOwppbXBvcnQgeyBkZWZhdWx0TWFjaGluZSB9IGZyb20gJy4vbWFjaGluZSc7CnZhciBzZXR0aW5nc1RpbWVyLAogICAgbWFjaGluZVNldHRpbmdzVGltZXIgPSB7fSwKICAgIG1hY2hpbmVDYWNoZVRpbWVyID0ge307CmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIChzdG9yZSkgewogIC8vIE9ic2VydmUgdGhlIG11dGF0aW9ucyBvZiB0aGUgc3RvcmUgYW5kIG1ha2Ugc3VyZSB0aGUgY2FjaGUgYW5kCiAgLy8gc2V0dGluZ3MgYXJlIHNhdmVkIGF1dG9tYXRpY2FsbHkgYWZ0ZXIgYSBjZXJ0YWluIGRlYm91bmNlIGRlbGF5CiAgc3RvcmUuc3Vic2NyaWJlKGZ1bmN0aW9uIChtdXRhdGlvbiwgc3RhdGUpIHsKICAgIGlmICghbXV0YXRpb24udHlwZS5lbmRzV2l0aCgnL2xvYWQnKSAmJiAhbXV0YXRpb24udHlwZS5lbmRzV2l0aCgnL3NldExhc3RIb3N0bmFtZScpKSB7CiAgICAgIHZhciBtYWNoaW5lTWF0Y2hlcyA9IC9ebWFjaGluZXNcLyguKylcLy8uZXhlYyhtdXRhdGlvbi50eXBlKTsKICAgICAgdmFyIG1hY2hpbmUgPSBtYWNoaW5lTWF0Y2hlcyA/IG1hY2hpbmVNYXRjaGVzWzFdIDogc3RhdGUuc2VsZWN0ZWRNYWNoaW5lOwoKICAgICAgaWYgKG1hY2hpbmUgPT09IGRlZmF1bHRNYWNoaW5lKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAobXV0YXRpb24udHlwZS5zdGFydHNXaXRoKCdzZXR0aW5ncycpKSB7CiAgICAgICAgLy8gR2xvYmFsIHNldHRpbmdzIGhhdmUgY2hhbmdlZAogICAgICAgIGlmIChzZXR0aW5nc1RpbWVyKSB7CiAgICAgICAgICBjbGVhclRpbWVvdXQoc2V0dGluZ3NUaW1lcik7CiAgICAgICAgfQoKICAgICAgICBzZXR0aW5nc1RpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBzZXR0aW5nc1RpbWVyID0gdW5kZWZpbmVkOwogICAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ3NldHRpbmdzL3NhdmUnKTsKICAgICAgICB9LCBzdG9yZS5zdGF0ZS5zZXR0aW5ncy5zZXR0aW5nc1NhdmVEZWxheSk7CiAgICAgIH0gZWxzZSBpZiAobXV0YXRpb24udHlwZS5pbmRleE9mKCcvc2V0dGluZ3MvJykgIT09IC0xKSB7CiAgICAgICAgLy8gTWFjaGluZSBzZXR0aW5ncyBoYXZlIGNoYW5nZWQKICAgICAgICBpZiAobWFjaGluZVNldHRpbmdzVGltZXJbbWFjaGluZV0pIHsKICAgICAgICAgIGNsZWFyVGltZW91dChtYWNoaW5lU2V0dGluZ3NUaW1lclttYWNoaW5lXSk7CiAgICAgICAgfQoKICAgICAgICBtYWNoaW5lU2V0dGluZ3NUaW1lclttYWNoaW5lXSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgbWFjaGluZVNldHRpbmdzVGltZXJbbWFjaGluZV0gPSB1bmRlZmluZWQ7CgogICAgICAgICAgaWYgKHN0b3JlLnN0YXRlLm1hY2hpbmVzW21hY2hpbmVdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgc3RvcmUuZGlzcGF0Y2goIm1hY2hpbmVzLyIuY29uY2F0KG1hY2hpbmUsICIvc2V0dGluZ3Mvc2F2ZSIpKTsKICAgICAgICAgIH0KICAgICAgICB9LCBzdG9yZS5zdGF0ZS5zZXR0aW5ncy5zZXR0aW5nc1NhdmVEZWxheSk7CiAgICAgIH0gZWxzZSBpZiAobXV0YXRpb24udHlwZS5pbmRleE9mKCcvY2FjaGUvJykgIT09IC0xKSB7CiAgICAgICAgLy8gTWFjaGluZSBjYWNoZSBoYXMgY2hhbmdlZAogICAgICAgIGlmIChtYWNoaW5lQ2FjaGVUaW1lclttYWNoaW5lXSkgewogICAgICAgICAgY2xlYXJUaW1lb3V0KG1hY2hpbmVDYWNoZVRpbWVyW21hY2hpbmVdKTsKICAgICAgICB9CgogICAgICAgIG1hY2hpbmVDYWNoZVRpbWVyW21hY2hpbmVdID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBtYWNoaW5lQ2FjaGVUaW1lclttYWNoaW5lXSA9IHVuZGVmaW5lZDsKCiAgICAgICAgICBpZiAoc3RvcmUuc3RhdGUubWFjaGluZXNbbWFjaGluZV0gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBzdG9yZS5kaXNwYXRjaCgibWFjaGluZXMvIi5jb25jYXQobWFjaGluZSwgIi9jYWNoZS9zYXZlIikpOwogICAgICAgICAgfQogICAgICAgIH0sIHN0b3JlLnN0YXRlLnNldHRpbmdzLmNhY2hlU2F2ZURlbGF5KTsKICAgICAgfQogICAgfQogIH0pOwp9"},{"version":3,"sources":["C:/Users/jpatrick/Documents/GitHub/DuetWebControl_Fork/src/store/observer.js"],"names":["defaultMachine","settingsTimer","machineSettingsTimer","machineCacheTimer","store","subscribe","mutation","state","type","endsWith","machineMatches","exec","machine","selectedMachine","startsWith","clearTimeout","setTimeout","undefined","dispatch","settings","settingsSaveDelay","indexOf","machines","cacheSaveDelay"],"mappings":"AAAA;;;;;;AAEA,SAASA,cAAT,QAA+B,WAA/B;AAEA,IAAIC,aAAJ;AAAA,IAAmBC,oBAAoB,GAAG,EAA1C;AAAA,IAA8CC,iBAAiB,GAAG,EAAlE;AAEA,eAAe,UAASC,KAAT,EAAgB;AAC9B;AACA;AACAA,EAAAA,KAAK,CAACC,SAAN,CAAgB,UAASC,QAAT,EAAmBC,KAAnB,EAA0B;AACzC,QAAI,CAACD,QAAQ,CAACE,IAAT,CAAcC,QAAd,CAAuB,OAAvB,CAAD,IAAoC,CAACH,QAAQ,CAACE,IAAT,CAAcC,QAAd,CAAuB,kBAAvB,CAAzC,EAAqF;AACpF,UAAMC,cAAc,GAAG,oBAAoBC,IAApB,CAAyBL,QAAQ,CAACE,IAAlC,CAAvB;AACA,UAAMI,OAAO,GAAGF,cAAc,GAAGA,cAAc,CAAC,CAAD,CAAjB,GAAuBH,KAAK,CAACM,eAA3D;;AACA,UAAID,OAAO,KAAKZ,cAAhB,EAAgC;AAC/B;AACA;;AAED,UAAIM,QAAQ,CAACE,IAAT,CAAcM,UAAd,CAAyB,UAAzB,CAAJ,EAA0C;AACzC;AACA,YAAIb,aAAJ,EAAmB;AAClBc,UAAAA,YAAY,CAACd,aAAD,CAAZ;AACA;;AAEDA,QAAAA,aAAa,GAAGe,UAAU,CAAC,YAAW;AACrCf,UAAAA,aAAa,GAAGgB,SAAhB;AACAb,UAAAA,KAAK,CAACc,QAAN,CAAe,eAAf;AACA,SAHyB,EAGvBd,KAAK,CAACG,KAAN,CAAYY,QAAZ,CAAqBC,iBAHE,CAA1B;AAIA,OAVD,MAUO,IAAId,QAAQ,CAACE,IAAT,CAAca,OAAd,CAAsB,YAAtB,MAAwC,CAAC,CAA7C,EAAgD;AACtD;AACA,YAAInB,oBAAoB,CAACU,OAAD,CAAxB,EAAmC;AAClCG,UAAAA,YAAY,CAACb,oBAAoB,CAACU,OAAD,CAArB,CAAZ;AACA;;AAEDV,QAAAA,oBAAoB,CAACU,OAAD,CAApB,GAAgCI,UAAU,CAAC,YAAW;AACrDd,UAAAA,oBAAoB,CAACU,OAAD,CAApB,GAAgCK,SAAhC;;AACA,cAAIb,KAAK,CAACG,KAAN,CAAYe,QAAZ,CAAqBV,OAArB,MAAkCK,SAAtC,EAAiD;AAChDb,YAAAA,KAAK,CAACc,QAAN,oBAA2BN,OAA3B;AACA;AACD,SALyC,EAKvCR,KAAK,CAACG,KAAN,CAAYY,QAAZ,CAAqBC,iBALkB,CAA1C;AAMA,OAZM,MAYA,IAAId,QAAQ,CAACE,IAAT,CAAca,OAAd,CAAsB,SAAtB,MAAqC,CAAC,CAA1C,EAA6C;AACnD;AACA,YAAIlB,iBAAiB,CAACS,OAAD,CAArB,EAAgC;AAC/BG,UAAAA,YAAY,CAACZ,iBAAiB,CAACS,OAAD,CAAlB,CAAZ;AACA;;AAEDT,QAAAA,iBAAiB,CAACS,OAAD,CAAjB,GAA6BI,UAAU,CAAC,YAAW;AAClDb,UAAAA,iBAAiB,CAACS,OAAD,CAAjB,GAA6BK,SAA7B;;AACA,cAAIb,KAAK,CAACG,KAAN,CAAYe,QAAZ,CAAqBV,OAArB,MAAkCK,SAAtC,EAAiD;AAChDb,YAAAA,KAAK,CAACc,QAAN,oBAA2BN,OAA3B;AACA;AACD,SALsC,EAKpCR,KAAK,CAACG,KAAN,CAAYY,QAAZ,CAAqBI,cALe,CAAvC;AAMA;AACD;AACD,GA5CD;AA6CA","sourcesContent":["'use strict'\r\n\r\nimport { defaultMachine } from './machine'\r\n\r\nlet settingsTimer, machineSettingsTimer = {}, machineCacheTimer = {}\r\n\r\nexport default function(store) {\r\n\t// Observe the mutations of the store and make sure the cache and\r\n\t// settings are saved automatically after a certain debounce delay\r\n\tstore.subscribe(function(mutation, state) {\r\n\t\tif (!mutation.type.endsWith('/load') && !mutation.type.endsWith('/setLastHostname')) {\r\n\t\t\tconst machineMatches = /^machines\\/(.+)\\//.exec(mutation.type);\r\n\t\t\tconst machine = machineMatches ? machineMatches[1] : state.selectedMachine;\r\n\t\t\tif (machine === defaultMachine) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (mutation.type.startsWith('settings')) {\r\n\t\t\t\t// Global settings have changed\r\n\t\t\t\tif (settingsTimer) {\r\n\t\t\t\t\tclearTimeout(settingsTimer);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsettingsTimer = setTimeout(function() {\r\n\t\t\t\t\tsettingsTimer = undefined;\r\n\t\t\t\t\tstore.dispatch('settings/save');\r\n\t\t\t\t}, store.state.settings.settingsSaveDelay);\r\n\t\t\t} else if (mutation.type.indexOf('/settings/') !== -1) {\r\n\t\t\t\t// Machine settings have changed\r\n\t\t\t\tif (machineSettingsTimer[machine]) {\r\n\t\t\t\t\tclearTimeout(machineSettingsTimer[machine]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmachineSettingsTimer[machine] = setTimeout(function() {\r\n\t\t\t\t\tmachineSettingsTimer[machine] = undefined;\r\n\t\t\t\t\tif (store.state.machines[machine] !== undefined) {\r\n\t\t\t\t\t\tstore.dispatch(`machines/${machine}/settings/save`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, store.state.settings.settingsSaveDelay);\r\n\t\t\t} else if (mutation.type.indexOf('/cache/') !== -1) {\r\n\t\t\t\t// Machine cache has changed\r\n\t\t\t\tif (machineCacheTimer[machine]) {\r\n\t\t\t\t\tclearTimeout(machineCacheTimer[machine]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmachineCacheTimer[machine] = setTimeout(function() {\r\n\t\t\t\t\tmachineCacheTimer[machine] = undefined;\r\n\t\t\t\t\tif (store.state.machines[machine] !== undefined) {\r\n\t\t\t\t\t\tstore.dispatch(`machines/${machine}/cache/save`);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, store.state.settings.cacheSaveDelay);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}\r\n"]}]}