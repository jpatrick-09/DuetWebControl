{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\store\\machine\\connector\\index.js","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\store\\machine\\connector\\index.js","mtime":1592248188704},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:J3VzZSBzdHJpY3QnOwoKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzpcXFVzZXJzXFxqcGF0cmlja1xcRG9jdW1lbnRzXFxHaXRIdWJcXER1ZXRXZWJDb250cm9sX0ZvcmtcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgeyBMb2dpbkVycm9yIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvZXJyb3JzLmpzJzsKaW1wb3J0IEJhc2VDb25uZWN0b3IgZnJvbSAnLi9CYXNlQ29ubmVjdG9yLmpzJzsKaW1wb3J0IFBvbGxDb25uZWN0b3IgZnJvbSAnLi9Qb2xsQ29ubmVjdG9yLmpzJzsKaW1wb3J0IFJlc3RDb25uZWN0b3IgZnJvbSAnLi9SZXN0Q29ubmVjdG9yLmpzJzsKdmFyIGNvbm5lY3RvcnMgPSBbUG9sbENvbm5lY3RvciwgUmVzdENvbm5lY3Rvcl07CmV4cG9ydCB2YXIgTWFjaGluZUFjdGlvbnMgPSBbJ2Rpc2Nvbm5lY3QnLCAnc2VuZENvZGUnLCAndXBsb2FkJywgJ2RlbGV0ZScsICdtb3ZlJywgJ21ha2VEaXJlY3RvcnknLCAnZG93bmxvYWQnLCAnZ2V0RmlsZUxpc3QnLCAnZ2V0RmlsZUluZm8nXTsKZXhwb3J0IGZ1bmN0aW9uIG1hcENvbm5lY3RvckFjdGlvbnMoY29ubmVjdG9yKSB7CiAgdmFyIGFjdGlvbnNUb01hcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogW107CiAgdmFyIGFjdGlvbnMgPSB7fTsKCiAgaWYgKGNvbm5lY3RvcikgewogICAgYWN0aW9uc1RvTWFwLmZvckVhY2goZnVuY3Rpb24gKGFjdGlvbikgewogICAgICAvLyBNYXAgYWN0aW9uIHRvIHRoZSBjb25uZWN0b3IKICAgICAgYWN0aW9uc1thY3Rpb25dID0gZnVuY3Rpb24gaGFuZGxlcihjb250ZXh0LCBwYXlsb2FkKSB7CiAgICAgICAgcmV0dXJuIGNvbm5lY3RvclthY3Rpb25dKHBheWxvYWQpOwogICAgICB9OwogICAgfSk7CiAgfQoKICByZXR1cm4gYWN0aW9uczsKfQpleHBvcnQgZGVmYXVsdCB7CiAgLy8gQ29ubmVjdCBhc3luY2hyb25vdXNseSBhbmQgcmV0dXJuIHRoZSBjb25uZWN0b3IgdGhhdCB3b3JrZWQuCiAgLy8gSWYgbm8gY29ubmVjdG9yIGNhbiBiZSBmb3VuZCwgYW4gZXJyb3Igd2lsbCBiZSB0aHJvd24uCiAgY29ubmVjdDogZnVuY3Rpb24gY29ubmVjdChob3N0bmFtZSwgdXNlciwgcGFzc3dvcmQpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBsYXN0RXJyb3IsIGksIGNvbm5lY3RvcjsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGxhc3RFcnJvciA9IG5ldyBMb2dpbkVycm9yKCk7CiAgICAgICAgICAgICAgaSA9IDA7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgaWYgKCEoaSA8IGNvbm5lY3RvcnMubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMzsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gY29ubmVjdG9yc1tpXS5jb25uZWN0KGhvc3RuYW1lLCB1c2VyLCBwYXNzd29yZCk7CgogICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY29ubmVjdG9yID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBjb25uZWN0b3IpOwoKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTA7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgzKTsKICAgICAgICAgICAgICBsYXN0RXJyb3IgPSBfY29udGV4dC50MDsKCiAgICAgICAgICAgICAgaWYgKCEoX2NvbnRleHQudDAgaW5zdGFuY2VvZiBMb2dpbkVycm9yKSkgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJicmVhayIsIDE4KTsKCiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSAxODoKICAgICAgICAgICAgICB0aHJvdyBsYXN0RXJyb3I7CgogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzMsIDEwXV0pOwogICAgfSkpKCk7CiAgfSwKICAvLyBJbnN0YWxsIHRoZSBnbG9iYWwgVnVleCBzdG9yZQogIGluc3RhbGxTdG9yZTogZnVuY3Rpb24gaW5zdGFsbFN0b3JlKHN0b3JlKSB7CiAgICBCYXNlQ29ubmVjdG9yLmluc3RhbGxTdG9yZShzdG9yZSk7CiAgfQp9Ow=="},{"version":3,"sources":["C:/Users/jpatrick/Documents/GitHub/DuetWebControl_Fork/src/store/machine/connector/index.js"],"names":["LoginError","BaseConnector","PollConnector","RestConnector","connectors","MachineActions","mapConnectorActions","connector","actionsToMap","actions","forEach","action","handler","context","payload","connect","hostname","user","password","lastError","i","length","installStore","store"],"mappings":"AAAA;;;;;;AAEA,SAASA,UAAT,QAA2B,0BAA3B;AAEA,OAAOC,aAAP,MAA0B,oBAA1B;AACA,OAAOC,aAAP,MAA0B,oBAA1B;AACA,OAAOC,aAAP,MAA0B,oBAA1B;AAEA,IAAMC,UAAU,GAAG,CAACF,aAAD,EAAgBC,aAAhB,CAAnB;AACA,OAAO,IAAME,cAAc,GAAG,CAAC,YAAD,EAAe,UAAf,EAA2B,QAA3B,EAAqC,QAArC,EAA+C,MAA/C,EAAuD,eAAvD,EAAwE,UAAxE,EAAoF,aAApF,EAAmG,aAAnG,CAAvB;AAEP,OAAO,SAASC,mBAAT,CAA6BC,SAA7B,EAA2D;AAAA,MAAnBC,YAAmB,uEAAJ,EAAI;AACjE,MAAIC,OAAO,GAAG,EAAd;;AACA,MAAIF,SAAJ,EAAe;AACdC,IAAAA,YAAY,CAACE,OAAb,CAAqB,UAASC,MAAT,EAAiB;AACrC;AACAF,MAAAA,OAAO,CAACE,MAAD,CAAP,GAAkB,SAASC,OAAT,CAAiBC,OAAjB,EAA0BC,OAA1B,EAAmC;AAAE,eAAOP,SAAS,CAACI,MAAD,CAAT,CAAkBG,OAAlB,CAAP;AAAoC,OAA3F;AACA,KAHD;AAIA;;AACD,SAAOL,OAAP;AACA;AAED,eAAe;AACd;AACA;AACMM,EAAAA,OAHQ,mBAGAC,QAHA,EAGUC,IAHV,EAGgBC,QAHhB,EAG0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACnCC,cAAAA,SADmC,GACvB,IAAInB,UAAJ,EADuB;AAE9BoB,cAAAA,CAF8B,GAE1B,CAF0B;;AAAA;AAAA,oBAEvBA,CAAC,GAAGhB,UAAU,CAACiB,MAFQ;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAIbjB,UAAU,CAACgB,CAAD,CAAV,CAAcL,OAAd,CAAsBC,QAAtB,EAAgCC,IAAhC,EAAsCC,QAAtC,CAJa;;AAAA;AAI/BX,cAAAA,SAJ+B;AAAA,+CAK9BA,SAL8B;;AAAA;AAAA;AAAA;AAOrCY,cAAAA,SAAS,cAAT;;AAPqC,oBAQjC,uBAAanB,UARoB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAEAoB,cAAAA,CAAC,EAFD;AAAA;AAAA;;AAAA;AAAA,oBAcjCD,SAdiC;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAevC,GAlBa;AAoBd;AACAG,EAAAA,YArBc,wBAqBDC,KArBC,EAqBM;AACnBtB,IAAAA,aAAa,CAACqB,YAAd,CAA2BC,KAA3B;AACA;AAvBa,CAAf","sourcesContent":["'use strict'\r\n\r\nimport { LoginError } from '../../../utils/errors.js'\r\n\r\nimport BaseConnector from './BaseConnector.js'\r\nimport PollConnector from './PollConnector.js'\r\nimport RestConnector from './RestConnector.js'\r\n\r\nconst connectors = [PollConnector, RestConnector]\r\nexport const MachineActions = ['disconnect', 'sendCode', 'upload', 'delete', 'move', 'makeDirectory', 'download', 'getFileList', 'getFileInfo']\r\n\r\nexport function mapConnectorActions(connector, actionsToMap = []) {\r\n\tlet actions = {}\r\n\tif (connector) {\r\n\t\tactionsToMap.forEach(function(action) {\r\n\t\t\t// Map action to the connector\r\n\t\t\tactions[action] = function handler(context, payload) { return connector[action](payload); }\r\n\t\t});\r\n\t}\r\n\treturn actions;\r\n}\r\n\r\nexport default {\r\n\t// Connect asynchronously and return the connector that worked.\r\n\t// If no connector can be found, an error will be thrown.\r\n\tasync connect(hostname, user, password) {\r\n\t\tlet lastError = new LoginError();\r\n\t\tfor (let i = 0; i < connectors.length; i++) {\r\n\t\t\ttry {\r\n\t\t\t\tconst connector = await connectors[i].connect(hostname, user, password);\r\n\t\t\t\treturn connector;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tlastError = e;\r\n\t\t\t\tif (e instanceof LoginError) {\r\n\t\t\t\t\t// This connector could establish a connection but the firmware refused it\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthrow lastError;\r\n\t},\r\n\r\n\t// Install the global Vuex store\r\n\tinstallStore(store) {\r\n\t\tBaseConnector.installStore(store);\r\n\t}\r\n}\r\n"]}]}