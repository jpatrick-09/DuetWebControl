{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js??ref--18-0!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\panels\\HeightmapPanel.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\panels\\HeightmapPanel.vue","mtime":1592248188563},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KJ3VzZSBzdHJpY3QnOwoKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuZW5kcy13aXRoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzpcXFVzZXJzXFxqcGF0cmlja1xcRG9jdW1lbnRzXFxHaXRIdWJcXER1ZXRXZWJDb250cm9sX0ZvcmtcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJDOlxcVXNlcnNcXGpwYXRyaWNrXFxEb2N1bWVudHNcXEdpdEh1YlxcRHVldFdlYkNvbnRyb2xfRm9ya1xcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBHZXR0ZXJzLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IFNjZW5lLCBQZXJzcGVjdGl2ZUNhbWVyYSwgV2ViR0xSZW5kZXJlciwgUmF5Y2FzdGVyLCBNZXNoLCBNZXNoQmFzaWNNYXRlcmlhbCwgVmVjdG9yMiwgVmVjdG9yMywgVmVydGV4Q29sb3JzLCBEb3VibGVTaWRlLCBBcnJvd0hlbHBlciwgR3JpZEhlbHBlciB9IGZyb20gJ3RocmVlJzsKaW1wb3J0IHsgT3JiaXRDb250cm9scyB9IGZyb20gJ3RocmVlL2V4YW1wbGVzL2pzbS9jb250cm9scy9PcmJpdENvbnRyb2xzJzsKaW1wb3J0IHsgZ2V0TW9kaWZpZWRGaWxlcyB9IGZyb20gJy4uLy4uL3N0b3JlL21hY2hpbmUnOwppbXBvcnQgeyBkcmF3TGVnZW5kLCBzZXRGYWNlQ29sb3JzLCBnZW5lcmF0ZUluZGljYXRvcnMsIGdlbmVyYXRlTWVzaEdlb21ldHJ5IH0gZnJvbSAnLi4vLi4vdXRpbHMvM2QuanMnOwppbXBvcnQgQ1NWIGZyb20gJy4uLy4uL3V0aWxzL2Nzdi5qcyc7CmltcG9ydCBQYXRoIGZyb20gJy4uLy4uL3V0aWxzL3BhdGguanMnOwp2YXIgc2NhbGVaID0gMC41LAogICAgbWF4VmlzdWFsaXphdGlvblogPSAwLjI1Owp2YXIgaW5kaWNhdG9yQ29sb3IgPSAweEZGRkZGRiwKICAgIGluZGljYXRvck9wYWNpdHkgPSAwLjQsCiAgICBpbmRpY2F0b3JPcGFjaXR5SGlnaGxpZ2h0ZWQgPSAxLjA7CmV4cG9ydCBkZWZhdWx0IHsKICBiZWZvcmVDcmVhdGU6IGZ1bmN0aW9uIGJlZm9yZUNyZWF0ZSgpIHsKICAgIHRoaXMudGhyZWUgPSB7CiAgICAgIC8vIG5vbi1yZWFjdGl2ZSBkYXRhCiAgICAgIHNjZW5lOiBudWxsLAogICAgICBjYW1lcmE6IG51bGwsCiAgICAgIHJlbmRlcmVyOiBudWxsLAogICAgICBvcmJpdENvbnRyb2xzOiBudWxsLAogICAgICByYXljYXN0ZXI6IG51bGwsCiAgICAgIGhhc0hlbHBlcnM6IGZhbHNlLAogICAgICBtZXNoR2VvbWV0cnk6IG51bGwsCiAgICAgIG1lc2hQbGFuZTogbnVsbCwKICAgICAgbWVzaEluZGljYXRvcnM6IG51bGwsCiAgICAgIGxhc3RJbnRlcnNlY3Rpb246IG51bGwKICAgIH07CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZCh7fSwgbWFwR2V0dGVycyhbJ2lzQ29ubmVjdGVkJ10pLCB7fSwgbWFwU3RhdGUoJ21hY2hpbmUvbW9kZWwnLCB7CiAgICBoZWlnaHRtYXBGaWxlOiBmdW5jdGlvbiBoZWlnaHRtYXBGaWxlKHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS5tb3ZlLmNvbXBlbnNhdGlvbi5maWxlOwogICAgfSwKICAgIHN5c3RlbURpcmVjdG9yeTogZnVuY3Rpb24gc3lzdGVtRGlyZWN0b3J5KHN0YXRlKSB7CiAgICAgIHJldHVybiBzdGF0ZS5kaXJlY3Rvcmllcy5zeXN0ZW07CiAgICB9CiAgfSksIHt9LCBtYXBTdGF0ZSgnc2V0dGluZ3MnLCBbJ2xhbmd1YWdlJ10pKSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNBY3RpdmU6IHRydWUsCiAgICAgIHJlYWR5OiBmYWxzZSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGVycm9yTWVzc2FnZTogbnVsbCwKICAgICAgY29sb3JTY2hlbWU6ICd0ZXJyYWluJywKICAgICAgdG9vbHRpcDogewogICAgICAgIGNvb3JkOiB7CiAgICAgICAgICB4OiAwLAogICAgICAgICAgeTogMCwKICAgICAgICAgIHo6IDAKICAgICAgICB9LAogICAgICAgIHg6IHVuZGVmaW5lZCwKICAgICAgICB5OiB1bmRlZmluZWQsCiAgICAgICAgc2hvd246IGZhbHNlCiAgICAgIH0sCiAgICAgIG51bVBvaW50czogdW5kZWZpbmVkLAogICAgICAvLyBwb2ludHMgZXhjbHVkaW5nIE5hTgogICAgICBhcmVhOiB1bmRlZmluZWQsCiAgICAgIHJhZGl1czogdW5kZWZpbmVkLAogICAgICBtaW5EaWZmOiB1bmRlZmluZWQsCiAgICAgIG1heERpZmY6IHVuZGVmaW5lZCwKICAgICAgbWVhbkVycm9yOiB1bmRlZmluZWQsCiAgICAgIHJtc0Vycm9yOiB1bmRlZmluZWQsCiAgICAgIHVuc3Vic2NyaWJlOiB1bmRlZmluZWQKICAgIH07CiAgfSwKICBtZXRob2RzOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBBY3Rpb25zKCdtYWNoaW5lJywgWydkb3dubG9hZCddKSwgewogICAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgLy8gUGVyZm9ybSBpbml0aWFsIHJlc2l6ZQogICAgICB2YXIgc2l6ZSA9IHRoaXMucmVzaXplKCk7IC8vIENyZWF0ZSBUSFJFRSBpbnN0YW5jZXMKCiAgICAgIHRoaXMudGhyZWUuc2NlbmUgPSBuZXcgU2NlbmUoKTsKICAgICAgdGhpcy50aHJlZS5jYW1lcmEgPSBuZXcgUGVyc3BlY3RpdmVDYW1lcmEoNDUsIHNpemUud2lkdGggLyBzaXplLmhlaWdodCwgMC4xLCAxMDAwKTsKICAgICAgdGhpcy50aHJlZS5jYW1lcmEucG9zaXRpb24uc2V0KDEsIDEsIDEpOwogICAgICB0aGlzLnRocmVlLmNhbWVyYS51cCA9IG5ldyBWZWN0b3IzKDAsIDAsIDEpOwogICAgICB0aGlzLnRocmVlLnJlbmRlcmVyID0gbmV3IFdlYkdMUmVuZGVyZXIoewogICAgICAgIGNhbnZhczogdGhpcy4kcmVmcy5jYW52YXMKICAgICAgfSk7CiAgICAgIHRoaXMudGhyZWUucmVuZGVyZXIuc2V0U2l6ZShzaXplLndpZHRoLCBzaXplLmhlaWdodCk7CiAgICAgIHRoaXMudGhyZWUub3JiaXRDb250cm9scyA9IG5ldyBPcmJpdENvbnRyb2xzKHRoaXMudGhyZWUuY2FtZXJhLCB0aGlzLnRocmVlLnJlbmRlcmVyLmRvbUVsZW1lbnQpOwogICAgICB0aGlzLnRocmVlLm9yYml0Q29udHJvbHMuZW5hYmxlS2V5cyA9IGZhbHNlOwogICAgICB0aGlzLnRocmVlLnJheWNhc3RlciA9IG5ldyBSYXljYXN0ZXIoKTsgLy8gUmVnaXN0ZXIgdGhpcyBpbnN0YW5jZSBpbiBvcmRlciB0byBkZWFsIHdpdGggc2l6ZSBjaGFuZ2VzCgogICAgICBpZiAodGhpcy5pc0Nvbm5lY3RlZCkgewogICAgICAgIHRoaXMuZ2V0SGVpZ2h0bWFwKCk7CiAgICAgIH0KICAgIH0sCiAgICByZXNpemU6IGZ1bmN0aW9uIHJlc2l6ZSgpIHsKICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIFJlc2l6ZSBjYW52YXMgZWxlbWVudHMKCgogICAgICB2YXIgd2lkdGggPSBNYXRoLm1heCh0aGlzLiRyZWZzLmNvbnRhaW5lci5vZmZzZXRXaWR0aCAtIDgwLCAwKTsKICAgICAgdmFyIGhlaWdodDsKCiAgICAgIHN3aXRjaCAodGhpcy4kdnVldGlmeS5icmVha3BvaW50Lm5hbWUpIHsKICAgICAgICBjYXNlICd4cyc6CiAgICAgICAgICBoZWlnaHQgPSB3aWR0aDsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdzbSc6CiAgICAgICAgICBoZWlnaHQgPSB3aWR0aCAqIDMgLyA0OwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ3hsJzoKICAgICAgICAgIGhlaWdodCA9IHdpZHRoICogMTAgLyAxNjsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgaGVpZ2h0ID0gd2lkdGggKiA5IC8gMTY7CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgdGhpcy4kcmVmcy5jb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gIiIuY29uY2F0KGhlaWdodCwgInB4Iik7CiAgICAgIHRoaXMuJHJlZnMubGVnZW5kLnN0eWxlLmxlZnQgPSAiIi5jb25jYXQod2lkdGgsICJweCIpOwogICAgICB0aGlzLiRyZWZzLmxlZ2VuZC5oZWlnaHQgPSBoZWlnaHQ7CiAgICAgIHRoaXMuJHJlZnMuY2FudmFzLndpZHRoID0gd2lkdGg7CiAgICAgIHRoaXMuJHJlZnMuY2FudmFzLmhlaWdodCA9IGhlaWdodDsgLy8gUmVzaXplIHRoZSAzRCBoZWlnaHQgbWFwCgogICAgICBpZiAodGhpcy50aHJlZS5yZW5kZXJlcikgewogICAgICAgIHRoaXMudGhyZWUuY2FtZXJhLmFzcGVjdCA9IHdpZHRoIC8gaGVpZ2h0OwogICAgICAgIHRoaXMudGhyZWUuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKTsKICAgICAgICB0aGlzLnRocmVlLnJlbmRlcmVyLnNldFNpemUod2lkdGgsIGhlaWdodCk7CiAgICAgIH0gLy8gUmVkcmF3IHRoZSBsZWdlbmQgYW5kIHJldHVybiB0aGUgY2FudmFzIHNpemUKCgogICAgICBkcmF3TGVnZW5kKHRoaXMuJHJlZnMubGVnZW5kLCBtYXhWaXN1YWxpemF0aW9uWiwgdGhpcy5jb2xvclNjaGVtZSk7CiAgICAgIHJldHVybiB7CiAgICAgICAgd2lkdGg6IHdpZHRoLAogICAgICAgIGhlaWdodDogaGVpZ2h0CiAgICAgIH07CiAgICB9LAogICAgc2hvd0NTVjogZnVuY3Rpb24gc2hvd0NTVihjc3ZEYXRhKSB7CiAgICAgIC8vIExvYWQgdGhlIENTVi4gVGhlIGZpcnN0IGxpbmUgaXMgYSBjb21tZW50IHRoYXQgY2FuIGJlIHJlbW92ZWQKICAgICAgdmFyIGNzdiA9IG5ldyBDU1YoY3N2RGF0YS5zdWJzdHJpbmcoY3N2RGF0YS5pbmRleE9mKCJcbiIpICsgMSkpOwogICAgICB2YXIgcmFkaXVzID0gcGFyc2VGbG9hdChjc3YuZ2V0KCdyYWRpdXMnKSk7CgogICAgICBpZiAocmFkaXVzIDw9IDApIHsKICAgICAgICByYWRpdXMgPSB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHZhciB4TWluID0gcGFyc2VGbG9hdChjc3YuZ2V0KCd4bWluJykpOwogICAgICB2YXIgeU1pbiA9IHBhcnNlRmxvYXQoY3N2LmdldCgneW1pbicpKTsKICAgICAgdmFyIHhTcGFjaW5nID0gcGFyc2VGbG9hdChjc3YuZ2V0KCd4c3BhY2luZycpKTsKCiAgICAgIGlmIChpc05hTih4U3BhY2luZykpIHsKICAgICAgICB4U3BhY2luZyA9IHBhcnNlRmxvYXQoY3N2LmdldCgnc3BhY2luZycpKTsKICAgICAgfQoKICAgICAgdmFyIHlTcGFjaW5nID0gcGFyc2VGbG9hdChjc3YuZ2V0KCd5c3BhY2luZycpKTsKCiAgICAgIGlmIChpc05hTih5U3BhY2luZykpIHsKICAgICAgICB5U3BhY2luZyA9IHBhcnNlRmxvYXQoY3N2LmdldCgnc3BhY2luZycpKTsKICAgICAgfSAvLyBDb252ZXJ0IGVhY2ggcG9pbnQgdG8gYSB2ZWN0b3IKCgogICAgICB2YXIgcG9pbnRzID0gW107CgogICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IGNzdi5jb250ZW50Lmxlbmd0aDsgeSsrKSB7CiAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBjc3YuY29udGVudFt5XS5sZW5ndGg7IHgrKykgewogICAgICAgICAgdmFyIHZhbHVlID0gY3N2LmNvbnRlbnRbeV1beF0udHJpbSgpOwogICAgICAgICAgcG9pbnRzLnB1c2goW3hNaW4gKyB4ICogeFNwYWNpbmcsIHlNaW4gKyAoeSAtIDEpICogeVNwYWNpbmcsIHZhbHVlID09PSAiMCIgPyBOYU4gOiBwYXJzZUZsb2F0KHZhbHVlKV0pOwogICAgICAgIH0KICAgICAgfSAvLyBEaXNwbGF5IGhlaWdodCBtYXAKCgogICAgICB0aGlzLnNob3dIZWlnaHRtYXAocG9pbnRzLCByYWRpdXMpOwogICAgfSwKICAgIHNob3dIZWlnaHRtYXA6IGZ1bmN0aW9uIHNob3dIZWlnaHRtYXAocG9pbnRzLCBwcm9iZVJhZGl1cykgewogICAgICAvLyBDbGVhbiB1cCBmaXJzdAogICAgICBpZiAodGhpcy50aHJlZS5tZXNoR2VvbWV0cnkpIHsKICAgICAgICB0aGlzLnRocmVlLnNjZW5lLnJlbW92ZSh0aGlzLnRocmVlLm1lc2hQbGFuZSk7CiAgICAgICAgdGhpcy50aHJlZS5tZXNoSW5kaWNhdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChpbmRpY2F0b3IpIHsKICAgICAgICAgIHRoaXMucmVtb3ZlKGluZGljYXRvcik7CiAgICAgICAgfSwgdGhpcy50aHJlZS5zY2VuZSk7CiAgICAgICAgdGhpcy50aHJlZS5tZXNoR2VvbWV0cnkgPSBudWxsOwogICAgICAgIHRoaXMudGhyZWUubWVzaFBsYW5lID0gbnVsbDsKICAgICAgICB0aGlzLnRocmVlLm1lc2hJbmRpY2F0b3JzID0gbnVsbDsKICAgICAgICB0aGlzLnRocmVlLmxhc3RJbnRlcnNlY3Rpb24gPSBudWxsOwogICAgICB9IC8vIEdlbmVyYXRlIHN0YXRzCgoKICAgICAgdmFyIHhNaW4sIHhNYXgsIHlNaW4sIHlNYXg7CiAgICAgIHRoaXMucmFkaXVzID0gcHJvYmVSYWRpdXM7CiAgICAgIHRoaXMubnVtUG9pbnRzID0gMDsKICAgICAgdGhpcy5taW5EaWZmID0gdW5kZWZpbmVkOwogICAgICB0aGlzLm1heERpZmYgPSB1bmRlZmluZWQ7CiAgICAgIHRoaXMubWVhbkVycm9yID0gMDsKICAgICAgdGhpcy5ybXNFcnJvciA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvaW50cy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciB6ID0gcG9pbnRzW2ldWzJdOwoKICAgICAgICBpZiAoIWlzTmFOKHopKSB7CiAgICAgICAgICB2YXIgeCA9IHBvaW50c1tpXVswXTsKICAgICAgICAgIHZhciB5ID0gcG9pbnRzW2ldWzFdOwoKICAgICAgICAgIGlmICh4TWluID09PSB1bmRlZmluZWQgfHwgeE1pbiA+IHgpIHsKICAgICAgICAgICAgeE1pbiA9IHg7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHhNYXggPT09IHVuZGVmaW5lZCB8fCB4TWF4IDwgeCkgewogICAgICAgICAgICB4TWF4ID0geDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoeU1pbiA9PT0gdW5kZWZpbmVkIHx8IHlNaW4gPiB5KSB7CiAgICAgICAgICAgIHlNaW4gPSB5OwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh5TWF4ID09PSB1bmRlZmluZWQgfHwgeU1heCA8IHkpIHsKICAgICAgICAgICAgeU1heCA9IHk7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5udW1Qb2ludHMrKzsKICAgICAgICAgIHRoaXMubWVhbkVycm9yICs9IHo7CiAgICAgICAgICB0aGlzLnJtc0Vycm9yICs9IHogKiB6OwoKICAgICAgICAgIGlmICh0aGlzLm1pbkRpZmYgPT09IHVuZGVmaW5lZCB8fCB0aGlzLm1pbkRpZmYgPiB6KSB7CiAgICAgICAgICAgIHRoaXMubWluRGlmZiA9IHo7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKHRoaXMubWF4RGlmZiA9PT0gdW5kZWZpbmVkIHx8IHRoaXMubWF4RGlmZiA8IHopIHsKICAgICAgICAgICAgdGhpcy5tYXhEaWZmID0gejsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuYXJlYSA9IHByb2JlUmFkaXVzID8gcHJvYmVSYWRpdXMgKiBwcm9iZVJhZGl1cyAqIE1hdGguUEkgOiBNYXRoLmFicygoeE1heCAtIHhNaW4pICogKHlNYXggLSB5TWluKSk7CiAgICAgIHRoaXMucm1zRXJyb3IgPSBNYXRoLnNxcnQodGhpcy5ybXNFcnJvciAqIHRoaXMubnVtUG9pbnRzIC0gdGhpcy5tZWFuRXJyb3IgKiB0aGlzLm1lYW5FcnJvcikgLyB0aGlzLm51bVBvaW50czsKICAgICAgdGhpcy5tZWFuRXJyb3IgPSB0aGlzLm1lYW5FcnJvciAvIHRoaXMubnVtUG9pbnRzOyAvLyBHZW5lcmF0ZSBtZXNoIGdlb21ldHJ5IGFuZCBhcHBseSBmYWNlIGNvbG9ycwoKICAgICAgdGhpcy50aHJlZS5tZXNoR2VvbWV0cnkgPSBnZW5lcmF0ZU1lc2hHZW9tZXRyeShwb2ludHMsIHhNaW4sIHhNYXgsIHlNaW4sIHlNYXgsIHNjYWxlWik7CiAgICAgIHNldEZhY2VDb2xvcnModGhpcy50aHJlZS5tZXNoR2VvbWV0cnksIHNjYWxlWiwgdGhpcy5jb2xvclNjaGVtZSwgbWF4VmlzdWFsaXphdGlvblopOyAvLyBNYWtlIDNEIG1lc2ggYW5kIGFkZCBpdAoKICAgICAgdmFyIG1hdGVyaWFsID0gbmV3IE1lc2hCYXNpY01hdGVyaWFsKHsKICAgICAgICB2ZXJ0ZXhDb2xvcnM6IFZlcnRleENvbG9ycywKICAgICAgICBzaWRlOiBEb3VibGVTaWRlCiAgICAgIH0pOwogICAgICB0aGlzLnRocmVlLm1lc2hQbGFuZSA9IG5ldyBNZXNoKHRoaXMudGhyZWUubWVzaEdlb21ldHJ5LCBtYXRlcmlhbCk7CiAgICAgIHRoaXMudGhyZWUuc2NlbmUuYWRkKHRoaXMudGhyZWUubWVzaFBsYW5lKTsgLy8gTWFrZSBpbmRpY2F0b3JzIGFuZCBhZGQgdGhlbQoKICAgICAgdGhpcy50aHJlZS5tZXNoSW5kaWNhdG9ycyA9IGdlbmVyYXRlSW5kaWNhdG9ycyh0aGlzLnRocmVlLm1lc2hHZW9tZXRyeSwgdGhpcy5udW1Qb2ludHMsIHNjYWxlWiwgaW5kaWNhdG9yQ29sb3IsIGluZGljYXRvck9wYWNpdHkpOwogICAgICB0aGlzLnRocmVlLm1lc2hJbmRpY2F0b3JzLmZvckVhY2goZnVuY3Rpb24gKGluZGljYXRvcikgewogICAgICAgIHRoaXMuYWRkKGluZGljYXRvcik7CiAgICAgIH0sIHRoaXMudGhyZWUuc2NlbmUpOwoKICAgICAgaWYgKCF0aGlzLnRocmVlLmhhc0hlbHBlcnMpIHsKICAgICAgICAvLyBNYWtlIGF4aXMgYXJyb3dzIGZvciBYWVoKICAgICAgICB0aGlzLnRocmVlLnNjZW5lLmFkZChuZXcgQXJyb3dIZWxwZXIobmV3IFZlY3RvcjMoMSwgMCwgMCksIG5ldyBWZWN0b3IzKC0wLjYsIC0wLjYsIDApLCAwLjUsIDB4RkYwMDAwKSk7CiAgICAgICAgdGhpcy50aHJlZS5zY2VuZS5hZGQobmV3IEFycm93SGVscGVyKG5ldyBWZWN0b3IzKDAsIDEsIDApLCBuZXcgVmVjdG9yMygtMC42LCAtMC42LCAwKSwgMC41LCAweDAwRkYwMCkpOwogICAgICAgIHRoaXMudGhyZWUuc2NlbmUuYWRkKG5ldyBBcnJvd0hlbHBlcihuZXcgVmVjdG9yMygwLCAwLCAxKSwgbmV3IFZlY3RvcjMoLTAuNiwgLTAuNiwgMCksIDAuNSwgMHgwMDAwRkYpKTsgLy8gTWFrZSBncmlkIG9uIFhZIHBsYW5lCgogICAgICAgIHZhciBncmlkID0gbmV3IEdyaWRIZWxwZXIoMS4xLCAxNSk7CiAgICAgICAgZ3JpZC5yb3RhdGlvbi54ID0gLU1hdGguUEkgLyAyOwogICAgICAgIHRoaXMudGhyZWUuc2NlbmUuYWRkKGdyaWQpOyAvLyBEb24ndCBhZGQgdGhlc2UgaGVscGVycyBhZ2FpbgoKICAgICAgICB0aGlzLnRocmVlLmhhc0hlbHBlcnMgPSB0cnVlOwogICAgICB9IC8vIFJlbmRlciBzY2VuZQoKCiAgICAgIHRoaXMucmVhZHkgPSB0cnVlOwogICAgICB0aGlzLnJlbmRlcigpOyAvLyBSZXNpemUgaXQgYWdhaW4gd2hlbiB0aGUgdmFsdWVzIGhhdmUgYmVlbiBjaGFuZ2VkCgogICAgICB0aGlzLiRuZXh0VGljayh0aGlzLnJlc2l6ZSk7CiAgICB9LAogICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7CiAgICAgIGlmICh0aGlzLnRocmVlLnJlbmRlcmVyKSB7CiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucmVuZGVyKTsKICAgICAgICB0aGlzLnRocmVlLnJlbmRlcmVyLnJlbmRlcih0aGlzLnRocmVlLnNjZW5lLCB0aGlzLnRocmVlLmNhbWVyYSk7CiAgICAgIH0KICAgIH0sCiAgICBjYW52YXNNb3VzZU1vdmU6IGZ1bmN0aW9uIGNhbnZhc01vdXNlTW92ZShlKSB7CiAgICAgIGlmICghZS5jbGllbnRYIHx8ICF0aGlzLnRocmVlLm1lc2hHZW9tZXRyeSkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyBUcnkgdG8gZ2V0IHRoZSBaIHZhbHVlIGJlbG93IHRoZSBjdXJzb3IKICAgICAgLy8gRm9yIHRoYXQgd2UgbmVlZCBub3JtYWxpemVkIFgrWSBjb29yZGluYXRlcyBiZXR3ZWVuIC0xLjAgYW5kIDEuMAoKCiAgICAgIHZhciByZWN0ID0gZS50YXJnZXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIHZhciBtb3VzZSA9IG5ldyBWZWN0b3IyKCk7CiAgICAgIG1vdXNlLnggPSAoZS5jbGllbnRYIC0gcmVjdC5sZWZ0KSAvIGUudGFyZ2V0LmNsaWVudFdpZHRoICogMiAtIDE7CiAgICAgIG1vdXNlLnkgPSAtKGUuY2xpZW50WSAtIHJlY3QudG9wKSAvIGUudGFyZ2V0LmNsaWVudEhlaWdodCAqIDIgKyAxOyAvLyBJcyB0aGUgY3Vyc29yIG9uIGEgcG9pbnQgaW5kaWNhdG9yPwoKICAgICAgdGhpcy50aHJlZS5yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYShtb3VzZSwgdGhpcy50aHJlZS5jYW1lcmEpOwogICAgICB2YXIgaW50ZXJzZWN0aW9uID0gdGhpcy50aHJlZS5yYXljYXN0ZXIuaW50ZXJzZWN0T2JqZWN0cyh0aGlzLnRocmVlLm1lc2hJbmRpY2F0b3JzKTsKCiAgICAgIGlmICh0aGlzLnRocmVlLmxhc3RJbnRlcnNlY3Rpb24gJiYgKGludGVyc2VjdGlvbi5sZW5ndGggPT09IDAgfHwgaW50ZXJzZWN0aW9uWzBdICE9PSB0aGlzLnRocmVlLmxhc3RJbnRlcnNlY3Rpb24pKSB7CiAgICAgICAgdGhpcy50aHJlZS5sYXN0SW50ZXJzZWN0aW9uLm9iamVjdC5tYXRlcmlhbC5vcGFjaXR5ID0gaW5kaWNhdG9yT3BhY2l0eTsKICAgICAgICB0aGlzLnRocmVlLmxhc3RJbnRlcnNlY3Rpb24gPSB1bmRlZmluZWQ7CiAgICAgIH0KCiAgICAgIHZhciBpbnRlcnNlY3Rpb25Qb2ludDsKCiAgICAgIGlmIChpbnRlcnNlY3Rpb24ubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChpbnRlcnNlY3Rpb25bMF0gIT09IHRoaXMudGhyZWUubGFzdEludGVyc2VjdGlvbikgewogICAgICAgICAgaW50ZXJzZWN0aW9uWzBdLm9iamVjdC5tYXRlcmlhbC5vcGFjaXR5ID0gaW5kaWNhdG9yT3BhY2l0eUhpZ2hsaWdodGVkOwogICAgICAgICAgdGhpcy50aHJlZS5sYXN0SW50ZXJzZWN0aW9uID0gaW50ZXJzZWN0aW9uWzBdOwogICAgICAgIH0KCiAgICAgICAgaW50ZXJzZWN0aW9uUG9pbnQgPSBpbnRlcnNlY3Rpb25bMF0ub2JqZWN0LmNvb3JkczsKICAgICAgfSAvLyBTaG93IG9yIGhpZGUgdGhlIHRvb2x0aXAKCgogICAgICBpZiAoaW50ZXJzZWN0aW9uUG9pbnQpIHsKICAgICAgICB0aGlzLnRvb2x0aXAuY29vcmQueCA9IGludGVyc2VjdGlvblBvaW50Lng7CiAgICAgICAgdGhpcy50b29sdGlwLmNvb3JkLnkgPSBpbnRlcnNlY3Rpb25Qb2ludC55OwogICAgICAgIHRoaXMudG9vbHRpcC5jb29yZC56ID0gaW50ZXJzZWN0aW9uUG9pbnQuejsKICAgICAgICB0aGlzLnRvb2x0aXAueCA9IGUuY2xpZW50WDsKICAgICAgICB0aGlzLnRvb2x0aXAueSA9IGUuY2xpZW50WTsKICAgICAgICB0aGlzLnRvb2x0aXAuc2hvd24gPSB0cnVlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudG9vbHRpcC5zaG93biA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgdG9wVmlldzogZnVuY3Rpb24gdG9wVmlldygpIHsKICAgICAgdGhpcy50aHJlZS5jYW1lcmEucG9zaXRpb24uc2V0KDAsIDAsIDEuNSk7CiAgICAgIHRoaXMudGhyZWUuY2FtZXJhLnJvdGF0aW9uLnNldCgwLCAwLCAwKTsKICAgICAgdGhpcy50aHJlZS5jYW1lcmEudXBkYXRlUHJvamVjdGlvbk1hdHJpeCgpOwogICAgfSwKICAgIGdldEhlaWdodG1hcDogZnVuY3Rpb24gZ2V0SGVpZ2h0bWFwKGZpbGVuYW1lKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBoZWlnaHRtYXA7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5sb2FkaW5nKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgaWYgKCFmaWxlbmFtZSkgewogICAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IF90aGlzLmhlaWdodG1hcEZpbGU7CgogICAgICAgICAgICAgICAgICBpZiAoIWZpbGVuYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUoX3RoaXMuc3lzdGVtRGlyZWN0b3J5LCBQYXRoLmhlaWdodG1hcEZpbGUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RoaXMucmVhZHkgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF90aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDU7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kb3dubG9hZCh7CiAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLAogICAgICAgICAgICAgICAgICBzaG93UHJvZ3Jlc3M6IGZhbHNlLAogICAgICAgICAgICAgICAgICBzaG93U3VjY2VzczogZmFsc2UsCiAgICAgICAgICAgICAgICAgIHNob3dFcnJvcjogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBoZWlnaHRtYXAgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIF90aGlzLnNob3dDU1YoaGVpZ2h0bWFwKTsKCiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMjsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oNSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oX2NvbnRleHQudDApOwogICAgICAgICAgICAgICAgX3RoaXMuZXJyb3JNZXNzYWdlID0gX2NvbnRleHQudDAubWVzc2FnZTsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbNSwgMTJdXSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHRlc3RNZXNoOiBmdW5jdGlvbiB0ZXN0TWVzaCgpIHsKICAgICAgdmFyIGNzdkRhdGEgPSAnUmVwUmFwRmlybXdhcmUgaGVpZ2h0IG1hcCBmaWxlIHYxXG54bWluLHhtYXgseW1pbix5bWF4LHJhZGl1cyxzcGFjaW5nLHhudW0seW51bVxuLTE0MC4wMCwxNDAuMTAsLTE0MC4wMCwxNDAuMTAsMTUwLjAwLDIwLjAwLDE1LDE1XG4wLDAsMCwwLDAsLTAuMTM5LC0wLjE4OCwtMC4xMzksLTAuMjAyLC0wLjIyNCwwLDAsMCwwLDBcbjAsMCwwLC0wLjA1OCwtMC4wNjYsLTAuMTA5LC0wLjE0MSwtMC4xMjksLTAuMTg2LC0wLjE5OCwtMC4xOTEsLTAuMTc2LDAsMCwwXG4wLDAsMC4wMTMsLTAuMDA4LC0wLjA1MywtMC4wNzEsLTAuMDg3LC0wLjExMywtMC4xNjIsLTAuMTkwLC0wLjE5OSwtMC4yNjcsLTAuMjM3LDAsMFxuMCwwLjEyNCwwLjA3NiwwLjAyNSwtMC4wMjYsLTAuMDU0LC0wLjA3OCwtMC4xMzcsLTAuMTI3LC0wLjE2NSwtMC4yMDEsLTAuMTg5LC0wLjIyNywtMC4yMjYsMFxuMCwwLjE5OCwwLjEyMCwwLjA0NywwLjA4OSwtMC4wNzQsLTAuMDk3LC0wLjE1MywtMC4xODgsLTAuNDc3LC0wLjE5MCwtMC4xOTksLTAuMjM3LC0wLjIxMSwwXG4wLjMxMiwwLjIyOSwwLjE5OCwwLjA5OCwwLjA5NywwLjAwNCwtMC4wODksLTAuNTE2LC0wLjE1MCwtMC4yMDksLTAuMTk3LC0wLjE4MywtMC4yMTYsLTAuMjk2LC0wLjI1MFxuMC4yODcsMC4yNjMsMC4yOTIsMC4xMDAsMC4xOTAsMC4wMTUsLTAuMTAyLC0wLjAzOSwtMC4xMjUsLTAuMTQ5LC0wLjEzNywtMC4xOTgsLTAuMTg4LC0wLjIyMCwtMC4xOTJcbjAuMzc4LDAuMjg5LDAuMzI4LDAuMTcyLDAuMTMzLDAuMDc4LC0wLjA4NiwwLjEzNCwtMC4xMDAsLTAuMTUwLC0wLjE3NiwtMC4yMzQsLTAuMTg3LC0wLjE5OSwtMC4yMjFcbjAuMzYwLDAuMjkxLDAuMjYwLDAuMTg1LDAuMTExLDAuMTA4LDAuMDI0LDAuMDczLC0wLjAyNCwtMC4xMTYsLTAuMTg3LC0wLjI1MiwtMC4yMDEsLTAuMjE1LC0wLjE4N1xuMC40NDcsMC4zOTcsMC4zMzYsMC4yNzYsMC4xODAsMC4xNjQsMC4wNzMsLTAuMDUwLC0wLjA0OSwtMC4xMDksLTAuMTUxLC0wLjE3MiwtMC4yMTEsLTAuMTc1LC0wLjE2MVxuMCwwLjMzNywwLjI4OSwwLjIyNywwLjE3OSwwLjEyNywwLjA4NiwwLjAzNCwtMC4wMzksLTAuMDYwLC0wLjExMywtMC4xMDgsLTAuMTcxLC0wLjE1MywwXG4wLDAuNDc4LDAuMzk3LDAuMzc0LDAuMjcwLDAuMTQxLDAuMDg1LDAuMDc0LDAuMDM3LC0wLjA0OCwtMC4wODAsLTAuMTg3LC0wLjEyNiwtMC4xNzUsMFxuMCwwLDAuMzczLDAuMzY0LDAuMjY1LDAuMTYxLDAuMTM5LDAuMjEyLDAuMDQwLDAuMDQ2LC0wLjAwOCwtMC4xNDksLTAuMTE1LDAsMFxuMCwwLDAsMC4zNDYsMC4yOTUsMC4yNzMsMC4xNDgsMC4xMzYsMC4wODQsMC4wMjQsLTAuMDU1LC0wLjA3OCwwLDAsMFxuMCwwLDAsMCwwLDAuMjQwLDAuMTc4LDAuMDg0LDAuMDkwLDAuMDA0LDAsMCwwLDAsMCc7CiAgICAgIHRoaXMuc2hvd0NTVihjc3ZEYXRhKTsKICAgIH0sCiAgICB0ZXN0QmVkQ29tcGVuc2F0aW9uOiBmdW5jdGlvbiB0ZXN0QmVkQ29tcGVuc2F0aW9uKG51bVBvaW50cykgewogICAgICB2YXIgdGVzdFBvaW50czsKCiAgICAgIHN3aXRjaCAobnVtUG9pbnRzKSB7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGVzdFBvaW50cyA9IFtbMTUuMCwgMTUuMCwgMC4xMjNdLCBbMTUuMCwgMTk1LjAsIC0wLjI0M10sIFsyMTUuMCwgMTA1LjAsIDAuMDM0XV07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSA0OgogICAgICAgICAgdGVzdFBvaW50cyA9IFtbMTUuMCwgMTUuMCwgMC4wMTVdLCBbMTUuMCwgMTg1LjAsIC0wLjE5M10sIFsxNzUuMCwgMTg1LjAsIDAuMTU2XSwgWzE3NS4wLCAxNS4wLCAwLjEwNV1dOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgNToKICAgICAgICAgIHRlc3RQb2ludHMgPSBbWzE1LjAsIDE1LjAsIDAuMDA3XSwgWzE1LjAsIDE4NS4wLCAtMC4xMjFdLCBbMTc1LjAsIDE4NS4wLCAtMC4wMTldLCBbMTc1LjAsIDE1LjAsIDAuMTkzXSwgWzk1LjAsIDEwMC4wLCAwLjA1XV07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQmFkIG51bWJlciBvZiBwcm9iZSBwb2ludHMsIG9ubHkgb25lIG9mIDMvNC81IGlzIHN1cHBvcnRlZCIpOwogICAgICB9CgogICAgICB0aGlzLnNob3dIZWlnaHRtYXAodGVzdFBvaW50cyk7CiAgICB9CiAgfSksCiAgYWN0aXZhdGVkOiBmdW5jdGlvbiBhY3RpdmF0ZWQoKSB7CiAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTsKICAgIHRoaXMucmVzaXplKCk7CiAgfSwKICBkZWFjdGl2YXRlOiBmdW5jdGlvbiBkZWFjdGl2YXRlKCkgewogICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBnZXRIZWlnaHRtYXAgPSB0aGlzLmdldEhlaWdodG1hcDsKICAgIHRoaXMudW5zdWJzY3JpYmUgPSB0aGlzLiRzdG9yZS5zdWJzY3JpYmVBY3Rpb24oZnVuY3Rpb24gKGFjdGlvbiwgc3RhdGUpIHsKICAgICAgaWYgKGdldE1vZGlmaWVkRmlsZXMoYWN0aW9uLCBzdGF0ZSkuaW5kZXhPZihQYXRoLmhlaWdodG1hcEZpbGUpICE9PSAtMSB8fCBhY3Rpb24udHlwZS5lbmRzV2l0aCgnb25Db2RlQ29tcGxldGVkJykgJiYgYWN0aW9uLnBheWxvYWQucmVwbHkuaW5kZXhPZihQYXRoLmhlaWdodG1hcEZpbGUpICE9PSAtMSkgewogICAgICAgIGdldEhlaWdodG1hcCgpOwogICAgICB9CiAgICB9KTsgLy8gRklYTUUgZ2l2ZSB0aGUgZ3JpZCBzb21lIHRpbWUgdG8gcmVzaXplIGV2ZXJ5dGhpbmcuLi4KCiAgICBzZXRUaW1lb3V0KHRoaXMuaW5pdCwgMTAwKTsKICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLnVuc3Vic2NyaWJlKCk7CgogICAgaWYgKHRoaXMudGhyZWUucmVuZGVyZXIpIHsKICAgICAgdGhpcy50aHJlZS5yZW5kZXJlci5mb3JjZUNvbnRleHRMb3NzKCk7CiAgICAgIHRoaXMudGhyZWUucmVuZGVyZXIgPSBudWxsOwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGNvbG9yU2NoZW1lOiBmdW5jdGlvbiBjb2xvclNjaGVtZSh0bykgewogICAgICBpZiAodGhpcy50aHJlZS5tZXNoR2VvbWV0cnkpIHsKICAgICAgICBzZXRGYWNlQ29sb3JzKHRoaXMudGhyZWUubWVzaEdlb21ldHJ5LCBzY2FsZVosIHRvLCBtYXhWaXN1YWxpemF0aW9uWik7CiAgICAgIH0KCiAgICAgIGRyYXdMZWdlbmQodGhpcy4kcmVmcy5sZWdlbmQsIG1heFZpc3VhbGl6YXRpb25aLCB0byk7CiAgICB9LAogICAgaXNDb25uZWN0ZWQ6IGZ1bmN0aW9uIGlzQ29ubmVjdGVkKHRvKSB7CiAgICAgIGlmICh0bykgewogICAgICAgIHRoaXMuZ2V0SGVpZ2h0bWFwKCk7CiAgICAgIH0KICAgIH0sCiAgICBoZWlnaHRtYXBGaWxlOiBmdW5jdGlvbiBoZWlnaHRtYXBGaWxlKHRvKSB7CiAgICAgIGlmICh0bykgewogICAgICAgIHRoaXMuZ2V0SGVpZ2h0bWFwKHRvKTsKICAgICAgfQogICAgfSwKICAgIGxhbmd1YWdlOiBmdW5jdGlvbiBsYW5ndWFnZSgpIHsKICAgICAgZHJhd0xlZ2VuZCh0aGlzLiRyZWZzLmxlZ2VuZCwgbWF4VmlzdWFsaXphdGlvblosIHRoaXMuY29sb3JTY2hlbWUpOwogICAgfQogIH0KfTs="},{"version":3,"sources":["HeightmapPanel.vue"],"names":[],"mappings":"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","sourcesContent":["<style scoped>\r\n.heightmap-container {\r\n\tbackground-color: #000;\r\n\tcolor: #FFF;\r\n\tborder-radius: 8px;\r\n\tdisplay: flex;\r\n}\r\n\r\nh1 {\r\n\twidth: 100%;\r\n\talign-self: center;\r\n}\r\n\r\n.canvas-container {\r\n\tposition: relative;\r\n\theight: 100%;\r\n\twidth: 100%;\r\n\toverflow: hidden;\r\n}\r\n\r\n.canvas-container > :first-child {\r\n\tborder-radius: 8px 0 0 8px;\r\n}\r\n\r\n.canvas-container > :last-child {\r\n\tborder-radius: 0 8px 8px 0;\r\n}\r\n\r\n.canvas-container > canvas {\r\n\tposition: absolute;\r\n}\r\n\r\n.no-cursor {\r\n\tpointer-events: none;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-card class=\"card\">\r\n\t\t<v-card-text class=\"py-1\">\r\n\t\t\t<v-row>\r\n\t\t\t\t<!-- TODO: Add CSV list here -->\r\n\r\n\t\t\t\t<v-col :class=\"{ 'pa-1': $vuetify.breakpoint.xs }\">\r\n\t\t\t\t\t<div ref=\"container\" class=\"heightmap-container\" v-resize=\"resize\">\r\n\t\t\t\t\t\t<h1 v-show=\"!ready\" class=\"text-center\">\r\n\t\t\t\t\t\t\t{{ loading ? $t('generic.loading') : (errorMessage ? errorMessage : $t('panel.heightmap.notAvailable')) }}\r\n\t\t\t\t\t\t</h1>\r\n\r\n\t\t\t\t\t\t<div v-show=\"ready\" class=\"canvas-container\">\r\n\t\t\t\t\t\t\t<canvas ref=\"canvas\" @mousemove=\"canvasMouseMove\"></canvas>\r\n\t\t\t\t\t\t\t<canvas ref=\"legend\" class=\"legend\" width=\"80\"></canvas>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</v-col>\r\n\r\n\t\t\t\t<v-col cols=\"12\" md=\"auto\" class=\"d-flex\">\r\n\t\t\t\t\t<div class=\"d-flex flex-column flex-grow-1 justify-space-between\">\r\n\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t{{ $t('panel.heightmap.numPoints', [$display(numPoints, 0)]) }}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span v-if=\"radius > 0\">\r\n\t\t\t\t\t\t\t{{ $t('panel.heightmap.radius', [$display(radius, 0, 'mm')]) }}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t{{ $t('panel.heightmap.area', [$display(area / 100, 1, 'cmÂ²')]) }}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t{{ $t('panel.heightmap.maxDeviations', [$display(minDiff, 3), $display(maxDiff, 3, 'mm')]) }}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t{{ $t('panel.heightmap.meanError', [$display(meanError, 3, 'mm')]) }}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t{{ $t('panel.heightmap.rmsError', [$display(rmsError, 3, 'mm')]) }}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<div class=\"d-flex flex-column mt-1\">\r\n\t\t\t\t\t\t\t{{ $t('panel.heightmap.colorScheme') }}\r\n\t\t\t\t\t\t\t<v-btn-toggle v-model=\"colorScheme\" class=\"mt-1\">\r\n\t\t\t\t\t\t\t\t<v-btn value=\"terrain\" class=\"flex-grow-1\">{{ $t('panel.heightmap.terrain') }}</v-btn>\r\n\t\t\t\t\t\t\t\t<v-btn value=\"heat\" class=\"flex-grow-1\">{{ $t('panel.heightmap.heat') }}</v-btn>\r\n\t\t\t\t\t\t\t</v-btn-toggle>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<v-btn @click=\"topView\" :disabled=\"!ready\" class=\"ml-0 my-3\" >\r\n\t\t\t\t\t\t\t<v-icon small class=\"mr-1\">mdi-format-vertical-align-bottom</v-icon> {{ $t('panel.heightmap.topView') }}\r\n\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t<v-btn class=\"ml-0\" :disabled=\"!isConnected\" :loading=\"loading\" @click=\"getHeightmap()\">\r\n\t\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-refresh</v-icon> {{ $t('panel.heightmap.reload') }}\r\n\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</v-col>\r\n\t\t\t</v-row>\r\n\r\n\t\t\t<v-tooltip top absolute v-model=\"tooltip.shown\" :position-x=\"tooltip.x\" :position-y=\"tooltip.y\">\r\n\t\t\t\t<span class=\"no-cursor\">\r\n\t\t\t\t\tX: {{ $display(tooltip.coord.x, 1, 'mm') }} <br>\r\n\t\t\t\t\tY: {{ $display(tooltip.coord.y, 1, 'mm') }} <br>\r\n\t\t\t\t\tZ: {{ $display(tooltip.coord.z, 3, 'mm') }}\r\n\t\t\t\t</span>\r\n\t\t\t</v-tooltip>\r\n\t\t</v-card-text>\r\n\t</v-card>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapState, mapGetters, mapActions } from 'vuex'\r\n\r\nimport { Scene, PerspectiveCamera, WebGLRenderer, Raycaster, Mesh, MeshBasicMaterial, Vector2, Vector3, VertexColors, DoubleSide, ArrowHelper, GridHelper } from 'three'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\r\n\r\nimport { getModifiedFiles } from '../../store/machine'\r\nimport { drawLegend, setFaceColors, generateIndicators, generateMeshGeometry } from '../../utils/3d.js'\r\nimport CSV from '../../utils/csv.js'\r\nimport Path from '../../utils/path.js'\r\n\r\nconst scaleZ = 0.5, maxVisualizationZ = 0.25\r\nconst indicatorColor = 0xFFFFFF, indicatorOpacity = 0.4, indicatorOpacityHighlighted = 1.0\r\n\r\nexport default {\r\n\tbeforeCreate() {\r\n\t\tthis.three = {\t\t\t\t\t\t// non-reactive data\r\n\t\t\tscene: null,\r\n\t\t\tcamera: null,\r\n\t\t\trenderer: null,\r\n\t\t\torbitControls: null,\r\n\t\t\traycaster: null,\r\n\r\n\t\t\thasHelpers: false,\r\n\t\t\tmeshGeometry: null,\r\n\t\t\tmeshPlane: null,\r\n\t\t\tmeshIndicators: null,\r\n\t\t\tlastIntersection: null\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters(['isConnected']),\r\n\t\t...mapState('machine/model', {\r\n\t\t\theightmapFile: state => state.move.compensation.file,\r\n\t\t\tsystemDirectory: state => state.directories.system,\r\n\t\t}),\r\n\t\t...mapState('settings', ['language'])\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tisActive: true,\r\n\t\t\tready: false,\r\n\t\t\tloading: false,\r\n\t\t\terrorMessage: null,\r\n\r\n\t\t\tcolorScheme: 'terrain',\r\n\t\t\ttooltip: {\r\n\t\t\t\tcoord: {\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 0,\r\n\t\t\t\t\tz: 0\r\n\t\t\t\t},\r\n\t\t\t\tx: undefined,\r\n\t\t\t\ty: undefined,\r\n\t\t\t\tshown: false\r\n\t\t\t},\r\n\t\t\tnumPoints: undefined,\t\t\t// points excluding NaN\r\n\t\t\tarea: undefined,\r\n\t\t\tradius: undefined,\r\n\t\t\tminDiff: undefined,\r\n\t\t\tmaxDiff: undefined,\r\n\t\t\tmeanError: undefined,\r\n\t\t\trmsError: undefined,\r\n\r\n\t\t\tunsubscribe: undefined\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['download']),\r\n\t\tinit() {\r\n\t\t\t// Perform initial resize\r\n\t\t\tconst size = this.resize();\r\n\r\n\t\t\t// Create THREE instances\r\n\t\t\tthis.three.scene = new Scene();\r\n\t\t\tthis.three.camera = new PerspectiveCamera(45, size.width / size.height, 0.1, 1000);\r\n\t\t\tthis.three.camera.position.set(1, 1, 1);\r\n\t\t\tthis.three.camera.up = new Vector3(0, 0, 1);\r\n\t\t\tthis.three.renderer = new WebGLRenderer({ canvas: this.$refs.canvas });\r\n\t\t\tthis.three.renderer.setSize(size.width, size.height);\r\n\t\t\tthis.three.orbitControls = new OrbitControls(this.three.camera, this.three.renderer.domElement);\r\n\t\t\tthis.three.orbitControls.enableKeys = false;\r\n\t\t\tthis.three.raycaster = new Raycaster();\r\n\r\n\t\t\t// Register this instance in order to deal with size changes\r\n\t\t\tif (this.isConnected) {\r\n\t\t\t\tthis.getHeightmap();\r\n\t\t\t}\r\n\t\t},\r\n\t\tresize() {\r\n\t\t\tif (!this.isActive) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Resize canvas elements\r\n\t\t\tconst width = Math.max(this.$refs.container.offsetWidth - 80, 0);\r\n\t\t\tlet height;\r\n\t\t\tswitch (this.$vuetify.breakpoint.name) {\r\n\t\t\t\tcase 'xs':\r\n\t\t\t\t\theight = width;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'sm':\r\n\t\t\t\t\theight = width * 3 / 4;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'xl':\r\n\t\t\t\t\theight = width * 10 / 16;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\theight = width * 9 / 16;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tthis.$refs.container.style.height = `${height}px`;\r\n\t\t\tthis.$refs.legend.style.left = `${width}px`;\r\n\t\t\tthis.$refs.legend.height = height;\r\n\t\t\tthis.$refs.canvas.width = width;\r\n\t\t\tthis.$refs.canvas.height = height;\r\n\r\n\t\t\t// Resize the 3D height map\r\n\t\t\tif (this.three.renderer) {\r\n\t\t\t\tthis.three.camera.aspect = width / height;\r\n\t\t\t\tthis.three.camera.updateProjectionMatrix();\r\n\t\t\t\tthis.three.renderer.setSize(width, height);\r\n\t\t\t}\r\n\r\n\t\t\t// Redraw the legend and return the canvas size\r\n\t\t\tdrawLegend(this.$refs.legend, maxVisualizationZ, this.colorScheme);\r\n\t\t\treturn { width, height };\r\n\t\t},\r\n\t\tshowCSV(csvData) {\r\n\t\t\t// Load the CSV. The first line is a comment that can be removed\r\n\t\t\tconst csv = new CSV(csvData.substring(csvData.indexOf(\"\\n\") + 1));\r\n\t\t\tlet radius = parseFloat(csv.get('radius'));\r\n\t\t\tif (radius <= 0) { radius = undefined; }\r\n\t\t\tconst xMin = parseFloat(csv.get('xmin'));\r\n\t\t\tconst yMin = parseFloat(csv.get('ymin'));\r\n\t\t\tlet xSpacing = parseFloat(csv.get('xspacing'));\r\n\t\t\tif (isNaN(xSpacing)) { xSpacing = parseFloat(csv.get('spacing')); }\r\n\t\t\tlet ySpacing = parseFloat(csv.get('yspacing'));\r\n\t\t\tif (isNaN(ySpacing)) { ySpacing = parseFloat(csv.get('spacing')); }\r\n\r\n\t\t\t// Convert each point to a vector\r\n\t\t\tconst points = [];\r\n\t\t\tfor (let y = 1; y < csv.content.length; y++) {\r\n\t\t\t\tfor (let x = 0; x < csv.content[y].length; x++) {\r\n\t\t\t\t\tconst value = csv.content[y][x].trim();\r\n\t\t\t\t\tpoints.push([xMin + x * xSpacing, yMin + (y - 1) * ySpacing, (value === \"0\") ? NaN : parseFloat(value)]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Display height map\r\n\t\t\tthis.showHeightmap(points, radius);\r\n\t\t},\r\n\t\tshowHeightmap(points, probeRadius) {\r\n\t\t\t// Clean up first\r\n\t\t\tif (this.three.meshGeometry) {\r\n\t\t\t\tthis.three.scene.remove(this.three.meshPlane);\r\n\t\t\t\tthis.three.meshIndicators.forEach(function(indicator) {\r\n\t\t\t\t\tthis.remove(indicator);\r\n\t\t\t\t}, this.three.scene);\r\n\r\n\t\t\t\tthis.three.meshGeometry = null;\r\n\t\t\t\tthis.three.meshPlane = null;\r\n\t\t\t\tthis.three.meshIndicators = null;\r\n\t\t\t\tthis.three.lastIntersection = null;\r\n\t\t\t}\r\n\r\n\t\t\t// Generate stats\r\n\t\t\tlet xMin, xMax, yMin, yMax;\r\n\r\n\t\t\tthis.radius = probeRadius;\r\n\t\t\tthis.numPoints = 0;\r\n\t\t\tthis.minDiff = undefined;\r\n\t\t\tthis.maxDiff = undefined;\r\n\t\t\tthis.meanError = 0;\r\n\t\t\tthis.rmsError = 0;\r\n\r\n\t\t\tfor (let i = 0; i < points.length; i++) {\r\n\t\t\t\tconst z = points[i][2];\r\n\t\t\t\tif (!isNaN(z)) {\r\n\t\t\t\t\tconst x = points[i][0];\r\n\t\t\t\t\tconst y = points[i][1];\r\n\t\t\t\t\tif (xMin === undefined || xMin > x) { xMin = x; }\r\n\t\t\t\t\tif (xMax === undefined || xMax < x) { xMax = x; }\r\n\t\t\t\t\tif (yMin === undefined || yMin > y) { yMin = y; }\r\n\t\t\t\t\tif (yMax === undefined || yMax < y) { yMax = y; }\r\n\r\n\t\t\t\t\tthis.numPoints++;\r\n\t\t\t\t\tthis.meanError += z;\r\n\t\t\t\t\tthis.rmsError += z * z;\r\n\t\t\t\t\tif (this.minDiff === undefined || this.minDiff > z) { this.minDiff = z; }\r\n\t\t\t\t\tif (this.maxDiff === undefined || this.maxDiff < z) { this.maxDiff = z; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.area = probeRadius ? (probeRadius * probeRadius * Math.PI) : Math.abs((xMax - xMin) * (yMax - yMin));\r\n\t\t\tthis.rmsError = Math.sqrt(((this.rmsError * this.numPoints) - (this.meanError * this.meanError))) / this.numPoints;\r\n\t\t\tthis.meanError = this.meanError / this.numPoints;\r\n\r\n\t\t\t// Generate mesh geometry and apply face colors\r\n\t\t\tthis.three.meshGeometry = generateMeshGeometry(points, xMin, xMax, yMin, yMax, scaleZ);\r\n\t\t\tsetFaceColors(this.three.meshGeometry, scaleZ, this.colorScheme, maxVisualizationZ);\r\n\r\n\t\t\t// Make 3D mesh and add it\r\n\t\t\tconst material = new MeshBasicMaterial({ vertexColors: VertexColors, side: DoubleSide });\r\n\t\t\tthis.three.meshPlane = new Mesh(this.three.meshGeometry, material);\r\n\t\t\tthis.three.scene.add(this.three.meshPlane);\r\n\r\n\t\t\t// Make indicators and add them\r\n\t\t\tthis.three.meshIndicators = generateIndicators(this.three.meshGeometry, this.numPoints, scaleZ, indicatorColor, indicatorOpacity);\r\n\t\t\tthis.three.meshIndicators.forEach(function(indicator) {\r\n\t\t\t\tthis.add(indicator);\r\n\t\t\t}, this.three.scene);\r\n\r\n\t\t\tif (!this.three.hasHelpers) {\r\n\t\t\t\t// Make axis arrows for XYZ\r\n\t\t\t\tthis.three.scene.add(new ArrowHelper(new Vector3(1, 0, 0), new Vector3(-0.6, -0.6, 0), 0.5, 0xFF0000));\r\n\t\t\t\tthis.three.scene.add(new ArrowHelper(new Vector3(0, 1, 0), new Vector3(-0.6, -0.6, 0), 0.5, 0x00FF00));\r\n\t\t\t\tthis.three.scene.add(new ArrowHelper(new Vector3(0, 0, 1), new Vector3(-0.6, -0.6, 0), 0.5, 0x0000FF));\r\n\r\n\t\t\t\t// Make grid on XY plane\r\n\t\t\t\tconst grid = new GridHelper(1.1, 15);\r\n\t\t\t\tgrid.rotation.x = -Math.PI / 2;\r\n\t\t\t\tthis.three.scene.add(grid);\r\n\r\n\t\t\t\t// Don't add these helpers again\r\n\t\t\t\tthis.three.hasHelpers = true;\r\n\t\t\t}\r\n\r\n\t\t\t// Render scene\r\n\t\t\tthis.ready = true;\r\n\t\t\tthis.render();\r\n\r\n\t\t\t// Resize it again when the values have been changed\r\n\t\t\tthis.$nextTick(this.resize);\r\n\t\t},\r\n\t\trender() {\r\n\t\t\tif (this.three.renderer) {\r\n\t\t\t\trequestAnimationFrame(this.render);\r\n\t\t\t\tthis.three.renderer.render(this.three.scene, this.three.camera);\r\n\t\t\t}\r\n\t\t},\r\n\t\tcanvasMouseMove(e) {\r\n\t\t\tif (!e.clientX || !this.three.meshGeometry) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Try to get the Z value below the cursor\r\n\t\t\t// For that we need normalized X+Y coordinates between -1.0 and 1.0\r\n\t\t\tconst rect = e.target.getBoundingClientRect();\r\n\t\t\tconst mouse = new Vector2();\r\n\t\t\tmouse.x = (e.clientX - rect.left) / e.target.clientWidth * 2 - 1;\r\n\t\t\tmouse.y = -(e.clientY - rect.top) / e.target.clientHeight * 2 + 1;\r\n\r\n\t\t\t// Is the cursor on a point indicator?\r\n\t\t\tthis.three.raycaster.setFromCamera(mouse, this.three.camera);\r\n\t\t\tconst intersection = this.three.raycaster.intersectObjects(this.three.meshIndicators);\r\n\t\t\tif (this.three.lastIntersection && (intersection.length === 0 || intersection[0] !== this.three.lastIntersection)) {\r\n\t\t\t\tthis.three.lastIntersection.object.material.opacity = indicatorOpacity;\r\n\t\t\t\tthis.three.lastIntersection = undefined;\r\n\t\t\t}\r\n\r\n\t\t\tlet intersectionPoint;\r\n\t\t\tif (intersection.length > 0) {\r\n\t\t\t\tif (intersection[0] !== this.three.lastIntersection) {\r\n\t\t\t\t\tintersection[0].object.material.opacity = indicatorOpacityHighlighted;\r\n\t\t\t\t\tthis.three.lastIntersection = intersection[0];\r\n\t\t\t\t}\r\n\t\t\t\tintersectionPoint = intersection[0].object.coords;\r\n\t\t\t}\r\n\r\n\t\t\t// Show or hide the tooltip\r\n\t\t\tif (intersectionPoint) {\r\n\t\t\t\tthis.tooltip.coord.x = intersectionPoint.x;\r\n\t\t\t\tthis.tooltip.coord.y = intersectionPoint.y;\r\n\t\t\t\tthis.tooltip.coord.z = intersectionPoint.z;\r\n\t\t\t\tthis.tooltip.x = e.clientX;\r\n\t\t\t\tthis.tooltip.y = e.clientY;\r\n\t\t\t\tthis.tooltip.shown = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.tooltip.shown = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\ttopView() {\r\n\t\t\tthis.three.camera.position.set(0, 0, 1.5);\r\n\t\t\tthis.three.camera.rotation.set(0, 0, 0);\r\n\t\t\tthis.three.camera.updateProjectionMatrix();\r\n\t\t},\r\n\r\n\t\tasync getHeightmap(filename) {\r\n\t\t\tif (this.loading) {\r\n\t\t\t\t// Don't attempt to load more than one file at once...\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!filename) {\r\n\t\t\t\tfilename = this.heightmapFile;\r\n\t\t\t\tif (!filename) {\r\n\t\t\t\t\tfilename = Path.combine(this.systemDirectory, Path.heightmapFile);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.ready = false;\r\n\t\t\tthis.loading = true;\r\n\t\t\ttry {\r\n\t\t\t\tconst heightmap = await this.download({ filename, type: 'text', showProgress: false, showSuccess: false, showError: false });\r\n\t\t\t\tthis.showCSV(heightmap);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.warn(e);\r\n\t\t\t\tthis.errorMessage = e.message;\r\n\t\t\t}\r\n\t\t\tthis.loading = false;\r\n\t\t},\r\n\r\n\t\ttestMesh() {\r\n\t\t\tconst csvData = 'RepRapFirmware height map file v1\\nxmin,xmax,ymin,ymax,radius,spacing,xnum,ynum\\n-140.00,140.10,-140.00,140.10,150.00,20.00,15,15\\n0,0,0,0,0,-0.139,-0.188,-0.139,-0.202,-0.224,0,0,0,0,0\\n0,0,0,-0.058,-0.066,-0.109,-0.141,-0.129,-0.186,-0.198,-0.191,-0.176,0,0,0\\n0,0,0.013,-0.008,-0.053,-0.071,-0.087,-0.113,-0.162,-0.190,-0.199,-0.267,-0.237,0,0\\n0,0.124,0.076,0.025,-0.026,-0.054,-0.078,-0.137,-0.127,-0.165,-0.201,-0.189,-0.227,-0.226,0\\n0,0.198,0.120,0.047,0.089,-0.074,-0.097,-0.153,-0.188,-0.477,-0.190,-0.199,-0.237,-0.211,0\\n0.312,0.229,0.198,0.098,0.097,0.004,-0.089,-0.516,-0.150,-0.209,-0.197,-0.183,-0.216,-0.296,-0.250\\n0.287,0.263,0.292,0.100,0.190,0.015,-0.102,-0.039,-0.125,-0.149,-0.137,-0.198,-0.188,-0.220,-0.192\\n0.378,0.289,0.328,0.172,0.133,0.078,-0.086,0.134,-0.100,-0.150,-0.176,-0.234,-0.187,-0.199,-0.221\\n0.360,0.291,0.260,0.185,0.111,0.108,0.024,0.073,-0.024,-0.116,-0.187,-0.252,-0.201,-0.215,-0.187\\n0.447,0.397,0.336,0.276,0.180,0.164,0.073,-0.050,-0.049,-0.109,-0.151,-0.172,-0.211,-0.175,-0.161\\n0,0.337,0.289,0.227,0.179,0.127,0.086,0.034,-0.039,-0.060,-0.113,-0.108,-0.171,-0.153,0\\n0,0.478,0.397,0.374,0.270,0.141,0.085,0.074,0.037,-0.048,-0.080,-0.187,-0.126,-0.175,0\\n0,0,0.373,0.364,0.265,0.161,0.139,0.212,0.040,0.046,-0.008,-0.149,-0.115,0,0\\n0,0,0,0.346,0.295,0.273,0.148,0.136,0.084,0.024,-0.055,-0.078,0,0,0\\n0,0,0,0,0,0.240,0.178,0.084,0.090,0.004,0,0,0,0,0';\r\n\t\t\tthis.showCSV(csvData);\r\n\t\t},\r\n\t\ttestBedCompensation(numPoints) {\r\n\t\t\tlet testPoints;\r\n\t\t\tswitch (numPoints) {\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\ttestPoints = [[15.0, 15.0, 0.123], [15.0, 195.0, -0.243], [215.0, 105.0, 0.034]];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\ttestPoints = [[15.0, 15.0, 0.015], [15.0, 185.0, -0.193], [175.0, 185.0, 0.156], [175.0, 15.0, 0.105]];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 5:\r\n\t\t\t\t\ttestPoints = [[15.0, 15.0, 0.007], [15.0, 185.0, -0.121], [175.0, 185.0, -0.019], [175.0, 15.0, 0.193], [95.0, 100.0, 0.05]];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error(\"Bad number of probe points, only one of 3/4/5 is supported\");\r\n\t\t\t}\r\n\t\t\tthis.showHeightmap(testPoints);\r\n\t\t}\r\n\t},\r\n\tactivated() {\r\n\t\tthis.isActive = true;\r\n\t\tthis.resize();\r\n\t},\r\n\tdeactivate() {\r\n\t\tthis.isActive = false;\r\n\t},\r\n\tmounted() {\r\n\t\tconst getHeightmap = this.getHeightmap;\r\n\t\tthis.unsubscribe = this.$store.subscribeAction(function(action, state) {\r\n\t\t\tif (getModifiedFiles(action, state).indexOf(Path.heightmapFile) !== -1 ||\r\n\t\t\t\taction.type.endsWith('onCodeCompleted') && action.payload.reply.indexOf(Path.heightmapFile) !== -1) {\r\n\t\t\t\tgetHeightmap();\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// FIXME give the grid some time to resize everything...\r\n\t\tsetTimeout(this.init, 100);\r\n\t},\r\n\tbeforeDestroy() {\r\n\t\tthis.unsubscribe();\r\n\r\n\t\tif (this.three.renderer) {\r\n\t\t\tthis.three.renderer.forceContextLoss();\r\n\t\t\tthis.three.renderer = null;\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tcolorScheme(to) {\r\n\t\t\tif (this.three.meshGeometry) {\r\n\t\t\t\tsetFaceColors(this.three.meshGeometry, scaleZ, to, maxVisualizationZ);\r\n\t\t\t}\r\n\t\t\tdrawLegend(this.$refs.legend, maxVisualizationZ, to);\r\n\t\t},\r\n\t\tisConnected(to) {\r\n\t\t\tif (to) {\r\n\t\t\t\tthis.getHeightmap();\r\n\t\t\t}\r\n\t\t},\r\n\t\theightmapFile(to) {\r\n\t\t\tif (to) {\r\n\t\t\t\tthis.getHeightmap(to);\r\n\t\t\t}\r\n\t\t},\r\n\t\tlanguage() {\r\n\t\t\tdrawLegend(this.$refs.legend, maxVisualizationZ, this.colorScheme);\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"],"sourceRoot":"src/components/panels"}]}