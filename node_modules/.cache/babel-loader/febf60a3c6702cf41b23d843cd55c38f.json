{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js??ref--18-0!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\buttons\\UploadBtn.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\buttons\\UploadBtn.vue","mtime":1592248188509},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KJ3VzZSBzdHJpY3QnOwoKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmRleC1vZiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb21lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuY29uc3RydWN0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuZW5kcy13aXRoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzpcXFVzZXJzXFxqcGF0cmlja1xcRG9jdW1lbnRzXFxHaXRIdWJcXER1ZXRXZWJDb250cm9sX0ZvcmtcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICJDOlxcVXNlcnNcXGpwYXRyaWNrXFxEb2N1bWVudHNcXEdpdEh1YlxcRHVldFdlYkNvbnRyb2xfRm9ya1xcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vb2JqZWN0U3ByZWFkMiI7CmltcG9ydCBKU1ppcCBmcm9tICdqc3ppcCc7CmltcG9ydCB7IFZCdG4gfSBmcm9tICd2dWV0aWZ5L2xpYic7CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBHZXR0ZXJzLCBtYXBBY3Rpb25zIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IE5ldHdvcmtJbnRlcmZhY2VUeXBlLCBTdGF0dXNUeXBlIH0gZnJvbSAnLi4vLi4vc3RvcmUvbWFjaGluZS9tb2RlbEVudW1zLmpzJzsKaW1wb3J0IFBhdGggZnJvbSAnLi4vLi4vdXRpbHMvcGF0aC5qcyc7CmltcG9ydCB7IERpc2Nvbm5lY3RlZEVycm9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3JzLmpzJzsKdmFyIHdlYkV4dGVuc2lvbnMgPSBbJy5odG0nLCAnLmh0bWwnLCAnLmljbycsICcueG1sJywgJy5jc3MnLCAnLm1hcCcsICcuanMnLCAnLnR0ZicsICcuZW90JywgJy5zdmcnLCAnLndvZmYnLCAnLndvZmYyJywgJy5qcGVnJywgJy5qcGcnLCAnLnBuZyddOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcHV0ZWQ6IF9vYmplY3RTcHJlYWQoe30sIG1hcFN0YXRlKFsnaXNMb2NhbCddKSwge30sIG1hcFN0YXRlKCdtYWNoaW5lL21vZGVsJywgWydib2FyZHMnLCAnZGlyZWN0b3JpZXMnLCAnbmV0d29yaycsICdzdGF0ZSddKSwge30sIG1hcEdldHRlcnMoWydpc0Nvbm5lY3RlZCcsICd1aUZyb3plbiddKSwgewogICAgY2FwdGlvbjogZnVuY3Rpb24gY2FwdGlvbigpIHsKICAgICAgaWYgKHRoaXMuZXh0cmFjdGluZykgewogICAgICAgIHJldHVybiB0aGlzLiR0KCdnZW5lcmljLmV4dHJhY3RpbmcnKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudXBsb2FkaW5nKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHQoJ2dlbmVyaWMudXBsb2FkaW5nJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLiR0KCJidXR0b24udXBsb2FkWyciLmNvbmNhdCh0aGlzLnRhcmdldCwgIiddLmNhcHRpb24iKSk7CiAgICB9LAogICAgY2FuVXBsb2FkOiBmdW5jdGlvbiBjYW5VcGxvYWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzQ29ubmVjdGVkICYmICF0aGlzLnVpRnJvemVuOwogICAgfSwKICAgIGFjY2VwdDogZnVuY3Rpb24gYWNjZXB0KCkgewogICAgICBzd2l0Y2ggKHRoaXMudGFyZ2V0KSB7CiAgICAgICAgY2FzZSAnZ2NvZGVzJzoKICAgICAgICAgIHJldHVybiAnLmcsLmdjb2RlLC5nYywuZ2NvLC5uYywubmdjLC50YXAnOwoKICAgICAgICBjYXNlICdzdGFydCc6CiAgICAgICAgICByZXR1cm4gJy5nLC5nY29kZSwuZ2MsLmdjbywubmMsLm5nYywudGFwJzsKCiAgICAgICAgY2FzZSAnbWFjcm9zJzoKICAgICAgICAgIHJldHVybiAnKic7CgogICAgICAgIGNhc2UgJ2ZpbGFtZW50cyc6CiAgICAgICAgICByZXR1cm4gJy56aXAnOwoKICAgICAgICBjYXNlICdmaXJtd2FyZSc6CiAgICAgICAgICByZXR1cm4gJy56aXAsLmJpbic7CgogICAgICAgIGNhc2UgJ21lbnUnOgogICAgICAgICAgcmV0dXJuICcqJzsKCiAgICAgICAgY2FzZSAnc3lzdGVtJzoKICAgICAgICAgIHJldHVybiAnLnppcCwuYmluLC5qc29uLC5nLC5jc3YnOwoKICAgICAgICBjYXNlICd3ZWInOgogICAgICAgICAgcmV0dXJuICcuemlwLC5jc3YsLmpzb24sLmh0bSwuaHRtbCwuaWNvLC54bWwsLmNzcywubWFwLC5qcywudHRmLC5lb3QsLnN2Zywud29mZiwud29mZjIsLmpwZWcsLmpwZywucG5nLC5neic7CiAgICAgIH0KCiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9LAogICAgZGVzdGluYXRpb25EaXJlY3Rvcnk6IGZ1bmN0aW9uIGRlc3RpbmF0aW9uRGlyZWN0b3J5KCkgewogICAgICBpZiAodGhpcy5kaXJlY3RvcnkpIHsKICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3Rvcnk7CiAgICAgIH0KCiAgICAgIHN3aXRjaCAodGhpcy50YXJnZXQpIHsKICAgICAgICBjYXNlICdnY29kZXMnOgogICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0b3JpZXMuZ0NvZGVzOwoKICAgICAgICBjYXNlICdzdGFydCc6CiAgICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3Rvcmllcy5nQ29kZXM7CgogICAgICAgIGNhc2UgJ2Zpcm13YXJlJzoKICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdG9yaWVzLmZpcm13YXJlOwoKICAgICAgICBjYXNlICdtYWNyb3MnOgogICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0b3JpZXMubWFjcm9zOwoKICAgICAgICBjYXNlICdmaWxhbWVudHMnOgogICAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0b3JpZXMuZmlsYW1lbnRzOwoKICAgICAgICBjYXNlICdtZW51JzoKICAgICAgICAgIHJldHVybiB0aGlzLmRpcmVjdG9yaWVzLm1lbnU7CgogICAgICAgIGNhc2UgJ3N5c3RlbSc6CiAgICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3Rvcmllcy5zeXN0ZW07CgogICAgICAgIGNhc2UgJ3dlYic6CiAgICAgICAgICByZXR1cm4gdGhpcy5kaXJlY3Rvcmllcy53ZWI7CiAgICAgIH0KCiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9LAogICAgaXNCdXN5OiBmdW5jdGlvbiBpc0J1c3koKSB7CiAgICAgIHJldHVybiB0aGlzLmV4dHJhY3RpbmcgfHwgdGhpcy51cGxvYWRpbmc7CiAgICB9CiAgfSksCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlubmVyQ29sb3I6IHRoaXMuY29sb3IsCiAgICAgIGV4dHJhY3Rpbmc6IGZhbHNlLAogICAgICB1cGxvYWRpbmc6IGZhbHNlLAogICAgICBjb25maXJtVXBkYXRlOiBmYWxzZSwKICAgICAgdXBkYXRlczogewogICAgICAgIHdlYkludGVyZmFjZTogZmFsc2UsCiAgICAgICAgZmlybXdhcmVCb2FyZHM6IFtdLAogICAgICAgIHdpZmlTZXJ2ZXI6IGZhbHNlLAogICAgICAgIHdpZmlTZXJ2ZXJTcGlmZnM6IGZhbHNlLAogICAgICAgIGNvZGVTZW50OiBmYWxzZQogICAgICB9CiAgICB9OwogIH0sCiAgZXh0ZW5kczogVkJ0biwKICBwcm9wczogewogICAgZGlyZWN0b3J5OiBTdHJpbmcsCiAgICB0YXJnZXQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIHVwbG9hZFByaW50OiBCb29sZWFuCiAgfSwKICBtZXRob2RzOiBfb2JqZWN0U3ByZWFkKHt9LCBtYXBBY3Rpb25zKCdtYWNoaW5lJywgWydzZW5kQ29kZScsICd1cGxvYWQnXSksIHsKICAgIGNob29zZUZpbGU6IGZ1bmN0aW9uIGNob29zZUZpbGUoKSB7CiAgICAgIGlmICghdGhpcy5pc0J1c3kpIHsKICAgICAgICB0aGlzLiRyZWZzLmZpbGVJbnB1dC5jbGljaygpOwogICAgICB9CiAgICB9LAogICAgZmlsZVNlbGVjdGVkOiBmdW5jdGlvbiBmaWxlU2VsZWN0ZWQoZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5kb1VwbG9hZChlLnRhcmdldC5maWxlcyk7CgogICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgIGUudGFyZ2V0LnZhbHVlID0gJyc7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBpc1dlYkZpbGU6IGZ1bmN0aW9uIGlzV2ViRmlsZShmaWxlbmFtZSkgewogICAgICBpZiAod2ViRXh0ZW5zaW9ucy5zb21lKGZ1bmN0aW9uIChleHRlbnNpb24pIHsKICAgICAgICByZXR1cm4gZmlsZW5hbWUudG9Mb3dlckNhc2UoKS5lbmRzV2l0aChleHRlbnNpb24pOwogICAgICB9KSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICB2YXIgbWF0Y2hlcyA9IC8oXC5bXi5dKykuZ3okL2kuZXhlYyhmaWxlbmFtZSk7CgogICAgICBpZiAobWF0Y2hlcyAmJiB3ZWJFeHRlbnNpb25zLmluZGV4T2YobWF0Y2hlc1sxXS50b0xvd2VyQ2FzZSgpKSAhPT0gLTEpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIGdldEZpcm13YXJlTmFtZTogZnVuY3Rpb24gZ2V0RmlybXdhcmVOYW1lKGZpbGVOYW1lKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIHJlc3VsdCA9IG51bGw7CiAgICAgIHRoaXMuYm9hcmRzLmZvckVhY2goZnVuY3Rpb24gKGJvYXJkLCBpbmRleCkgewogICAgICAgIGlmIChib2FyZCAmJiBib2FyZC5maXJtd2FyZUZpbGVOYW1lICYmIChib2FyZC5jYW5BZGRyZXNzIHx8IGluZGV4ID09PSAwKSkgewogICAgICAgICAgdmFyIHJlZ0V4ID0gbmV3IFJlZ0V4cChib2FyZC5maXJtd2FyZUZpbGVOYW1lLnJlcGxhY2UoL1wuYmluJC8sICcoLiopXFwuYmluJyksICdpJyk7CgogICAgICAgICAgaWYgKHJlZ0V4LnRlc3QoZmlsZU5hbWUpKSB7CiAgICAgICAgICAgIHJlc3VsdCA9IGJvYXJkLmZpcm13YXJlRmlsZU5hbWU7CgogICAgICAgICAgICBfdGhpczIudXBkYXRlcy5maXJtd2FyZUJvYXJkcy5wdXNoKGJvYXJkLmNhbkFkZHJlc3MgfHwgMCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB0aGlzKTsKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBnZXRCaW5hcnlOYW1lOiBmdW5jdGlvbiBnZXRCaW5hcnlOYW1lKGtleSwgZmlsZU5hbWUpIHsKICAgICAgdmFyIHJlc3VsdCA9IG51bGw7CiAgICAgIHRoaXMuYm9hcmRzLmZvckVhY2goZnVuY3Rpb24gKGJvYXJkKSB7CiAgICAgICAgaWYgKGJvYXJkICYmIGJvYXJkW2tleV0pIHsKICAgICAgICAgIHZhciByZWdFeCA9IG5ldyBSZWdFeHAoYm9hcmRba2V5XS5yZXBsYWNlKC9cLmJpbiQvLCAnKC4qKVxcLmJpbicpLCAnaScpOwoKICAgICAgICAgIGlmIChyZWdFeC50ZXN0KGZpbGVOYW1lKSkgewogICAgICAgICAgICByZXN1bHQgPSBib2FyZFtrZXldOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9LAogICAgZG9VcGxvYWQ6IGZ1bmN0aW9uIGRvVXBsb2FkKGZpbGVzLCB6aXBOYW1lLCBzdGFydFRpbWUpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgemlwLCB6aXBGaWxlcywgdGFyZ2V0LCBpLCBuYW1lLCBzdWNjZXNzLCBfaSwgY29udGVudCwgZmlsZW5hbWUsIGZpcm13YXJlRmlsZU5hbWUsIGJvb3Rsb2FkZXJGaWxlTmFtZSwgaWFwRmlsZU5hbWVTQkMsIGlhcEZpbGVOYW1lU0QsIHNlY29uZHNQYXNzZWQ7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZiAoZmlsZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczMudGFyZ2V0ID09PSAnc3RhcnQnICYmIGZpbGVzLmxlbmd0aCAhPT0gMSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczMuJG1ha2VOb3RpZmljYXRpb24oJ2Vycm9yJywgX3RoaXMzLiR0KCJidXR0b24udXBsb2FkWyciLmNvbmNhdChfdGhpczMudGFyZ2V0LCAiJ10uY2FwdGlvbiIpKSwgX3RoaXMzLiR0KCdlcnJvci51cGxvYWRTdGFydFdyb25nRmlsZUNvdW50JykpOwoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgaWYgKHppcE5hbWUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEoZmlsZXMubGVuZ3RoID4gMSAmJiBmaWxlc1swXS5uYW1lLnRvTG93ZXJDYXNlKCkuZW5kc1dpdGgoJy56aXAnKSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczMuJG1ha2VOb3RpZmljYXRpb24oJ2Vycm9yJywgX3RoaXMzLiR0KCJidXR0b24udXBsb2FkWyciLmNvbmNhdChfdGhpczMudGFyZ2V0LCAiJ10uY2FwdGlvbiIpKSwgX3RoaXMzLiR0KCdlcnJvci51cGxvYWROb1NpbmdsZVpJUCcpKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIGlmICghZmlsZXNbMF0ubmFtZS50b0xvd2VyQ2FzZSgpLmVuZHNXaXRoKCcuemlwJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgemlwID0gbmV3IEpTWmlwKCksIHppcEZpbGVzID0gW10sIHRhcmdldCA9IF90aGlzMy50YXJnZXQ7CiAgICAgICAgICAgICAgICBfdGhpczMuZXh0cmFjdGluZyA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDEyOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIHJldHVybiB6aXAubG9hZEFzeW5jKGZpbGVzWzBdLCB7CiAgICAgICAgICAgICAgICAgIGNoZWNrQ1JDMzI6IHRydWUKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgemlwLmZvckVhY2goZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICAgICAgICAgICAgaWYgKCFmaWxlLmVuZHNXaXRoKCcvJykgJiYgKGZpbGUuc3BsaXQoJy8nKS5sZW5ndGggPT09IDIgfHwgdGFyZ2V0ICE9PSAnZmlsYW1lbnRzJykpIHsKICAgICAgICAgICAgICAgICAgICB6aXBGaWxlcy5wdXNoKGZpbGUpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsgLy8gQ291bGQgd2UgZ2V0IGFueXRoaW5nIHVzZWZ1bD8KCiAgICAgICAgICAgICAgICBpZiAoemlwRmlsZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzMy5leHRyYWN0aW5nID0gZmFsc2U7CgogICAgICAgICAgICAgICAgX3RoaXMzLiRtYWtlTm90aWZpY2F0aW9uKCdlcnJvcicsIF90aGlzMy4kdCgiYnV0dG9uLnVwbG9hZFsnIi5jb25jYXQoX3RoaXMzLnRhcmdldCwgIiddLmNhcHRpb24iKSksIF90aGlzMy4kdCgnZXJyb3IudXBsb2FkTm9GaWxlcycpKTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICBpID0gMDsKCiAgICAgICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgICAgIGlmICghKGkgPCB6aXBGaWxlcy5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG5hbWUgPSB6aXBGaWxlc1tpXTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjU7CiAgICAgICAgICAgICAgICByZXR1cm4gemlwLmZpbGUobmFtZSkuYXN5bmMoJ2Jsb2InKTsKCiAgICAgICAgICAgICAgY2FzZSAyNToKICAgICAgICAgICAgICAgIHppcEZpbGVzW2ldID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgICB6aXBGaWxlc1tpXS5uYW1lID0gbmFtZTsKCiAgICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICAgIF90aGlzMy5kb1VwbG9hZCh6aXBGaWxlcywgZmlsZXNbMF0ubmFtZSwgbmV3IERhdGUoKSk7CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzNzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAzMzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi50MCA9IF9jb250ZXh0MlsiY2F0Y2giXSgxMik7CiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oX2NvbnRleHQyLnQwKTsKCiAgICAgICAgICAgICAgICBfdGhpczMuJG1ha2VOb3RpZmljYXRpb24oJ2Vycm9yJywgX3RoaXMzLiR0KCdlcnJvci51cGxvYWREZWNvbXByZXNzaW9uRmFpbGVkJyksIF9jb250ZXh0Mi50MC5tZXNzYWdlKTsKCiAgICAgICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgICAgIF90aGlzMy5leHRyYWN0aW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzk6CiAgICAgICAgICAgICAgICBfdGhpczMudXBkYXRlcy53ZWJJbnRlcmZhY2UgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF90aGlzMy51cGRhdGVzLmZpcm13YXJlQm9hcmRzID0gW107CiAgICAgICAgICAgICAgICBfdGhpczMudXBkYXRlcy53aWZpU2VydmVyID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfdGhpczMudXBkYXRlcy53aWZpU2VydmVyU3BpZmZzID0gZmFsc2U7CiAgICAgICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF90aGlzMy51cGxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICAgICAgX2kgPSAwOwoKICAgICAgICAgICAgICBjYXNlIDQ2OgogICAgICAgICAgICAgICAgaWYgKCEoX2kgPCBmaWxlcy5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBmaWxlc1tfaV07IC8vIEFkanVzdCBmaWxlbmFtZSBpZiBhbiB1cGRhdGUgaXMgYmVpbmcgdXBsb2FkZWQKCiAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IFBhdGguY29tYmluZShfdGhpczMuZGVzdGluYXRpb25EaXJlY3RvcnksIGNvbnRlbnQubmFtZSk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzMy50YXJnZXQgPT09ICdzeXN0ZW0nIHx8IF90aGlzMy50YXJnZXQgPT09ICdmaXJtd2FyZScpIHsKICAgICAgICAgICAgICAgICAgaWYgKFBhdGguaXNTZFBhdGgoJy8nICsgY29udGVudC5uYW1lKSkgewogICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gUGF0aC5jb21iaW5lKCcwOi8nLCBjb250ZW50Lm5hbWUpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMy5pc1dlYkZpbGUoY29udGVudC5uYW1lKSkgewogICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gUGF0aC5jb21iaW5lKF90aGlzMy5kaXJlY3Rvcmllcy53ZWIsIGNvbnRlbnQubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLnVwZGF0ZXMud2ViSW50ZXJmYWNlIHw9IC9pbmRleC5odG1sKFwuZ3opPy9pLnRlc3QoY29udGVudC5uYW1lKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBmaXJtd2FyZUZpbGVOYW1lID0gX3RoaXMzLmdldEZpcm13YXJlTmFtZShjb250ZW50Lm5hbWUpOwogICAgICAgICAgICAgICAgICAgIGJvb3Rsb2FkZXJGaWxlTmFtZSA9IF90aGlzMy5nZXRCaW5hcnlOYW1lKCdib290bG9hZGVyRmlsZU5hbWUnLCBjb250ZW50Lm5hbWUpOwogICAgICAgICAgICAgICAgICAgIGlhcEZpbGVOYW1lU0JDID0gX3RoaXMzLmdldEJpbmFyeU5hbWUoJ2lhcEZpbGVOYW1lU0JDJywgY29udGVudC5uYW1lKTsKICAgICAgICAgICAgICAgICAgICBpYXBGaWxlTmFtZVNEID0gX3RoaXMzLmdldEJpbmFyeU5hbWUoJ2lhcEZpbGVOYW1lU0QnLCBjb250ZW50Lm5hbWUpOwoKICAgICAgICAgICAgICAgICAgICBpZiAoZmlybXdhcmVGaWxlTmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUoX3RoaXMzLmRpcmVjdG9yaWVzLmZpcm13YXJlLCBmaXJtd2FyZUZpbGVOYW1lKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJvb3Rsb2FkZXJGaWxlTmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUoX3RoaXMzLmRpcmVjdG9yaWVzLmZpcm13YXJlLCBib290bG9hZGVyRmlsZU5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMzLnN0YXRlLmRzZlZlcnNpb24gJiYgaWFwRmlsZU5hbWVTQkMpIHsKICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gUGF0aC5jb21iaW5lKF90aGlzMy5kaXJlY3Rvcmllcy5maXJtd2FyZSwgaWFwRmlsZU5hbWVTQkMpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaWFwRmlsZU5hbWVTRCkgewogICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUoX3RoaXMzLmRpcmVjdG9yaWVzLmZpcm13YXJlLCBpYXBGaWxlTmFtZVNEKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFfdGhpczMuc3RhdGUuZHNmVmVyc2lvbiAmJiBfdGhpczMubmV0d29yay5pbnRlcmZhY2VzLnNvbWUoZnVuY3Rpb24gKGlmYWNlKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaWZhY2UudHlwZSA9PT0gTmV0d29ya0ludGVyZmFjZVR5cGUud2lmaTsKICAgICAgICAgICAgICAgICAgICB9KSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKC9EdWV0V2lGaVNvY2tldFNlcnZlciguKilcLmJpbi9pLnRlc3QoY29udGVudC5uYW1lKSB8fCAvRHVldFdpRmlTZXJ2ZXIoLiopXC5iaW4vaS50ZXN0KGNvbnRlbnQubmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUoX3RoaXMzLmRpcmVjdG9yaWVzLmZpcm13YXJlLCAnRHVldFdpRmlTZXJ2ZXIuYmluJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy51cGRhdGVzLndpZmlTZXJ2ZXIgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgvRHVldFdlYkNvbnRyb2woLiopXC5iaW4vaS50ZXN0KGNvbnRlbnQubmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUoX3RoaXMzLmRpcmVjdG9yaWVzLmZpcm13YXJlLCAnRHVldFdlYkNvbnRyb2wuYmluJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy51cGRhdGVzLndpZmlTZXJ2ZXJTcGlmZnMgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVudC5uYW1lLmVuZHNXaXRoKCcuYmluJykpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIEZJWE1FIFRoaXMgd2lsbCBiZSBubyBsb25nZXIgbmVlZGVkIHdoZW4gQ0FOIGJvYXJkIGVudW1lcmF0aW9uIGlzIHN1cHBvcnRlZAogICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUoX3RoaXMzLmRpcmVjdG9yaWVzLmZpcm13YXJlLCBjb250ZW50Lm5hbWUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gNTA7CgogICAgICAgICAgICAgICAgaWYgKCEoZmlsZXMubGVuZ3RoID4gMSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1NjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA1NDsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczMudXBsb2FkKHsKICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IGZpbGVuYW1lLAogICAgICAgICAgICAgICAgICBjb250ZW50OiBjb250ZW50LAogICAgICAgICAgICAgICAgICBzaG93U3VjY2VzczogIXppcE5hbWUsCiAgICAgICAgICAgICAgICAgIG51bTogX2kgKyAxLAogICAgICAgICAgICAgICAgICBjb3VudDogZmlsZXMubGVuZ3RoCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA1NDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA1NjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNTg7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLnVwbG9hZCh7CiAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgNTg6CiAgICAgICAgICAgICAgICBpZiAoIShfdGhpczMudGFyZ2V0ID09PSAnc3RhcnQnKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDYxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDYxOwogICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy5zZW5kQ29kZSgiTTMyIFwiIi5jb25jYXQoZmlsZW5hbWUsICJcIiIpKTsKCiAgICAgICAgICAgICAgY2FzZSA2MToKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjg7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA2MzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gNjM7CiAgICAgICAgICAgICAgICBfY29udGV4dDIudDEgPSBfY29udGV4dDJbImNhdGNoIl0oNTApOwogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIF90aGlzMy4kZW1pdCgndXBsb2FkRmFpbGVkJywgewogICAgICAgICAgICAgICAgICBmaWxlbmFtZTogZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgIHJlYXNvbjogX2NvbnRleHQyLnQxCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgiYnJlYWsiLCA3MSk7CgogICAgICAgICAgICAgIGNhc2UgNjg6CiAgICAgICAgICAgICAgICBfaSsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0NjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDcxOgogICAgICAgICAgICAgICAgX3RoaXMzLnVwbG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMy4kZW1pdCgndXBsb2FkQ29tcGxldGUnLCBmaWxlcyk7CgogICAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLnVwZGF0ZXMuZmlybXdhcmVCb2FyZHMubGVuZ3RoID4gMCB8fCBfdGhpczMudXBkYXRlcy53aWZpU2VydmVyIHx8IF90aGlzMy51cGRhdGVzLndpZmlTZXJ2ZXJTcGlmZnMpIHsKICAgICAgICAgICAgICAgICAgICAvLyBBc2sgdXNlciB0byBwZXJmb3JtIGFuIHVwZGF0ZQogICAgICAgICAgICAgICAgICAgIF90aGlzMy5jb25maXJtVXBkYXRlID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICghX3RoaXMzLmlzTG9jYWwgJiYgX3RoaXMzLnVwZGF0ZXMud2ViSW50ZXJmYWNlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gUmVsb2FkIHRoZSB3ZWIgaW50ZXJmYWNlIGltbWVkaWF0ZWx5IGlmIGl0IHdhcyB0aGUgb25seSB1cGRhdGUKICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQodHJ1ZSk7CiAgICAgICAgICAgICAgICAgIH0gLy8gRklYTUUgRm9yIHNvbWUgcmVhc29uIHRoZSAkdCBmdW5jdGlvbiB0aHJvd3MgYW4gZXhjZXB0aW9uIHdoZW4gdGhpcyBidXR0b24gaXMgZmxvYXRpbmcKCgogICAgICAgICAgICAgICAgICBpZiAoemlwTmFtZSkgewogICAgICAgICAgICAgICAgICAgIHNlY29uZHNQYXNzZWQgPSBNYXRoLnJvdW5kKChuZXcgRGF0ZSgpIC0gc3RhcnRUaW1lKSAvIDEwMDApOwoKICAgICAgICAgICAgICAgICAgICBfdGhpczMuJG1ha2VOb3RpZmljYXRpb24oJ3N1Y2Nlc3MnLCBfdGhpczMuJHQoJ25vdGlmaWNhdGlvbi51cGxvYWQuc3VjY2VzcycsIFt6aXBOYW1lLCBfdGhpczMuJGRpc3BsYXlUaW1lKHNlY29uZHNQYXNzZWQpXSkpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgNzM6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIG51bGwsIFtbMTIsIDMzXSwgWzUwLCA2M11dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgc3RhcnRVcGRhdGU6IGZ1bmN0aW9uIHN0YXJ0VXBkYXRlKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciBpLCBib2FyZFRvVXBkYXRlLCBtb2R1bGVzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpID0gMDsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgaWYgKCEoaSA8IF90aGlzNC51cGRhdGVzLmZpcm13YXJlQm9hcmRzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyMDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYm9hcmRUb1VwZGF0ZSA9IF90aGlzNC51cGRhdGVzLmZpcm13YXJlQm9hcmRzW2ldOwoKICAgICAgICAgICAgICAgIGlmICghKGJvYXJkVG9VcGRhdGUgPiAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDQ7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM0LnNlbmRDb2RlKCJNOTk3IEIiLmNvbmNhdChib2FyZFRvVXBkYXRlKSk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gc2V0VGltZW91dChyZXNvbHZlLCAyMDAwKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICBpZiAoX3RoaXM0LmlzQ29ubmVjdGVkKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIGlmIChfdGhpczQuc3RhdGUuc3RhdHVzID09PSBTdGF0dXNUeXBlLnVwZGF0aW5nKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDE0OwogICAgICAgICAgICAgICAgX2NvbnRleHQzLnQwID0gX2NvbnRleHQzWyJjYXRjaCJdKDQpOwoKICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0My50MCBpbnN0YW5jZW9mIERpc2Nvbm5lY3RlZEVycm9yKSkgewogICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oX2NvbnRleHQzLnQwKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzNC4kbG9nKCdlcnJvcicsIF90aGlzNC4kdCgnZ2VuZXJpYy5lcnJvcicpLCBfY29udGV4dDMudDAubWVzc2FnZSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICBpKys7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBvdGhlciBtb2R1bGVzCiAgICAgICAgICAgICAgICBtb2R1bGVzID0gW107CgogICAgICAgICAgICAgICAgaWYgKF90aGlzNC51cGRhdGVzLmZpcm13YXJlQm9hcmRzLmluZGV4T2YoMCkgPj0gMCkgewogICAgICAgICAgICAgICAgICBtb2R1bGVzLnB1c2goJzAnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoX3RoaXM0LnVwZGF0ZXMud2lmaVNlcnZlcikgewogICAgICAgICAgICAgICAgICBtb2R1bGVzLnB1c2goJzEnKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoX3RoaXM0LnVwZGF0ZXMud2lmaVNlcnZlclNwaWZmcykgewogICAgICAgICAgICAgICAgICBtb2R1bGVzLnB1c2goJzInKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGhpczQudXBkYXRlcy5jb2RlU2VudCA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDI1OwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyODsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczQuc2VuZENvZGUoIk05OTcgUyIuY29uY2F0KG1vZHVsZXMuam9pbignOicpKSk7CgogICAgICAgICAgICAgIGNhc2UgMjg6CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDMzOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgICAgICBfY29udGV4dDMucHJldiA9IDMwOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLnQxID0gX2NvbnRleHQzWyJjYXRjaCJdKDI1KTsKCiAgICAgICAgICAgICAgICBpZiAoIShfY29udGV4dDMudDEgaW5zdGFuY2VvZiBEaXNjb25uZWN0ZWRFcnJvcikpIHsKICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKF9jb250ZXh0My50MSk7CgogICAgICAgICAgICAgICAgICBfdGhpczQuJGxvZygnZXJyb3InLCBfdGhpczQuJHQoJ2dlbmVyaWMuZXJyb3InKSwgX2NvbnRleHQzLnQxLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCBudWxsLCBbWzQsIDE0XSwgWzI1LCAzMF1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgZHJhZ092ZXI6IGZ1bmN0aW9uIGRyYWdPdmVyKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwoKICAgICAgaWYgKCF0aGlzLmlzQnVzeSkgewogICAgICAgIHRoaXMuaW5uZXJDb2xvciA9ICdzdWNjZXNzJzsKICAgICAgfQogICAgfSwKICAgIGRyYWdMZWF2ZTogZnVuY3Rpb24gZHJhZ0xlYXZlKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB0aGlzLmlubmVyQ29sb3IgPSB0aGlzLmNvbG9yOwogICAgfSwKICAgIGRyYWdEcm9wOiBmdW5jdGlvbiBkcmFnRHJvcChlKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzNS5pbm5lckNvbG9yID0gX3RoaXM1LmNvbG9yOwoKICAgICAgICAgICAgICAgIGlmICghKCFfdGhpczUuaXNCdXN5ICYmIGUuZGF0YVRyYW5zZmVyLmZpbGVzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM1LmRvVXBsb2FkKGUuZGF0YVRyYW5zZmVyLmZpbGVzKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0KTsKICAgICAgfSkpKCk7CiAgICB9CiAgfSksCiAgd2F0Y2g6IHsKICAgIGlzQ29ubmVjdGVkOiBmdW5jdGlvbiBpc0Nvbm5lY3RlZCh0bykgewogICAgICBpZiAodG8gJiYgIXRoaXMuaXNMb2NhbCAmJiB0aGlzLnVwZGF0ZXMuY29kZVNlbnQgJiYgdGhpcy51cGRhdGVzLndlYkludGVyZmFjZSkgewogICAgICAgIC8vIFJlbG9hZCB0aGUgd2ViIGludGVyZmFjZSB3aGVuIHRoZSBjb25uZWN0aW9uIGNvdWxkIGJlIGVzdGFibGlzaGVkIGFnYWluCiAgICAgICAgbG9jYXRpb24ucmVsb2FkKHRydWUpOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["UploadBtn.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<v-btn v-bind=\"$props\" @click=\"chooseFile\" :disabled=\"$props.disabled || !canUpload\" :loading=\"isBusy\" :title=\"$t(`button.upload['${target}'].title`)\" :color=\"innerColor\" @dragover=\"dragOver\" @dragleave=\"dragLeave\" @drop.prevent.stop=\"dragDrop\">\r\n\t\t\t<template #loader>\r\n\t\t\t\t<v-progress-circular indeterminate :size=\"23\" :width=\"2\" class=\"mr-2\"></v-progress-circular>\r\n\t\t\t\t{{ caption }}\r\n\t\t\t</template>\r\n\r\n\t\t\t<slot>\r\n\t\t\t\t<v-icon class=\"mr-2\">mdi-cloud-upload</v-icon> {{ caption }}\r\n\t\t\t</slot>\r\n\t\t</v-btn>\r\n\r\n\t\t<input ref=\"fileInput\" type=\"file\" :accept=\"accept\" hidden @change=\"fileSelected\" multiple>\r\n\t\t<confirm-dialog :shown.sync=\"confirmUpdate\" :title=\"$t('dialog.update.title')\" :prompt=\"$t('dialog.update.prompt')\" @confirmed=\"startUpdate\"></confirm-dialog>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport JSZip from 'jszip'\r\nimport { VBtn } from 'vuetify/lib'\r\n\r\nimport { mapState, mapGetters, mapActions } from 'vuex'\r\n\r\nimport { NetworkInterfaceType, StatusType } from '../../store/machine/modelEnums.js'\r\nimport Path from '../../utils/path.js'\r\nimport { DisconnectedError } from '../../utils/errors.js'\r\n\r\nconst webExtensions = ['.htm', '.html', '.ico', '.xml', '.css', '.map', '.js', '.ttf', '.eot', '.svg', '.woff', '.woff2', '.jpeg', '.jpg', '.png']\r\n\r\nexport default {\r\n\tcomputed: {\r\n\t\t...mapState(['isLocal']),\r\n\t\t...mapState('machine/model', ['boards', 'directories', 'network', 'state']),\r\n\t\t...mapGetters(['isConnected', 'uiFrozen']),\r\n\t\tcaption() {\r\n\t\t\tif (this.extracting) {\r\n\t\t\t\treturn this.$t('generic.extracting');\r\n\t\t\t}\r\n\t\t\tif (this.uploading) {\r\n\t\t\t\treturn this.$t('generic.uploading');\r\n\t\t\t}\r\n\t\t\treturn this.$t(`button.upload['${this.target}'].caption`);\r\n\t\t},\r\n\t\tcanUpload() {\r\n\t\t\treturn this.isConnected && !this.uiFrozen;\r\n\t\t},\r\n\t\taccept() {\r\n\t\t\tswitch (this.target) {\r\n\t\t\t\tcase 'gcodes': return '.g,.gcode,.gc,.gco,.nc,.ngc,.tap';\r\n\t\t\t\tcase 'start': return '.g,.gcode,.gc,.gco,.nc,.ngc,.tap';\r\n\t\t\t\tcase 'macros': return '*';\r\n\t\t\t\tcase 'filaments': return '.zip';\r\n\t\t\t\tcase 'firmware': return '.zip,.bin';\r\n\t\t\t\tcase 'menu': return '*';\r\n\t\t\t\tcase 'system': return '.zip,.bin,.json,.g,.csv';\r\n\t\t\t\tcase 'web': return '.zip,.csv,.json,.htm,.html,.ico,.xml,.css,.map,.js,.ttf,.eot,.svg,.woff,.woff2,.jpeg,.jpg,.png,.gz';\r\n\t\t\t}\r\n\t\t\treturn undefined;\r\n\t\t},\r\n\t\tdestinationDirectory() {\r\n\t\t\tif (this.directory) {\r\n\t\t\t\treturn this.directory;\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.target) {\r\n\t\t\t\tcase 'gcodes': return this.directories.gCodes;\r\n\t\t\t\tcase 'start': return this.directories.gCodes;\r\n\t\t\t\tcase 'firmware': return this.directories.firmware;\r\n\t\t\t\tcase 'macros': return this.directories.macros;\r\n\t\t\t\tcase 'filaments': return this.directories.filaments;\r\n\t\t\t\tcase 'menu': return this.directories.menu;\r\n\t\t\t\tcase 'system': return this.directories.system;\r\n\t\t\t\tcase 'web': return this.directories.web;\r\n\t\t\t}\r\n\t\t\treturn undefined;\r\n\t\t},\r\n\t\tisBusy() {\r\n\t\t\treturn this.extracting || this.uploading;\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tinnerColor: this.color,\r\n\t\t\textracting: false,\r\n\t\t\tuploading: false,\r\n\r\n\t\t\tconfirmUpdate: false,\r\n\t\t\tupdates: {\r\n\t\t\t\twebInterface: false,\r\n\t\t\t\tfirmwareBoards: [],\r\n\t\t\t\twifiServer: false,\r\n\t\t\t\twifiServerSpiffs: false,\r\n\r\n\t\t\t\tcodeSent: false\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\textends: VBtn,\r\n\tprops: {\r\n\t\tdirectory: String,\r\n\t\ttarget: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tuploadPrint: Boolean\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['sendCode', 'upload']),\r\n\t\tchooseFile() {\r\n\t\t\tif (!this.isBusy) {\r\n\t\t\t\tthis.$refs.fileInput.click();\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync fileSelected(e) {\r\n\t\t\tawait this.doUpload(e.target.files);\r\n\t\t\te.target.value = '';\r\n\t\t},\r\n\t\tisWebFile(filename) {\r\n\t\t\tif (webExtensions.some(extension => filename.toLowerCase().endsWith(extension))) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tconst matches = /(\\.[^.]+).gz$/i.exec(filename);\r\n\t\t\tif (matches && webExtensions.indexOf(matches[1].toLowerCase()) !== -1) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t},\r\n\t\tgetFirmwareName(fileName) {\r\n\t\t\tlet result = null;\r\n\t\t\tthis.boards.forEach((board, index) => {\r\n\t\t\t\tif (board && board.firmwareFileName && (board.canAddress || index === 0)) {\r\n\t\t\t\t\tconst regEx = new RegExp(board.firmwareFileName.replace(/\\.bin$/, '(.*)\\\\.bin'), 'i');\r\n\t\t\t\t\tif (regEx.test(fileName)) {\r\n\t\t\t\t\t\tresult = board.firmwareFileName;\r\n\t\t\t\t\t\tthis.updates.firmwareBoards.push(board.canAddress || 0);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tgetBinaryName(key, fileName) {\r\n\t\t\tlet result = null;\r\n\t\t\tthis.boards.forEach(board => {\r\n\t\t\t\tif (board && board[key]) {\r\n\t\t\t\t\tconst regEx = new RegExp(board[key].replace(/\\.bin$/, '(.*)\\\\.bin'), 'i');\r\n\t\t\t\t\tif (regEx.test(fileName)) {\r\n\t\t\t\t\t\tresult = board[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\tasync doUpload(files, zipName, startTime) {\r\n\t\t\tif (!files.length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.target === 'start' && files.length !== 1) {\r\n\t\t\t\tthis.$makeNotification('error', this.$t(`button.upload['${this.target}'].caption`), this.$t('error.uploadStartWrongFileCount'));\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (!zipName) {\r\n\t\t\t\tif (files.length > 1 && files[0].name.toLowerCase().endsWith('.zip')) {\r\n\t\t\t\t\tthis.$makeNotification('error', this.$t(`button.upload['${this.target}'].caption`), this.$t('error.uploadNoSingleZIP'));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (files[0].name.toLowerCase().endsWith('.zip')) {\r\n\t\t\t\t\tconst zip = new JSZip(), zipFiles = [], target = this.target;\r\n\t\t\t\t\tthis.extracting = true;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// Open the ZIP file and read its content\r\n\t\t\t\t\t\tawait zip.loadAsync(files[0], { checkCRC32: true });\r\n\t\t\t\t\t\tzip.forEach(function(file) {\r\n\t\t\t\t\t\t\tif (!file.endsWith('/') && (file.split('/').length === 2 || target !== 'filaments')) {\r\n\t\t\t\t\t\t\t\tzipFiles.push(file);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t// Could we get anything useful?\r\n\t\t\t\t\t\tif (!zipFiles.length) {\r\n\t\t\t\t\t\t\tthis.extracting = false;\r\n\t\t\t\t\t\t\tthis.$makeNotification('error', this.$t(`button.upload['${this.target}'].caption`), this.$t('error.uploadNoFiles'));\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Extract everything and start the upload\r\n\t\t\t\t\t\tfor (let i = 0; i < zipFiles.length; i++) {\r\n\t\t\t\t\t\t\tconst name = zipFiles[i];\r\n\t\t\t\t\t\t\tzipFiles[i] = await zip.file(name).async('blob');\r\n\t\t\t\t\t\t\tzipFiles[i].name = name;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.doUpload(zipFiles, files[0].name, new Date());\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t\tthis.$makeNotification('error', this.$t('error.uploadDecompressionFailed'), e.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.extracting = false;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.updates.webInterface = false;\r\n\t\t\tthis.updates.firmwareBoards = [];\r\n\t\t\tthis.updates.wifiServer = false;\r\n\t\t\tthis.updates.wifiServerSpiffs = false;\r\n\r\n\t\t\tlet success = true;\r\n\t\t\tthis.uploading = true;\r\n\t\t\tfor (let i = 0; i < files.length; i++) {\r\n\t\t\t\tconst content = files[i];\r\n\r\n\t\t\t\t// Adjust filename if an update is being uploaded\r\n\t\t\t\tlet filename = Path.combine(this.destinationDirectory, content.name);\r\n\t\t\t\tif (this.target === 'system' || this.target === 'firmware') {\r\n\t\t\t\t\tif (Path.isSdPath('/' + content.name)) {\r\n\t\t\t\t\t\tfilename = Path.combine('0:/', content.name);\r\n\t\t\t\t\t} else if (this.isWebFile(content.name)) {\r\n\t\t\t\t\t\tfilename = Path.combine(this.directories.web, content.name);\r\n\t\t\t\t\t\tthis.updates.webInterface |= /index.html(\\.gz)?/i.test(content.name);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst firmwareFileName = this.getFirmwareName(content.name);\r\n\t\t\t\t\t\tconst bootloaderFileName = this.getBinaryName('bootloaderFileName', content.name);\r\n\t\t\t\t\t\tconst iapFileNameSBC = this.getBinaryName('iapFileNameSBC', content.name);\r\n\t\t\t\t\t\tconst iapFileNameSD = this.getBinaryName('iapFileNameSD', content.name);\r\n\t\t\t\t\t\tif (firmwareFileName) {\r\n\t\t\t\t\t\t\tfilename = Path.combine(this.directories.firmware, firmwareFileName);\r\n\t\t\t\t\t\t} else if (bootloaderFileName) {\r\n\t\t\t\t\t\t\tfilename = Path.combine(this.directories.firmware, bootloaderFileName);\r\n\t\t\t\t\t\t} else if (this.state.dsfVersion && iapFileNameSBC) {\r\n\t\t\t\t\t\t\tfilename = Path.combine(this.directories.firmware, iapFileNameSBC);\r\n\t\t\t\t\t\t} else if (iapFileNameSD) {\r\n\t\t\t\t\t\t\tfilename = Path.combine(this.directories.firmware, iapFileNameSD);\r\n\t\t\t\t\t\t} else if (!this.state.dsfVersion && this.network.interfaces.some(iface => iface.type === NetworkInterfaceType.wifi)) {\r\n\t\t\t\t\t\t\tif ((/DuetWiFiSocketServer(.*)\\.bin/i.test(content.name) || /DuetWiFiServer(.*)\\.bin/i.test(content.name))) {\r\n\t\t\t\t\t\t\t\tfilename = Path.combine(this.directories.firmware, 'DuetWiFiServer.bin');\r\n\t\t\t\t\t\t\t\tthis.updates.wifiServer = true;\r\n\t\t\t\t\t\t\t} else if (/DuetWebControl(.*)\\.bin/i.test(content.name)) {\r\n\t\t\t\t\t\t\t\tfilename = Path.combine(this.directories.firmware, 'DuetWebControl.bin');\r\n\t\t\t\t\t\t\t\tthis.updates.wifiServerSpiffs = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (content.name.endsWith('.bin')) {\r\n\t\t\t\t\t\t\t// FIXME This will be no longer needed when CAN board enumeration is supported\r\n\t\t\t\t\t\t\tfilename = Path.combine(this.directories.firmware, content.name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// Start uploading\r\n\t\t\t\t\tif (files.length > 1) {\r\n\t\t\t\t\t\tawait this.upload({ filename, content, showSuccess: !zipName, num: i + 1, count: files.length });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tawait this.upload({ filename, content });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Run it (if required)\r\n\t\t\t\t\tif (this.target === 'start') {\r\n\t\t\t\t\t\tawait this.sendCode(`M32 \"${filename}\"`);\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tsuccess = false;\r\n\t\t\t\t\tthis.$emit('uploadFailed', { filename, reason: e });\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.uploading = false;\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\tthis.$emit('uploadComplete', files);\r\n\r\n\t\t\t\tif ((this.updates.firmwareBoards.length > 0) || this.updates.wifiServer || this.updates.wifiServerSpiffs) {\r\n\t\t\t\t\t// Ask user to perform an update\r\n\t\t\t\t\tthis.confirmUpdate = true;\r\n\t\t\t\t} else if (!this.isLocal && this.updates.webInterface) {\r\n\t\t\t\t\t// Reload the web interface immediately if it was the only update\r\n\t\t\t\t\tlocation.reload(true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// FIXME For some reason the $t function throws an exception when this button is floating\r\n\t\t\t\tif (zipName) {\r\n\t\t\t\t\tconst secondsPassed = Math.round((new Date() - startTime) / 1000);\r\n\t\t\t\t\tthis.$makeNotification('success', this.$t('notification.upload.success', [zipName, this.$displayTime(secondsPassed)]));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync startUpdate() {\r\n\t\t\t// Update expansion boards\r\n\t\t\tfor (let i = 0; i < this.updates.firmwareBoards.length; i++) {\r\n\t\t\t\tconst boardToUpdate = this.updates.firmwareBoards[i];\r\n\t\t\t\tif (boardToUpdate > 0) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tawait this.sendCode(`M997 B${boardToUpdate}`);\r\n\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\t// Wait in 2-second intervals until the status is no longer 'Updating'\r\n\t\t\t\t\t\t\tawait new Promise(resolve => setTimeout(resolve, 2000));\r\n\r\n\t\t\t\t\t\t\t// Stop if the connection has been interrupted\r\n\t\t\t\t\t\t\tif (!this.isConnected) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} while (this.state.status === StatusType.updating);\r\n\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tif (!(e instanceof DisconnectedError)) {\r\n\t\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t\t\tthis.$log('error', this.$t('generic.error'), e.message);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Update other modules\r\n\t\t\tlet modules = [];\r\n\t\t\tif (this.updates.firmwareBoards.indexOf(0) >= 0) {\r\n\t\t\t\tmodules.push('0');\r\n\t\t\t}\r\n\t\t\tif (this.updates.wifiServer) {\r\n\t\t\t\tmodules.push('1');\r\n\t\t\t}\r\n\t\t\tif (this.updates.wifiServerSpiffs) {\r\n\t\t\t\tmodules.push('2');\r\n\t\t\t}\r\n\r\n\t\t\tthis.updates.codeSent = true;\r\n\t\t\ttry {\r\n\t\t\t\tawait this.sendCode(`M997 S${modules.join(':')}`);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!(e instanceof DisconnectedError)) {\r\n\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\tthis.$log('error', this.$t('generic.error'), e.message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdragOver(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\tif (!this.isBusy) {\r\n\t\t\t\tthis.innerColor = 'success';\r\n\t\t\t}\r\n\t\t},\r\n\t\tdragLeave(e) {\r\n\t\t\te.preventDefault();\r\n\t\t\te.stopPropagation();\r\n\t\t\tthis.innerColor = this.color;\r\n\t\t},\r\n\t\tasync dragDrop(e) {\r\n\t\t\tthis.innerColor = this.color;\r\n\t\t\tif (!this.isBusy && e.dataTransfer.files.length) {\r\n\t\t\t\tawait this.doUpload(e.dataTransfer.files);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tisConnected(to) {\r\n\t\t\tif (to && !this.isLocal && this.updates.codeSent && this.updates.webInterface) {\r\n\t\t\t\t// Reload the web interface when the connection could be established again\r\n\t\t\t\tlocation.reload(true);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"],"sourceRoot":"src/components/buttons"}]}