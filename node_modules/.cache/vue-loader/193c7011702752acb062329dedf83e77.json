{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\lists\\BaseFileList.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\lists\\BaseFileList.vue","mtime":1592248188537},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQondXNlIHN0cmljdCcNCg0KaW1wb3J0IEpTWmlwIGZyb20gJ2pzemlwJw0KaW1wb3J0IHNhdmVBcyBmcm9tICdmaWxlLXNhdmVyJw0KaW1wb3J0IHsgVkRhdGFUYWJsZSB9IGZyb20gJ3Z1ZXRpZnkvbGliJw0KDQppbXBvcnQgVnVlIGZyb20gJ3Z1ZScNCmltcG9ydCB7IG1hcFN0YXRlLCBtYXBHZXR0ZXJzLCBtYXBBY3Rpb25zLCBtYXBNdXRhdGlvbnMgfSBmcm9tICd2dWV4Jw0KDQppbXBvcnQgaTE4biBmcm9tICcuLi8uLi9pMThuJw0KaW1wb3J0IHsgZGVmYXVsdE1hY2hpbmUsIGdldE1vZGlmaWVkRGlyZWN0b3JpZXMgfSBmcm9tICcuLi8uLi9zdG9yZS9tYWNoaW5lJw0KaW1wb3J0IHsgRGlzY29ubmVjdGVkRXJyb3IsIE9wZXJhdGlvbkNhbmNlbGxlZEVycm9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvZXJyb3JzLmpzJw0KaW1wb3J0IFBhdGggZnJvbSAnLi4vLi4vdXRpbHMvcGF0aC5qcycNCg0KY29uc3QgbWF4RWRpdEZpbGVTaXplID0gMTU3Mjg2NDA7CQkvLyAxNSBNaUINCg0KZXhwb3J0IGRlZmF1bHQgew0KCXByb3BzOiB7DQoJCWhlYWRlcnM6IEFycmF5LA0KCQlzb3J0VGFibGU6IFN0cmluZywNCgkJZGlyZWN0b3J5OiB7DQoJCQl0eXBlOiBTdHJpbmcsDQoJCQlyZXF1aXJlZDogdHJ1ZQ0KCQl9LA0KCQlmaWxlbGlzdDogQXJyYXksDQoJCXZhbHVlOiBBcnJheSwNCgkJZmlsZUljb246IHsNCgkJCXR5cGU6IFN0cmluZywNCgkJCWRlZmF1bHQ6ICdtZGktZmlsZScNCgkJfSwNCgkJZm9sZGVySWNvbjogew0KCQkJdHlwZTogU3RyaW5nLA0KCQkJZGVmYXVsdDogJ21kaS1mb2xkZXInDQoJCX0sDQoJCWxvYWRpbmc6IEJvb2xlYW4sDQoJCWRvaW5nRmlsZU9wZXJhdGlvbjogQm9vbGVhbiwNCgkJbm9EcmFnRHJvcDogQm9vbGVhbiwNCgkJbm9Eb3dubG9hZDogQm9vbGVhbiwNCgkJbm9FZGl0OiBCb29sZWFuLA0KCQlub0ZpbGVzVGV4dDoNCgkJew0KCQkJdHlwZTogU3RyaW5nLA0KCQkJZGVmYXVsdDogJycNCgkJfSwNCgkJbm9SZW5hbWU6IEJvb2xlYW4sDQoJCW5vRGVsZXRlOiBCb29sZWFuDQoJfSwNCgljb21wdXRlZDogew0KCQkuLi5tYXBTdGF0ZShbJ3NlbGVjdGVkTWFjaGluZSddKSwNCgkJLi4ubWFwR2V0dGVycyhbJ2lzQ29ubmVjdGVkJ10pLA0KCQkuLi5tYXBTdGF0ZSgnbWFjaGluZScsIFsnaXNSZWNvbm5lY3RpbmcnXSksDQoJCS4uLm1hcFN0YXRlKCdtYWNoaW5lL2NhY2hlJywgWydzb3J0aW5nJ10pLA0KCQkuLi5tYXBTdGF0ZSgnbWFjaGluZS9tb2RlbCcsIFsndm9sdW1lcyddKSwNCgkJZGVmYXVsdEhlYWRlcnMoKSB7DQoJCQlyZXR1cm4gWw0KCQkJCXsNCgkJCQkJdGV4dDogaTE4bi50KCdsaXN0LmJhc2VGaWxlTGlzdC5maWxlTmFtZScpLA0KCQkJCQl2YWx1ZTogJ25hbWUnDQoJCQkJfSwNCgkJCQl7DQoJCQkJCXRleHQ6IGkxOG4udCgnbGlzdC5iYXNlRmlsZUxpc3Quc2l6ZScpLA0KCQkJCQl2YWx1ZTogJ3NpemUnLA0KCQkJCQl1bml0OiAnYnl0ZXMnDQoJCQkJfSwNCgkJCQl7DQoJCQkJCXRleHQ6IGkxOG4udCgnbGlzdC5iYXNlRmlsZUxpc3QubGFzdE1vZGlmaWVkJyksDQoJCQkJCXZhbHVlOiAnbGFzdE1vZGlmaWVkJywNCgkJCQkJdW5pdDogJ2RhdGUnDQoJCQkJfQ0KCQkJXTsNCgkJfSwNCgkJaXNMb2FkaW5nKCkgew0KCQkJcmV0dXJuIHRoaXMubG9hZGluZyB8fCB0aGlzLmlubmVyTG9hZGluZyB8fCB0aGlzLmRvaW5nRmlsZU9wZXJhdGlvbiB8fCB0aGlzLmlubmVyRG9pbmdGaWxlT3BlcmF0aW9uOw0KCQl9LA0KCQlmb2xkZXJzU2VsZWN0ZWQoKSB7DQoJCQlyZXR1cm4gdGhpcy5pbm5lclZhbHVlLnNvbWUoaXRlbSA9PiBpdGVtLmlzRGlyZWN0b3J5KQ0KCQl9LA0KCQlmaWxlc1NlbGVjdGVkKCkgew0KCQkJcmV0dXJuIHRoaXMuaW5uZXJWYWx1ZS5zb21lKGl0ZW0gPT4gIWl0ZW0uaXNEaXJlY3RvcnkpDQoJCX0sDQoJCWNhbkVkaXRGaWxlKCkgew0KCQkJcmV0dXJuICh0aGlzLmlubmVyVmFsdWUubGVuZ3RoID4gMCkgJiYgKHRoaXMuaW5uZXJWYWx1ZVswXS5zaXplIDwgbWF4RWRpdEZpbGVTaXplKTsNCgkJfSwNCgkJbm9JdGVtc1RleHQoKSB7DQoJCQlpZiAodGhpcy5zZWxlY3RlZE1hY2hpbmUgPT09IGRlZmF1bHRNYWNoaW5lKSB7DQoJCQkJcmV0dXJuIHRoaXMubm9GaWxlc1RleHQ7DQoJCQl9DQoJCQljb25zdCB2b2x1bWUgPSBQYXRoLmdldFZvbHVtZSh0aGlzLmlubmVyRGlyZWN0b3J5KTsNCgkJCXJldHVybiAodm9sdW1lID49IDAgJiYgdm9sdW1lIDwgdGhpcy52b2x1bWVzLmxlbmd0aCAmJiB0aGlzLnZvbHVtZXNbdm9sdW1lXS5tb3VudGVkKSA/IHRoaXMubm9GaWxlc1RleHQgOiAnbGlzdC5iYXNlRmlsZUxpc3QuZHJpdmVVbm1vdW50ZWQnOw0KCQl9LA0KCQlpbnRlcm5hbFNvcnRCeTogew0KCQkJZ2V0KCkgeyByZXR1cm4gdGhpcy5zb3J0aW5nW3RoaXMuc29ydFRhYmxlXS5jb2x1bW47IH0sDQoJCQlzZXQodmFsdWUpIHsNCgkJCQl0aGlzLnNldFNvcnRpbmcoeyB0YWJsZTogdGhpcy5zb3J0VGFibGUsIGNvbHVtbjogdmFsdWUsIGRlc2NlbmRpbmc6IHRoaXMuaW50ZXJuYWxTb3J0RGVzYyB9KTsNCgkJCX0NCgkJfSwNCgkJaW50ZXJuYWxTb3J0RGVzYzogew0KCQkJZ2V0KCkgeyByZXR1cm4gdGhpcy5zb3J0aW5nW3RoaXMuc29ydFRhYmxlXS5kZXNjZW5kaW5nOyB9LA0KCQkJc2V0KHZhbHVlKSB7DQoJCQkJdGhpcy5zZXRTb3J0aW5nKHsgdGFibGU6IHRoaXMuc29ydFRhYmxlLCBjb2x1bW46IHRoaXMuaW50ZXJuYWxTb3J0QnksIGRlc2NlbmRpbmc6IHZhbHVlIH0pOw0KCQkJfQ0KCQl9DQoJfSwNCglkYXRhKCkgew0KCQlyZXR1cm4gew0KCQkJdW5zdWJzY3JpYmU6IHVuZGVmaW5lZCwNCgkJCXdhc01vdW50ZWQ6IGZhbHNlLA0KCQkJaW5pdGlhbERpcmVjdG9yeTogdGhpcy5kaXJlY3RvcnksDQoJCQlpbm5lckRpcmVjdG9yeTogdGhpcy5kaXJlY3RvcnksDQoJCQlpbm5lckZpbGVsaXN0OiBbXSwNCgkJCWlubmVyTG9hZGluZzogZmFsc2UsDQoJCQlpbm5lckRvaW5nRmlsZU9wZXJhdGlvbjogZmFsc2UsDQoJCQlpbm5lclZhbHVlOiBbXSwNCgkJCXByZXZTZWxlY3Rpb246IFtdLA0KCQkJY29udGV4dE1lbnU6IHsNCgkJCQlzaG93bjogZmFsc2UsDQoJCQkJdG91Y2hUaW1lcjogdW5kZWZpbmVkLA0KCQkJCXg6IDAsDQoJCQkJeTogMA0KCQkJfSwNCgkJCWVkaXREaWFsb2c6IHsNCgkJCQlzaG93bjogZmFsc2UsDQoJCQkJZmlsZW5hbWU6ICcnLA0KCQkJCWNvbnRlbnQ6ICcnDQoJCQl9LA0KCQkJcmVuYW1lRGlhbG9nOiB7DQoJCQkJc2hvd246IGZhbHNlLA0KCQkJCWRpcmVjdG9yeTogJycsDQoJCQkJaXRlbTogbnVsbA0KCQkJfQ0KCQl9DQoJfSwNCglleHRlbmRzOiBWRGF0YVRhYmxlLA0KCW1ldGhvZHM6IHsNCgkJLi4ubWFwQWN0aW9ucygnbWFjaGluZScsIHsNCgkJCW1hY2hpbmVEb3dubG9hZDogJ2Rvd25sb2FkJywNCgkJCW1hY2hpbmVNb3ZlOiAnbW92ZScsDQoJCQltYWNoaW5lRGVsZXRlOiAnZGVsZXRlJywNCgkJCWdldEZpbGVMaXN0OiAnZ2V0RmlsZUxpc3QnDQoJCX0pLA0KCQkuLi5tYXBNdXRhdGlvbnMoJ21hY2hpbmUvY2FjaGUnLCBbJ3NldFNvcnRpbmcnXSksDQoJCXRvZ2dsZUFsbCgpIHsNCgkJCXRoaXMuaW5uZXJWYWx1ZSA9IHRoaXMuaW5uZXJWYWx1ZS5sZW5ndGggPyBbXSA6IHRoaXMuaW5uZXJGaWxlbGlzdC5zbGljZSgpOw0KCQl9LA0KCQlzb3J0KGl0ZW1zLCBzb3J0QnksIHNvcnREZXNjKSB7DQoJCQlzb3J0QnkgPSBzb3J0QnkubGVuZ3RoID8gc29ydEJ5WzBdIDogJ25hbWUnOw0KCQkJc29ydERlc2MgPSBzb3J0RGVzY1swXTsNCg0KCQkJLy8gU29ydCBieSBpbmRleA0KCQkJaXRlbXMuc29ydChmdW5jdGlvbihhLCBiKSB7DQoJCQkJaWYgKGFbc29ydEJ5XSA9PT0gYltzb3J0QnldKSB7DQoJCQkJCXJldHVybiAwOw0KCQkJCX0NCgkJCQlpZiAoYVtzb3J0QnldID09PSBudWxsIHx8IGFbc29ydEJ5XSA9PT0gdW5kZWZpbmVkKSB7DQoJCQkJCXJldHVybiAtMTsNCgkJCQl9DQoJCQkJaWYgKGJbc29ydEJ5XSA9PT0gbnVsbCB8fCBiW3NvcnRCeV0gPT09IHVuZGVmaW5lZCkgew0KCQkJCQlyZXR1cm4gMTsNCgkJCQl9DQoJCQkJaWYgKGFbc29ydEJ5XS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nICYmIGJbc29ydEJ5XS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7DQoJCQkJCXJldHVybiBhW3NvcnRCeV0ubG9jYWxlQ29tcGFyZShiW3NvcnRCeV0sIHVuZGVmaW5lZCwgeyBzZW5zaXZpdHk6ICdiYXNlJyB9KTsNCgkJCQl9DQoJCQkJaWYgKGFbc29ydEJ5XSBpbnN0YW5jZW9mIEFycmF5ICYmIGJbc29ydEJ5XSBpbnN0YW5jZW9mIEFycmF5KSB7DQoJCQkJCWNvbnN0IHJlZHVjZWRBID0gYVtzb3J0QnldLmxlbmd0aCA/IGEuZmlsYW1lbnQucmVkdWNlKChhLCBiKSA9PiBhICsgYikgOiAwOw0KCQkJCQljb25zdCByZWR1Y2VkQiA9IGJbc29ydEJ5XS5sZW5ndGggPyBiLmZpbGFtZW50LnJlZHVjZSgoYSwgYikgPT4gYSArIGIpIDogMDsNCgkJCQkJcmV0dXJuIHJlZHVjZWRBIC0gcmVkdWNlZEI7DQoJCQkJfQ0KCQkJCXJldHVybiBhW3NvcnRCeV0gLSBiW3NvcnRCeV07DQoJCQl9KTsNCg0KCQkJLy8gRGVhbCB3aXRoIGRlc2NlbmRpbmcgb3JkZXINCgkJCWlmIChzb3J0RGVzYykgew0KCQkJCWl0ZW1zLnJldmVyc2UoKTsNCgkJCX0NCg0KCQkJLy8gVGhlbiBtYWtlIHN1cmUgZGlyZWN0b3JpZXMgY29tZSBmaXJzdA0KCQkJaXRlbXMuc29ydCgoYSwgYikgPT4gKGEuaXNEaXJlY3RvcnkgPT09IGIuaXNEaXJlY3RvcnkpID8gMCA6IChhLmlzRGlyZWN0b3J5ID8gLTEgOiAxKSk7DQoJCQlyZXR1cm4gaXRlbXM7DQoJCX0sDQoJCWFzeW5jIHJlZnJlc2goKSB7DQoJCQlhd2FpdCB0aGlzLmxvYWREaXJlY3RvcnkodGhpcy5pbm5lckRpcmVjdG9yeSk7DQoJCX0sDQoJCWFzeW5jIGxvYWREaXJlY3RvcnkoZGlyZWN0b3J5KSB7DQoJCQlpZiAoIXRoaXMuaXNDb25uZWN0ZWQpIHsNCgkJCQlyZXR1cm47DQoJCQl9DQoNCgkJCS8vIFVwZGF0ZSBvdXIgcGF0aCBldmVuIGlmIHdlJ3JlIHN0aWxsIGJ1c3kgbG9hZGluZw0KCQkJdGhpcy5pbm5lckRpcmVjdG9yeSA9IGRpcmVjdG9yeTsNCgkJCWlmICh0aGlzLmlubmVyTG9hZGluZykgew0KCQkJCXJldHVybjsNCgkJCX0NCg0KCQkJLy8gTWFrZSBzdXJlIHRoZSBjdXJyZW50IHZvbHVtZSBpcyBhY3R1YWxseSBhdmFpbGFibGUNCgkJCWNvbnN0IHZvbHVtZSA9IFBhdGguZ2V0Vm9sdW1lKHRoaXMuaW5uZXJEaXJlY3RvcnkpOw0KCQkJaWYgKHZvbHVtZSA8IDAgfHwgdm9sdW1lID49IHRoaXMudm9sdW1lcy5sZW5ndGggfHwgIXRoaXMudm9sdW1lc1t2b2x1bWVdLm1vdW50ZWQpIHsNCgkJCQl0aGlzLmlubmVyRGlyZWN0b3J5ID0gKHZvbHVtZSA9PT0gMCkgPyB0aGlzLmluaXRpYWxEaXJlY3RvcnkgOiBgJHt2b2x1bWV9OmA7DQoJCQkJdGhpcy5pbm5lckZpbGVsaXN0ID0gW107DQoJCQkJcmV0dXJuOw0KCQkJfQ0KDQoJCQkvLyBMb2FkIGZpbGUgbGlzdA0KCQkJdGhpcy5pbm5lckxvYWRpbmcgPSB0cnVlOw0KCQkJdHJ5IHsNCgkJCQljb25zdCBmaWxlcyA9IGF3YWl0IHRoaXMuZ2V0RmlsZUxpc3QoZGlyZWN0b3J5KTsNCg0KCQkJCS8vIENyZWF0ZSBtaXNzaW5nIHByb3BzIGlmIHJlcXVpcmVkDQoJCQkJaWYgKHRoaXMuaGVhZGVycykgew0KCQkJCQlmaWxlcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsNCgkJCQkJCXRoaXMuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uKGhlYWRlcikgew0KCQkJCQkJCWlmIChpdGVtW2hlYWRlci52YWx1ZV0gPT09IHVuZGVmaW5lZCkgew0KCQkJCQkJCQlWdWUuc2V0KGl0ZW0sIGhlYWRlci52YWx1ZSwgdW5kZWZpbmVkKTsNCgkJCQkJCQl9DQoJCQkJCQl9KTsNCgkJCQkJfSwgdGhpcyk7DQoJCQkJfQ0KDQoJCQkJLy8gQ2hlY2sgaWYgYW5vdGhlciBkaXJlY3Rvcnkgd2FzIHJlcXVlc3RlZCB3aGlsZSBmaWxlcyB3ZXJlIGJlaW5nIGxvYWRlZA0KCQkJCWlmIChkaXJlY3RvcnkgIT09IHRoaXMuaW5uZXJEaXJlY3RvcnkpIHsNCgkJCQkJdGhpcy5pbm5lckxvYWRpbmcgPSBmYWxzZTsNCgkJCQkJdGhpcy5sb2FkRGlyZWN0b3J5KHRoaXMuaW5uZXJEaXJlY3RvcnkpOw0KCQkJCQlyZXR1cm47DQoJCQkJfQ0KDQoJCQkJLy8gQXNzaWduIG5ldyBmaWxlIGxpc3QNCgkJCQl0aGlzLmlubmVyRmlsZWxpc3QgPSBmaWxlczsNCgkJCQl0aGlzLmlubmVyVmFsdWUgPSBbXTsNCgkJCQl0aGlzLiRuZXh0VGljayhmdW5jdGlvbigpIHsNCgkJCQkJdGhpcy4kZW1pdCgnZGlyZWN0b3J5TG9hZGVkJywgZGlyZWN0b3J5KTsNCgkJCQl9KTsNCgkJCX0gY2F0Y2ggKGUpIHsNCgkJCQlpZiAoIShlIGluc3RhbmNlb2YgRGlzY29ubmVjdGVkRXJyb3IpKSB7DQoJCQkJCWNvbnNvbGUud2FybihlKTsNCgkJCQkJdGhpcy4kbWFrZU5vdGlmaWNhdGlvbignZXJyb3InLCB0aGlzLiR0KCdlcnJvci5maWxlbGlzdFJlcXVlc3RGYWlsZWQnKSwgZS5tZXNzYWdlKTsNCgkJCQl9DQoJCQl9DQoJCQl0aGlzLmlubmVyTG9hZGluZyA9IGZhbHNlOw0KCQl9LA0KCQlkaXNwbGF5TG9hZGluZ1ZhbHVlKGl0ZW0sIHByb3AsIHByZWNpc2lvbiwgdW5pdCA9ICcnKSB7DQoJCQlpZiAoaXRlbS5pc0RpcmVjdG9yeSkgew0KCQkJCXJldHVybiAnJzsNCgkJCX0NCgkJCWlmICghaXRlbVtwcm9wXSkgew0KCQkJCXJldHVybiB0aGlzLiR0KChpdGVtW3Byb3BdID09PSB1bmRlZmluZWQpID8gJ2dlbmVyaWMubG9hZGluZycgOiAnZ2VuZXJpYy5ub1ZhbHVlJyk7DQoJCQl9DQoNCgkJCWxldCBkaXNwbGF5VmFsdWU7DQoJCQlpZiAoaXRlbVtwcm9wXSBpbnN0YW5jZW9mIEFycmF5KSB7DQoJCQkJaWYgKCFpdGVtW3Byb3BdLmxlbmd0aCkgew0KCQkJCQlyZXR1cm4gdGhpcy4kdCgnZ2VuZXJpYy5ub1ZhbHVlJyk7DQoJCQkJfQ0KCQkJCWRpc3BsYXlWYWx1ZSA9IGl0ZW1bcHJvcF0ucmVkdWNlKChhLCBiKSA9PiBhICsgYik7DQoJCQl9IGVsc2Ugew0KCQkJCWRpc3BsYXlWYWx1ZSA9IGl0ZW1bcHJvcF07DQoJCQl9DQoNCgkJCWlmIChwcmVjaXNpb24gIT09IHVuZGVmaW5lZCkgew0KCQkJCWRpc3BsYXlWYWx1ZSA9IGRpc3BsYXlWYWx1ZS50b0ZpeGVkKHByZWNpc2lvbik7DQoJCQl9DQoJCQlyZXR1cm4gYCR7ZGlzcGxheVZhbHVlfSAke3VuaXR9YDsNCgkJfSwNCgkJZGlzcGxheVRpbWVWYWx1ZShpdGVtLCBwcm9wKSB7DQoJCQlpZiAoaXRlbS5pc0RpcmVjdG9yeSkgew0KCQkJCXJldHVybiAnJzsNCgkJCX0NCgkJCXJldHVybiAoaXRlbVtwcm9wXSAhPT0gbnVsbCkgPyB0aGlzLiRkaXNwbGF5VGltZShpdGVtW3Byb3BdKSA6IHRoaXMuJHQoJ2dlbmVyaWMubm9WYWx1ZScpOw0KCQl9LA0KCQlvbkl0ZW1Ub3VjaFN0YXJ0KHByb3BzLCBlKSB7DQoJCQljb25zdCB0aGF0ID0gdGhpczsNCgkJCXRoaXMuY29udGV4dE1lbnUudG91Y2hUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQoJCQkJdGhhdC5jb250ZXh0TWVudS50b3VjaFRpbWVyID0gdW5kZWZpbmVkOw0KCQkJCXRoYXQub25JdGVtQ29udGV4dG1lbnUocHJvcHMsIHsgY2xpZW50WDogZS50YXJnZXRUb3VjaGVzWzBdLmNsaWVudFgsIGNsaWVudFk6IGUudGFyZ2V0VG91Y2hlc1swXS5jbGllbnRZIH0pOw0KCQkJfSwgMTAwMCk7DQoJCX0sDQoJCW9uSXRlbVRvdWNoRW5kKCkgew0KCQkJaWYgKHRoaXMuY29udGV4dE1lbnUudG91Y2hUaW1lcikgew0KCQkJCWNsZWFyVGltZW91dCh0aGlzLmNvbnRleHRNZW51LnRvdWNoVGltZXIpOw0KCQkJCXRoaXMuY29udGV4dE1lbnUudG91Y2hUaW1lciA9IHVuZGVmaW5lZDsNCgkJCX0NCgkJfSwNCgkJb25JdGVtQ2xpY2socHJvcHMpIHsNCgkJCWlmIChwcm9wcy5pdGVtLmlzRGlyZWN0b3J5KSB7DQoJCQkJdGhpcy5sb2FkRGlyZWN0b3J5KFBhdGguY29tYmluZSh0aGlzLmlubmVyRGlyZWN0b3J5LCBwcm9wcy5pdGVtLm5hbWUpKTsNCgkJCX0gZWxzZSB7DQoJCQkJdGhpcy4kZW1pdCgnZmlsZUNsaWNrZWQnLCBwcm9wcy5pdGVtKTsNCgkJCX0NCgkJfSwNCgkJb25JdGVtQ29udGV4dG1lbnUocHJvcHMsIGUpIHsNCgkJCWlmICh0aGlzLmNvbnRleHRNZW51LnNob3duKSB7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KCQkJdGhpcy5vbkl0ZW1Ub3VjaEVuZCgpOw0KDQoJCQkvLyBEZWFsIHdpdGggc2VsZWN0aW9uDQoJCQl0aGlzLnByZXZTZWxlY3Rpb24gPSB0aGlzLmlubmVyVmFsdWU7DQoJCQlpZiAoIXByb3BzLmlzU2VsZWN0ZWQpIHsNCgkJCQl0aGlzLmlubmVyVmFsdWUgPSBbXTsNCgkJCQl0aGlzLiRuZXh0VGljaygoKSA9PiBwcm9wcy5zZWxlY3QodHJ1ZSkpOw0KCQkJfQ0KDQoJCQkvLyBPcGVuIHRoZSBjb250ZXh0IG1lbnUNCgkJCXRoaXMuY29udGV4dE1lbnUuc2hvd24gPSBmYWxzZTsNCgkJCXRoaXMuY29udGV4dE1lbnUueCA9IGUuY2xpZW50WDsNCgkJCXRoaXMuY29udGV4dE1lbnUueSA9IGUuY2xpZW50WTsNCgkJCXRoaXMuJG5leHRUaWNrKCgpID0+IHsNCgkJCQl0aGlzLmNvbnRleHRNZW51LnNob3duID0gdHJ1ZTsNCgkJCX0pOw0KCQl9LA0KCQlvbkl0ZW1EcmFnU3RhcnQoaXRlbSwgZSkgew0KCQkJaWYgKHRoaXMubm9EcmFnRHJvcCB8fCB0aGlzLmNvbnRleHRNZW51LnRvdWNoVGltZXIgfHwgdGhpcy5jb250ZXh0TWVudS5zaG93bikgew0KCQkJCXJldHVybjsNCgkJCX0NCg0KCQkJY29uc3QgaXRlbXNUb0RyYWcgPSB0aGlzLmlubmVyVmFsdWU7DQoJCQlpZiAoaXRlbXNUb0RyYWcuaW5kZXhPZihpdGVtKSA9PT0gLTEpIHsNCgkJCQlpdGVtc1RvRHJhZy5wdXNoKGl0ZW0pOw0KCQkJfQ0KCQkJZS5kYXRhVHJhbnNmZXIuc2V0RGF0YSgnYXBwbGljYXRpb24vanNvbicsIEpTT04uc3RyaW5naWZ5KHsNCgkJCQl0eXBlOiAnZHdjRmlsZXMnLA0KCQkJCWRpcmVjdG9yeTogdGhpcy5pbm5lckRpcmVjdG9yeSwNCgkJCQlpdGVtczogaXRlbXNUb0RyYWcNCgkJCX0pKTsNCgkJCWUuZGF0YVRyYW5zZmVyLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSc7DQoNCgkJCWNvbnN0IHRhYmxlID0gdGhpcy4kZWwucXVlcnlTZWxlY3RvcigndGFibGUnKSwgZmlyc3RSb3cgPSB0YWJsZS50Qm9kaWVzWzBdLnJvd3NbMF07DQoJCQljb25zdCB0YWJsZUNsb25lID0gdGFibGUuY2xvbmVOb2RlKHRydWUpLCBpdGVtRmlsZW5hbWUgPSAoaXRlbS5pc0RpcmVjdG9yeSA/ICcqJyA6ICcnKSArIGl0ZW0ubmFtZTsNCgkJCWxldCBvZmZzZXRZID0gMCwgY291bnRpbmdPZmZzZXQgPSB0cnVlOw0KDQoJCQl0YWJsZUNsb25lLnRIZWFkLnJlbW92ZSgpOw0KCQkJQXJyYXkuZnJvbSh0YWJsZUNsb25lLnRCb2RpZXNbMF0ucm93cykuZm9yRWFjaChmdW5jdGlvbihyb3cpIHsNCgkJCQljb25zdCBmaWxlbmFtZSA9IHJvdy5kYXRhc2V0LmZpbGVuYW1lOw0KCQkJCWlmIChpdGVtc1RvRHJhZy5zb21lKGl0ZW0gPT4gKGl0ZW0uaXNEaXJlY3RvcnkgPyAnKicgOiAnJykgKyBpdGVtLm5hbWUgPT09IGZpbGVuYW1lKSkgew0KCQkJCQlBcnJheS5mcm9tKHJvdy5jaGlsZHJlbikuZm9yRWFjaChmdW5jdGlvbih0ZCwgaW5kZXgpIHsNCgkJCQkJCWlmICh0ZC50YWdOYW1lID09PSAnVEQnKSB7DQoJCQkJCQkJdGQuc3R5bGUud2lkdGggPSBgJHtmaXJzdFJvdy5jaGlsZHJlbltpbmRleF0ub2Zmc2V0V2lkdGh9cHhgOw0KCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQl0ZC5yZW1vdmUoKTsNCgkJCQkJCX0NCgkJCQkJfSk7DQoNCgkJCQkJaWYgKGNvdW50aW5nT2Zmc2V0KSB7DQoJCQkJCQlpZiAoZmlsZW5hbWUgPT09IGl0ZW1GaWxlbmFtZSkgew0KCQkJCQkJCWNvdW50aW5nT2Zmc2V0ID0gZmFsc2U7DQoJCQkJCQl9IGVsc2Ugew0KCQkJCQkJCW9mZnNldFkgKz0gZmlyc3RSb3cub2Zmc2V0SGVpZ2h0Ow0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfSBlbHNlIHsNCgkJCQkJcm93LnJlbW92ZSgpOw0KCQkJCX0NCgkJCX0sIHRoaXMpOw0KCQkJdGFibGVDbG9uZS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB0aGlzLiR2dWV0aWZ5LnRoZW1lLmlzRGFyayA/ICcjNDI0MjQyJyA6ICcjRkZGRkZGJzsNCgkJCXRhYmxlQ2xvbmUuc3R5bGUub3BhY2l0eSA9IDAuNzsNCgkJCXRhYmxlQ2xvbmUuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnOw0KCQkJdGFibGVDbG9uZS5zdHlsZS5wb2ludGVyRXZlbnRzID0gJ25vbmUnOw0KCQkJQXJyYXkuZnJvbSh0YWJsZUNsb25lLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tjbGFzc149InYtcmlwcGxlIl0nKSkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7DQoJCQkJaXRlbS5jbGFzc0xpc3QgPSBBcnJheS5mcm9tKGl0ZW0uY2xhc3NMaXN0KS5maWx0ZXIoYyA9PiAhYy5zdGFydHNXaXRoKCd2LXJpcHBsZScpKTsNCgkJCX0pOw0KCQkJdGFibGUucGFyZW50Tm9kZS5hcHBlbmQodGFibGVDbG9uZSk7DQoNCgkJCWNvbnN0IHggPSBlLmNsaWVudFggLSB0YWJsZS5nZXRDbGllbnRSZWN0cygpWzBdLmxlZnQ7DQoJCQljb25zdCB5ID0gZS5jbGllbnRZIC0gZS50YXJnZXQuY2xvc2VzdCgndHInKS5nZXRDbGllbnRSZWN0cygpWzBdLnRvcCArIG9mZnNldFk7DQoJCQllLmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UodGFibGVDbG9uZSwgeCwgeSk7DQoNCgkJCXNldFRpbWVvdXQoKCkgPT4gdGFibGVDbG9uZS5yZW1vdmUoKSwgMCk7DQoJCX0sDQoJCW9uSXRlbURyYWdPdmVyKGl0ZW0sIGUpIHsNCgkJCWlmICghdGhpcy5ub0RyYWdEcm9wICYmIGl0ZW0uaXNEaXJlY3RvcnkpIHsNCgkJCQljb25zdCBqc29uRGF0YSA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoJ2FwcGxpY2F0aW9uL2pzb24nKTsNCgkJCQlpZiAoanNvbkRhdGEpIHsNCgkJCQkJY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoanNvbkRhdGEpOw0KCQkJCQlpZiAoZGF0YS50eXBlID09PSAnZHdjRmlsZXMnICYmICFkYXRhLml0ZW1zLnNvbWUoZGF0YUl0ZW0gPT4gZGF0YUl0ZW0uaXNEaXJlY3RvcnkgJiYgZGF0YUl0ZW0ubmFtZSA9PT0gaXRlbS5uYW1lKSkgew0KCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCQkJZS5zdG9wUHJvcGFnYXRpb24oKTsNCgkJCQkJfQ0KCQkJCX0gZWxzZSB7DQoJCQkJCS8vIEZpeCBmb3IgQ2hyb21lOiBJdCBkb2VzIG5vdCBncmFudCBhY2Nlc3MgdG8gZGF0YVRyYW5zZmVyIG9uIHRoZSBzYW1lIGRvbWFpbiAiZm9yIHNlY3VyaXR5IHJlYXNvbnMiLi4uDQoJCQkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCQkJZS5zdG9wUHJvcGFnYXRpb24oKTsNCgkJCQl9DQoJCQl9DQoJCX0sDQoJCWFzeW5jIG9uSXRlbURyYWdEcm9wKGl0ZW0sIGUpIHsNCgkJCWNvbnN0IGpzb25EYXRhID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgnYXBwbGljYXRpb24vanNvbicpOw0KCQkJaWYgKGpzb25EYXRhKSB7DQoJCQkJY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoanNvbkRhdGEpOw0KCQkJCWlmIChkYXRhLnR5cGUgPT09ICdkd2NGaWxlcycgJiYgIWRhdGEuaXRlbXMuc29tZShkYXRhSXRlbSA9PiBkYXRhSXRlbS5pc0RpcmVjdG9yeSAmJiBkYXRhSXRlbS5uYW1lID09PSBpdGVtLm5hbWUpKSB7DQoJCQkJCWNvbnN0IGRpcmVjdG9yeSA9IHRoaXMuaW5uZXJEaXJlY3Rvcnk7DQoJCQkJCWZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5pdGVtcy5sZW5ndGg7IGkrKykgew0KCQkJCQkJY29uc3QgZnJvbSA9IFBhdGguY29tYmluZShkYXRhLmRpcmVjdG9yeSwgZGF0YS5pdGVtc1tpXS5uYW1lKTsNCgkJCQkJCWNvbnN0IHRvID0gUGF0aC5jb21iaW5lKGRpcmVjdG9yeSwgaXRlbS5uYW1lLCBkYXRhLml0ZW1zW2ldLm5hbWUpOw0KCQkJCQkJdHJ5IHsNCgkJCQkJCQlhd2FpdCB0aGlzLm1hY2hpbmVNb3ZlKHsgZnJvbSwgdG8gfSk7DQoJCQkJCQl9IGNhdGNoIChlKSB7DQoJCQkJCQkJdGhpcy4kbWFrZU5vdGlmaWNhdGlvbignZXJyb3InLCBgRmFpbGVkIHRvIG1vdmUgJHtkYXRhLml0ZW1zW2ldLm5hbWV9IHRvICR7ZGlyZWN0b3J5fWAsIGUubWVzc2FnZSk7DQoJCQkJCQkJYnJlYWs7DQoJCQkJCQl9DQoJCQkJCX0NCgkJCQl9DQoJCQl9DQoJCX0sDQoJCWFzeW5jIGRvd25sb2FkKGl0ZW0pIHsNCgkJCXRyeSB7DQoJCQkJY29uc3QgZmlsZW5hbWUgPSAoaXRlbSAmJiBpdGVtLm5hbWUpID8gaXRlbS5uYW1lIDogdGhpcy5pbm5lclZhbHVlWzBdLm5hbWU7DQoJCQkJY29uc3QgYmxvYiA9IGF3YWl0IHRoaXMubWFjaGluZURvd25sb2FkKHsgZmlsZW5hbWU6IFBhdGguY29tYmluZSh0aGlzLmlubmVyRGlyZWN0b3J5LCBmaWxlbmFtZSksIHR5cGU6ICdibG9iJyB9KTsNCgkJCQlzYXZlQXMoYmxvYiwgZmlsZW5hbWUpOw0KCQkJfSBjYXRjaCAoZSkgew0KCQkJCWlmICghKGUgaW5zdGFuY2VvZiBEaXNjb25uZWN0ZWRFcnJvcikgJiYgIShlIGluc3RhbmNlb2YgT3BlcmF0aW9uQ2FuY2VsbGVkRXJyb3IpKSB7DQoJCQkJCS8vIHNob3VsZCBiZSBoYW5kbGVkIGJlZm9yZSB3ZSBnZXQgaGVyZQ0KCQkJCQljb25zb2xlLndhcm4oZSk7DQoJCQkJfQ0KCQkJfQ0KCQl9LA0KCQlhc3luYyBlZGl0KGl0ZW0pIHsNCgkJCXRyeSB7DQoJCQkJY29uc3QgZmlsZW5hbWUgPSBQYXRoLmNvbWJpbmUodGhpcy5pbm5lckRpcmVjdG9yeSwgaXRlbS5uYW1lKTsNCgkJCQljb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMubWFjaGluZURvd25sb2FkKHsgZmlsZW5hbWUsIHR5cGU6ICd0ZXh0Jywgc2hvd1N1Y2Nlc3M6IGZhbHNlIH0pOw0KCQkJCXRoaXMuZWRpdERpYWxvZy5maWxlbmFtZSA9IGZpbGVuYW1lOw0KCQkJCXRoaXMuZWRpdERpYWxvZy5jb250ZW50ID0gcmVzcG9uc2U7DQoJCQkJdGhpcy5lZGl0RGlhbG9nLnNob3duID0gdHJ1ZTsNCgkJCX0gY2F0Y2ggKGUpIHsNCgkJCQlpZiAoIShlIGluc3RhbmNlb2YgRGlzY29ubmVjdGVkRXJyb3IpICYmICEoZSBpbnN0YW5jZW9mIE9wZXJhdGlvbkNhbmNlbGxlZEVycm9yKSkgew0KCQkJCQkvLyBzaG91bGQgYmUgaGFuZGxlZCBiZWZvcmUgd2UgZ2V0IGhlcmUNCgkJCQkJY29uc29sZS53YXJuKGUpOw0KCQkJCX0NCgkJCX0NCgkJfSwNCgkJYXN5bmMgcmVuYW1lKGl0ZW0pIHsNCgkJCXRoaXMucmVuYW1lRGlhbG9nLmRpcmVjdG9yeSA9IHRoaXMuaW5uZXJEaXJlY3Rvcnk7DQoJCQl0aGlzLnJlbmFtZURpYWxvZy5pdGVtID0gKGl0ZW0gJiYgaXRlbS5uYW1lKSA/IGl0ZW0gOiB0aGlzLmlubmVyVmFsdWVbMF07DQoJCQl0aGlzLnJlbmFtZURpYWxvZy5zaG93biA9IHRydWU7DQoJCX0sDQoJCWFzeW5jIHJlbmFtZUNhbGxiYWNrKG5ld0ZpbGVuYW1lKSB7DQoJCQljb25zdCBvbGRGaWxlbmFtZSA9IHRoaXMucmVuYW1lRGlhbG9nLml0ZW0ubmFtZTsNCgkJCWlmICh0aGlzLmlubmVyRG9pbmdGaWxlT3BlcmF0aW9uKSB7DQoJCQkJcmV0dXJuOw0KCQkJfQ0KDQoJCQl0aGlzLmlubmVyRG9pbmdGaWxlT3BlcmF0aW9uID0gdHJ1ZTsNCgkJCXRyeSB7DQoJCQkJYXdhaXQgdGhpcy5tYWNoaW5lTW92ZSh7DQoJCQkJCWZyb206IFBhdGguY29tYmluZSh0aGlzLnJlbmFtZURpYWxvZy5kaXJlY3RvcnksIG9sZEZpbGVuYW1lKSwNCgkJCQkJdG86IFBhdGguY29tYmluZSh0aGlzLnJlbmFtZURpYWxvZy5kaXJlY3RvcnksIG5ld0ZpbGVuYW1lKQ0KCQkJCX0pOw0KDQoJCQkJdGhpcy5pbm5lckZpbGVsaXN0LnNvbWUoZnVuY3Rpb24oZmlsZSkgew0KCQkJCQlpZiAoZmlsZS5pc0RpcmVjdG9yeSA9PT0gdGhpcy5pc0RpcmVjdG9yeSAmJiBmaWxlLm5hbWUgPT09IHRoaXMubmFtZSkgew0KCQkJCQkJZmlsZS5uYW1lID0gbmV3RmlsZW5hbWU7DQoJCQkJCQlyZXR1cm4gdHJ1ZTsNCgkJCQkJfQ0KCQkJCQlyZXR1cm4gZmFsc2U7DQoJCQkJfSwgdGhpcy5yZW5hbWVEaWFsb2cuaXRlbSk7DQoNCgkJCQl0aGlzLiRtYWtlTm90aWZpY2F0aW9uKCdzdWNjZXNzJywgdGhpcy4kdCgnbm90aWZpY2F0aW9uLnJlbmFtZS5zdWNjZXNzJywgW29sZEZpbGVuYW1lLCBuZXdGaWxlbmFtZV0pKTsNCgkJCX0gY2F0Y2ggKGUpIHsNCgkJCQljb25zb2xlLndhcm4oZSk7DQoJCQkJdGhpcy4kbG9nKCdlcnJvcicsIHRoaXMuJHQoJ25vdGlmaWNhdGlvbi5yZW5hbWUuZXJyb3InLCBbb2xkRmlsZW5hbWUsIG5ld0ZpbGVuYW1lXSksIGUubWVzc2FnZSk7DQoJCQl9DQoJCQl0aGlzLmlubmVyRG9pbmdGaWxlT3BlcmF0aW9uID0gZmFsc2U7DQoJCX0sDQoJCWFzeW5jIHJlbW92ZShpdGVtcykgew0KCQkJaWYgKCFpdGVtcyB8fCAhKGl0ZW1zIGluc3RhbmNlb2YgQXJyYXkpKSB7DQoJCQkJaXRlbXMgPSB0aGlzLmlubmVyVmFsdWUuc2xpY2UoKTsNCgkJCX0NCg0KCQkJaWYgKHRoaXMuaW5uZXJEb2luZ0ZpbGVPcGVyYXRpb24pIHsNCgkJCQlyZXR1cm47DQoJCQl9DQoNCgkJCXRoaXMuaW5uZXJEb2luZ0ZpbGVPcGVyYXRpb24gPSB0cnVlOw0KCQkJY29uc3QgZGVsZXRlZEl0ZW1zID0gW10sIGRpcmVjdG9yeSA9IHRoaXMuZGlyZWN0b3J5Ow0KCQkJZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykgew0KCQkJCXRyeSB7DQoJCQkJCWNvbnN0IGl0ZW0gPSBpdGVtc1tpXTsNCgkJCQkJYXdhaXQgdGhpcy5tYWNoaW5lRGVsZXRlKFBhdGguY29tYmluZShkaXJlY3RvcnksIGl0ZW0ubmFtZSkpOw0KDQoJCQkJCWRlbGV0ZWRJdGVtcy5wdXNoKGl0ZW1zW2ldKTsNCgkJCQkJdGhpcy5pbm5lckZpbGVsaXN0ID0gdGhpcy5pbm5lckZpbGVsaXN0LmZpbHRlcihmaWxlID0+IGZpbGUuaXNEaXJlY3RvcnkgIT09IGl0ZW0uaXNEaXJlY3RvcnkgfHwgZmlsZS5uYW1lICE9PSBpdGVtLm5hbWUpOw0KCQkJCQl0aGlzLmlubmVyVmFsdWUgPSB0aGlzLmlubmVyVmFsdWUuZmlsdGVyKGZpbGUgPT4gZmlsZS5pc0RpcmVjdG9yeSAhPT0gaXRlbS5pc0RpcmVjdG9yeSB8fCBmaWxlLm5hbWUgIT09IGl0ZW0ubmFtZSk7DQoJCQkJfSBjYXRjaCAoZSkgew0KCQkJCQl0aGlzLiRtYWtlTm90aWZpY2F0aW9uKCdlcnJvcicsIHRoaXMuJHQoJ25vdGlmaWNhdGlvbi5kZWxldGUuZXJyb3JUaXRsZScsIFtpdGVtc1tpXS5uYW1lXSksIGl0ZW1zW2ldLmlzRGlyZWN0b3J5ID8gdGhpcy4kdCgnbm90aWZpY2F0aW9uLmRlbGV0ZS5lcnJvck1lc3NhZ2VEaXJlY3RvcnknKSA6IGUubWVzc2FnZSk7DQoJCQkJfQ0KCQkJfQ0KDQoJCQlpZiAoZGVsZXRlZEl0ZW1zLmxlbmd0aCkgew0KCQkJCXRoaXMuJGxvZygnc3VjY2VzcycsIChkZWxldGVkSXRlbXMubGVuZ3RoID4gMSkgPyB0aGlzLiR0KCdub3RpZmljYXRpb24uZGVsZXRlLnN1Y2Nlc3NNdWx0aXBsZScsIFtkZWxldGVkSXRlbXMubGVuZ3RoXSkgOiB0aGlzLiR0KCdub3RpZmljYXRpb24uZGVsZXRlLnN1Y2Nlc3MnLCBbZGVsZXRlZEl0ZW1zWzBdLm5hbWVdKSk7DQoJCQl9DQoJCQl0aGlzLmlubmVyRG9pbmdGaWxlT3BlcmF0aW9uID0gZmFsc2U7DQoJCX0sDQoJCWFzeW5jIGRvd25sb2FkWklQKGl0ZW1zKSB7DQoJCQlpZiAoIWl0ZW1zIHx8ICEoaXRlbXMgaW5zdGFuY2VvZiBBcnJheSkpIHsgaXRlbXMgPSB0aGlzLmlubmVyVmFsdWUuc2xpY2UoKTsgfQ0KCQkJY29uc3QgZGlyZWN0b3J5ID0gdGhpcy5kaXJlY3Rvcnk7DQoNCgkJCS8vIERvd25sb2FkIGZpbGVzDQoJCQljb25zdCB6aXAgPSBuZXcgSlNaaXAoKTsNCgkJCWZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHsNCgkJCQl0cnkgew0KCQkJCQljb25zdCBibG9iID0gYXdhaXQgdGhpcy5tYWNoaW5lRG93bmxvYWQoeyBmaWxlbmFtZTogUGF0aC5jb21iaW5lKGRpcmVjdG9yeSwgaXRlbXNbaV0ubmFtZSksIHR5cGU6ICdibG9iJywgbnVtOiBpICsgMSwgY291bnQ6IGl0ZW1zLmxlbmd0aCB9KTsNCgkJCQkJemlwLmZpbGUoaXRlbXNbaV0ubmFtZSwgYmxvYik7DQoJCQkJfSBjYXRjaCAoZSkgew0KCQkJCQlpZiAoIShlIGluc3RhbmNlb2YgRGlzY29ubmVjdGVkRXJyb3IpICYmICEoZSBpbnN0YW5jZW9mIE9wZXJhdGlvbkNhbmNlbGxlZEVycm9yKSkgew0KCQkJCQkJLy8gc2hvdWxkIGJlIGhhbmRsZWQgYmVmb3JlIHdlIGdldCBoZXJlDQoJCQkJCQljb25zb2xlLndhcm4oZSk7DQoJCQkJCX0NCgkJCQkJcmV0dXJuOw0KCQkJCX0NCgkJCX0NCg0KCQkJLy8gQ29tcHJlc3MgZmlsZXMgYW5kIHNhdmUgdGhlIG5ldyBhcmNoaXZlDQoJCQljb25zdCBub3RpZmljYXRpb24gPSB0aGlzLiRtYWtlTm90aWZpY2F0aW9uKCdpbmZvJywgdGhpcy4kdCgnbm90aWZpY2F0aW9uLmNvbXByZXNzLnRpdGxlJyksIHRoaXMuJHQoJ25vdGlmaWNhdGlvbi5jb21wcmVzcy5tZXNzYWdlJykpOw0KCQkJdHJ5IHsNCgkJCQljb25zdCB6aXBCbG9iID0gYXdhaXQgemlwLmdlbmVyYXRlQXN5bmMoeyB0eXBlOiAnYmxvYicgfSk7DQoJCQkJc2F2ZUFzKHppcEJsb2IsICdkb3dubG9hZC56aXAnKTsNCgkJCX0gY2F0Y2ggKGUpIHsNCgkJCQljb25zb2xlLndhcm4oZSk7DQoJCQkJdGhpcy4kbWFrZU5vdGlmaWNhdGlvbignZXJyb3InLCB0aGlzLiR0KCdub3RpZmljYXRpb24uY29tcHJlc3MuZXJyb3JUaXRsZScpLCBlLm1lc3NhZ2UpOw0KCQkJfQ0KCQkJbm90aWZpY2F0aW9uLmhpZGUoKTsNCgkJfQ0KCX0sDQoJbW91bnRlZCgpIHsNCgkJLy8gUGVyZm9ybSBpbml0aWFsIGxvYWQNCgkJaWYgKHRoaXMuaXNDb25uZWN0ZWQpIHsNCgkJCWNvbnN0IHZvbHVtZSA9IFBhdGguZ2V0Vm9sdW1lKHRoaXMuaW5uZXJEaXJlY3RvcnkpOw0KCQkJdGhpcy53YXNNb3VudGVkID0gKHZvbHVtZSA+PSAwKSAmJiAodm9sdW1lID49IHRoaXMudm9sdW1lcy5sZW5ndGgpICYmIHRoaXMudm9sdW1lc1t2b2x1bWVdLm1vdW50ZWQ7DQoJCQl0aGlzLnJlZnJlc2goKTsNCgkJfQ0KDQoJCS8vIEtlZXAgdHJhY2sgb2YgZmlsZSBjaGFuZ2VzDQoJCWNvbnN0IHRoYXQgPSB0aGlzOw0KCQl0aGlzLnVuc3Vic2NyaWJlID0gdGhpcy4kc3RvcmUuc3Vic2NyaWJlQWN0aW9uKGFzeW5jIGZ1bmN0aW9uKGFjdGlvbiwgc3RhdGUpIHsNCgkJCWlmICghdGhhdC5kb2luZ0ZpbGVPcGVyYXRpb24gJiYgIXRoYXQuaW5uZXJEb2luZ0ZpbGVPcGVyYXRpb24gJiYNCgkJCQlnZXRNb2RpZmllZERpcmVjdG9yaWVzKGFjdGlvbiwgc3RhdGUpLnNvbWUoZGlyZWN0b3J5ID0+IFBhdGguZXF1YWxzKGRpcmVjdG9yeSwgdGhhdC5pbm5lckRpcmVjdG9yeSkpKSB7DQoJCQkJLy8gUmVmcmVzaCB0aGUgbGlzdCB3aGVuIGEgZmlsZSBvciBkaXJlY3RvcnkgaGFzIGJlZW4gY2hhbmdlZA0KCQkJCWF3YWl0IHRoYXQucmVmcmVzaCgpOw0KCQkJfQ0KCQl9KTsNCgl9LA0KCWJlZm9yZURlc3Ryb3koKSB7DQoJCXRoaXMudW5zdWJzY3JpYmUoKTsNCgl9LA0KCXdhdGNoOiB7DQoJCWlzQ29ubmVjdGVkKHRvKSB7DQoJCQlpZiAodG8pIHsNCgkJCQl0aGlzLnJlZnJlc2goKTsNCgkJCX0gZWxzZSB7DQoJCQkJdGhpcy5pbm5lckRpcmVjdG9yeSA9IHRoaXMuaW5pdGlhbERpcmVjdG9yeTsNCgkJCQl0aGlzLmlubmVyRmlsZWxpc3QgPSBbXTsNCg0KCQkJCXRoaXMuZWRpdERpYWxvZy5zaG93biA9IGZhbHNlOw0KCQkJCXRoaXMucmVuYW1lRGlhbG9nLnNob3duID0gZmFsc2U7DQoJCQl9DQoJCX0sDQoJCXNlbGVjdGVkTWFjaGluZSgpIHsNCgkJCS8vIFRPRE8gc3RvcmUgY3VycmVudCBkaXJlY3RvcnkgcGVyIHNlbGVjdGVkIG1hY2hpbmUNCgkJCXRoaXMuaW5uZXJEaXJlY3RvcnkgPSB0aGlzLmluaXRpYWxEaXJlY3Rvcnk7DQoJCQl0aGlzLmlubmVyRmlsZWxpc3QgPSBbXTsNCg0KCQkJdGhpcy5lZGl0RGlhbG9nLnNob3duID0gZmFsc2U7DQoJCQl0aGlzLnJlbmFtZURpYWxvZy5zaG93biA9IGZhbHNlOw0KCQl9LA0KCQl2b2x1bWVzOiB7DQoJCQlkZWVwOiB0cnVlLA0KCQkJaGFuZGxlcigpIHsNCgkJCQlpZiAodGhpcy5pc0Nvbm5lY3RlZCkgew0KCQkJCQljb25zdCB2b2x1bWUgPSBQYXRoLmdldFZvbHVtZSh0aGlzLmRpcmVjdG9yeSk7DQoJCQkJCWlmICh2b2x1bWUgPj0gMCAmJiB2b2x1bWUgPCB0aGlzLnZvbHVtZXMubGVuZ3RoKSB7DQoJCQkJCQljb25zdCBtb3VudGVkID0gdGhpcy52b2x1bWVzW3ZvbHVtZV0ubW91bnRlZDsNCgkJCQkJCWlmICh0aGlzLndhc01vdW50ZWQgIT09IG1vdW50ZWQpIHsNCgkJCQkJCQl0aGlzLndhc01vdW50ZWQgPSBtb3VudGVkOw0KCQkJCQkJCXRoaXMucmVmcmVzaCgpOw0KCQkJCQkJfQ0KCQkJCQl9IGVsc2Ugew0KCQkJCQkJdGhpcy53YXNNb3VudGVkID0gZmFsc2U7DQoJCQkJCQl0aGlzLnJlZnJlc2goKTsNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJfSwNCgkJZGlyZWN0b3J5KHRvKSB7DQoJCQlpZiAodG8gIT09IHRoaXMuaW5uZXJEaXJlY3RvcnkpIHsNCgkJCQl0aGlzLmxvYWREaXJlY3RvcnkodG8pOw0KCQkJfQ0KCQl9LA0KCQlpbm5lckRpcmVjdG9yeSh0bykgew0KCQkJaWYgKHRoaXMuZGlyZWN0b3J5ICE9PSB0bykgew0KCQkJCXRoaXMuJGVtaXQoJ3VwZGF0ZTpkaXJlY3RvcnknLCB0byk7DQoJCQl9DQoJCX0sDQoJCWlubmVyRmlsZWxpc3QodG8pIHsNCgkJCWlmICh0aGlzLmZpbGVsaXN0ICE9PSB0bykgew0KCQkJCXRoaXMuJGVtaXQoJ3VwZGF0ZTpmaWxlbGlzdCcsIHRvKTsNCgkJCX0NCgkJfSwNCgkJaW5uZXJMb2FkaW5nKHRvKSB7DQoJCQlpZiAodGhpcy5sb2FkaW5nICE9PSB0bykgew0KCQkJCXRoaXMuJGVtaXQoJ3VwZGF0ZTpsb2FkaW5nJywgdG8pOw0KCQkJfQ0KCQl9LA0KCQlpbm5lclZhbHVlKHRvKSB7DQoJCQlpZiAodGhpcy52YWx1ZSAhPT0gdG8pIHsNCgkJCQl0aGlzLiRlbWl0KCdpbnB1dCcsIHRvKTsNCgkJCX0NCgkJfSwNCgkJJ2NvbnRleHRNZW51LnNob3duJyh0bykgew0KCQkJaWYgKCF0bykgew0KCQkJCS8vIFJlc3RvcmUgcHJldmlvdXNseSBzZWxlY3RlZCBpdGVtcw0KCQkJCXRoaXMuaW5uZXJWYWx1ZSA9IHRoaXMucHJldlNlbGVjdGlvbjsNCgkJCX0NCgkJfQ0KCX0NCn0NCg=="},{"version":3,"sources":["BaseFileList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqHA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BaseFileList.vue","sourceRoot":"src/components/lists","sourcesContent":["<style scoped>\r\ntd {\r\n\tcursor: pointer;\r\n}\r\n\r\n.loading-cursor {\r\n\tcursor: wait;\r\n}\r\n.loading-cursor td {\r\n\tcursor: wait;\r\n}\r\n</style>\r\n\r\n<style>\r\n.base-file-list th {\r\n\twhite-space: nowrap;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<div>\r\n\t\t<v-data-table v-model=\"innerValue\" v-bind=\"$props\"\r\n\t\t\t:items=\"innerFilelist\" item-key=\"name\" :headers=\"headers || defaultHeaders\" show-select \r\n\t\t\t:loading=\"loading || innerLoading\"\r\n\t\t\t:custom-sort=\"sort\" :sort-by.sync=\"internalSortBy\" :sort-desc.sync=\"internalSortDesc\" must-sort\r\n\t\t\tdisable-pagination hide-default-footer :mobile-breakpoint=\"0\"\r\n\t\t\tclass=\"base-file-list elevation-3\" :class=\"{ 'empty-table-fix' : !innerFilelist.length, 'loading-cursor' : isLoading }\">\r\n\r\n\t\t\t<template #progress>\r\n\t\t\t\t<slot name=\"progress\">\r\n\t\t\t\t\t<v-progress-linear indeterminate></v-progress-linear>\r\n\t\t\t\t</slot>\r\n\t\t\t</template>\r\n\r\n\t\t\t<template #no-data>\r\n\t\t\t\t<slot name=\"no-data\">\r\n\t\t\t\t\t<v-alert :value=\"true\" type=\"info\" class=\"text-left ma-0\" @contextmenu.prevent=\"\">\r\n\t\t\t\t\t\t{{ $t(noItemsText) }}\r\n\t\t\t\t\t</v-alert>\r\n\t\t\t\t</slot>\r\n\t\t\t</template>\r\n\r\n\t\t\t<template #item=\"props\">\r\n\t\t\t\t<tr v-ripple :active=\"props.isSelected\" @keydown.space.prevent=\"props.select(!props.isSelected)\"\r\n\t\t\t\t\t@touchstart=\"onItemTouchStart(props, $event)\" @touchend=\"onItemTouchEnd\"\r\n\t\t\t\t\t@click=\"onItemClick(props)\" @keydown.enter.prevent=\"onItemClick(props)\"\r\n\t\t\t\t\t@contextmenu.prevent=\"onItemContextmenu(props, $event)\" @keydown.escape.prevent=\"contextMenu.shown = false\"\r\n\t\t\t\t\t@dragstart=\"onItemDragStart(props.item, $event)\" @dragover=\"onItemDragOver(props.item, $event)\" @drop.prevent=\"onItemDragDrop(props.item, $event)\"\r\n\t\t\t\t\t:data-filename=\"(props.item.isDirectory ? '*' : '') + props.item.name\" draggable=\"true\" tabindex=\"0\">\r\n\r\n\t\t\t\t\t<td v-for=\"header in props.headers\" :key=\"header.value\" :class=\"{ 'pr-0': header.value === 'data-table-select' }\">\r\n\t\t\t\t\t\t<template v-if=\"header.value === 'data-table-select'\">\r\n\t\t\t\t\t\t\t<v-checkbox :input-value=\"props.isSelected\" @touchstart.stop=\"\" @touchend.stop=\"\" @click.stop.prevent=\"props.select(!props.isSelected)\" primary hide-details class=\"mt-n1\" tabindex=\"-1\"></v-checkbox>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else-if=\"header.value === 'name'\">\r\n\t\t\t\t\t\t\t<div class=\"d-inline-flex align-center\">\r\n\t\t\t\t\t\t\t\t<slot :name=\"`${props.item.isDirectory ? 'folder' : 'file'}.${props.item.name}`\">\r\n\t\t\t\t\t\t\t\t\t<v-icon class=\"mr-1\">{{ props.item.isDirectory ? folderIcon : fileIcon }}</v-icon> {{ props.item.name }}\r\n\t\t\t\t\t\t\t\t</slot>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else-if=\"header.unit === 'bytes'\">\r\n\t\t\t\t\t\t\t{{ (props.item[header.value] !== null) ? $displaySize(props.item[header.value]) : '' }}\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else-if=\"header.unit === 'date'\">\r\n\t\t\t\t\t\t\t{{ props.item.lastModified ? props.item.lastModified.toLocaleString() : $t('generic.noValue') }}\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else-if=\"header.unit === 'filaments'\">\r\n\t\t\t\t\t\t\t<v-tooltip bottom :disabled=\"!props.item[header.value] || props.item[header.value].length <= 1\">\r\n\t\t\t\t\t\t\t\t<template #activator=\"{ on }\">\r\n\t\t\t\t\t\t\t\t\t<span v-on=\"on\">\r\n\t\t\t\t\t\t\t\t\t\t{{ displayLoadingValue(props.item, header.value, 1, 'mm') }}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t\t\t\t{{ $display(props.item[header.value], 1, 'mm') }}\r\n\t\t\t\t\t\t\t</v-tooltip>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else-if=\"header.unit === 'time'\">\r\n\t\t\t\t\t\t\t{{ displayTimeValue(props.item, header.value) }}\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t<template v-else>\r\n\t\t\t\t\t\t\t{{ displayLoadingValue(props.item, header.value, header.precision, header.unit) }}\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</template>\r\n\t\t</v-data-table>\r\n\r\n\t\t<v-menu v-model=\"contextMenu.shown\" :position-x=\"contextMenu.x\" :position-y=\"contextMenu.y\" absolute offset-y>\r\n\t\t\t<v-list>\r\n\t\t\t\t<slot name=\"context-menu\"></slot>\r\n\r\n\t\t\t\t<v-list-item v-show=\"!noDownload && innerValue.length === 1 && filesSelected\" @click=\"download\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-cloud-download</v-icon> {{ $tc('list.baseFileList.download', innerValue.length) }}\r\n\t\t\t\t</v-list-item>\r\n\t\t\t\t<v-list-item v-show=\"!noEdit && innerValue.length === 1 && filesSelected\" :disabled=\"!canEditFile\" @click=\"edit(innerValue[0])\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-file-document-edit</v-icon> {{ $t('list.baseFileList.edit') }}\r\n\t\t\t\t</v-list-item>\r\n\t\t\t\t<v-list-item v-show=\"!noRename && innerValue.length === 1\" @click=\"rename\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-rename-box</v-icon> {{ $t('list.baseFileList.rename') }}\r\n\t\t\t\t</v-list-item>\r\n\t\t\t\t<v-list-item v-show=\"!noDelete\" @click=\"remove\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-delete</v-icon> {{ $t('list.baseFileList.delete') }}\r\n\t\t\t\t</v-list-item>\r\n\t\t\t\t<v-list-item v-show=\"!foldersSelected && innerValue.length > 1\" @click=\"downloadZIP\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-package-down</v-icon> {{ $t('list.baseFileList.downloadZIP') }}\r\n\t\t\t\t</v-list-item>\r\n\t\t\t</v-list>\r\n\t\t</v-menu>\r\n\r\n\t\t<file-edit-dialog :shown.sync=\"editDialog.shown\" :filename=\"editDialog.filename\" v-model=\"editDialog.content\" @editComplete=\"$emit('fileEdited', $event)\"></file-edit-dialog>\r\n\t\t<input-dialog :shown.sync=\"renameDialog.shown\" :title=\"$t('dialog.renameFile.title')\" :prompt=\"$t('dialog.renameFile.prompt')\" :preset=\"renameDialog.item && renameDialog.item.name\" @confirmed=\"renameCallback\"></input-dialog>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport JSZip from 'jszip'\r\nimport saveAs from 'file-saver'\r\nimport { VDataTable } from 'vuetify/lib'\r\n\r\nimport Vue from 'vue'\r\nimport { mapState, mapGetters, mapActions, mapMutations } from 'vuex'\r\n\r\nimport i18n from '../../i18n'\r\nimport { defaultMachine, getModifiedDirectories } from '../../store/machine'\r\nimport { DisconnectedError, OperationCancelledError } from '../../utils/errors.js'\r\nimport Path from '../../utils/path.js'\r\n\r\nconst maxEditFileSize = 15728640;\t\t// 15 MiB\r\n\r\nexport default {\r\n\tprops: {\r\n\t\theaders: Array,\r\n\t\tsortTable: String,\r\n\t\tdirectory: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tfilelist: Array,\r\n\t\tvalue: Array,\r\n\t\tfileIcon: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'mdi-file'\r\n\t\t},\r\n\t\tfolderIcon: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'mdi-folder'\r\n\t\t},\r\n\t\tloading: Boolean,\r\n\t\tdoingFileOperation: Boolean,\r\n\t\tnoDragDrop: Boolean,\r\n\t\tnoDownload: Boolean,\r\n\t\tnoEdit: Boolean,\r\n\t\tnoFilesText:\r\n\t\t{\r\n\t\t\ttype: String,\r\n\t\t\tdefault: ''\r\n\t\t},\r\n\t\tnoRename: Boolean,\r\n\t\tnoDelete: Boolean\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState(['selectedMachine']),\r\n\t\t...mapGetters(['isConnected']),\r\n\t\t...mapState('machine', ['isReconnecting']),\r\n\t\t...mapState('machine/cache', ['sorting']),\r\n\t\t...mapState('machine/model', ['volumes']),\r\n\t\tdefaultHeaders() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: i18n.t('list.baseFileList.fileName'),\r\n\t\t\t\t\tvalue: 'name'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: i18n.t('list.baseFileList.size'),\r\n\t\t\t\t\tvalue: 'size',\r\n\t\t\t\t\tunit: 'bytes'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: i18n.t('list.baseFileList.lastModified'),\r\n\t\t\t\t\tvalue: 'lastModified',\r\n\t\t\t\t\tunit: 'date'\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t},\r\n\t\tisLoading() {\r\n\t\t\treturn this.loading || this.innerLoading || this.doingFileOperation || this.innerDoingFileOperation;\r\n\t\t},\r\n\t\tfoldersSelected() {\r\n\t\t\treturn this.innerValue.some(item => item.isDirectory)\r\n\t\t},\r\n\t\tfilesSelected() {\r\n\t\t\treturn this.innerValue.some(item => !item.isDirectory)\r\n\t\t},\r\n\t\tcanEditFile() {\r\n\t\t\treturn (this.innerValue.length > 0) && (this.innerValue[0].size < maxEditFileSize);\r\n\t\t},\r\n\t\tnoItemsText() {\r\n\t\t\tif (this.selectedMachine === defaultMachine) {\r\n\t\t\t\treturn this.noFilesText;\r\n\t\t\t}\r\n\t\t\tconst volume = Path.getVolume(this.innerDirectory);\r\n\t\t\treturn (volume >= 0 && volume < this.volumes.length && this.volumes[volume].mounted) ? this.noFilesText : 'list.baseFileList.driveUnmounted';\r\n\t\t},\r\n\t\tinternalSortBy: {\r\n\t\t\tget() { return this.sorting[this.sortTable].column; },\r\n\t\t\tset(value) {\r\n\t\t\t\tthis.setSorting({ table: this.sortTable, column: value, descending: this.internalSortDesc });\r\n\t\t\t}\r\n\t\t},\r\n\t\tinternalSortDesc: {\r\n\t\t\tget() { return this.sorting[this.sortTable].descending; },\r\n\t\t\tset(value) {\r\n\t\t\t\tthis.setSorting({ table: this.sortTable, column: this.internalSortBy, descending: value });\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tunsubscribe: undefined,\r\n\t\t\twasMounted: false,\r\n\t\t\tinitialDirectory: this.directory,\r\n\t\t\tinnerDirectory: this.directory,\r\n\t\t\tinnerFilelist: [],\r\n\t\t\tinnerLoading: false,\r\n\t\t\tinnerDoingFileOperation: false,\r\n\t\t\tinnerValue: [],\r\n\t\t\tprevSelection: [],\r\n\t\t\tcontextMenu: {\r\n\t\t\t\tshown: false,\r\n\t\t\t\ttouchTimer: undefined,\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0\r\n\t\t\t},\r\n\t\t\teditDialog: {\r\n\t\t\t\tshown: false,\r\n\t\t\t\tfilename: '',\r\n\t\t\t\tcontent: ''\r\n\t\t\t},\r\n\t\t\trenameDialog: {\r\n\t\t\t\tshown: false,\r\n\t\t\t\tdirectory: '',\r\n\t\t\t\titem: null\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\textends: VDataTable,\r\n\tmethods: {\r\n\t\t...mapActions('machine', {\r\n\t\t\tmachineDownload: 'download',\r\n\t\t\tmachineMove: 'move',\r\n\t\t\tmachineDelete: 'delete',\r\n\t\t\tgetFileList: 'getFileList'\r\n\t\t}),\r\n\t\t...mapMutations('machine/cache', ['setSorting']),\r\n\t\ttoggleAll() {\r\n\t\t\tthis.innerValue = this.innerValue.length ? [] : this.innerFilelist.slice();\r\n\t\t},\r\n\t\tsort(items, sortBy, sortDesc) {\r\n\t\t\tsortBy = sortBy.length ? sortBy[0] : 'name';\r\n\t\t\tsortDesc = sortDesc[0];\r\n\r\n\t\t\t// Sort by index\r\n\t\t\titems.sort(function(a, b) {\r\n\t\t\t\tif (a[sortBy] === b[sortBy]) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (a[sortBy] === null || a[sortBy] === undefined) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tif (b[sortBy] === null || b[sortBy] === undefined) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (a[sortBy].constructor === String && b[sortBy].constructor === String) {\r\n\t\t\t\t\treturn a[sortBy].localeCompare(b[sortBy], undefined, { sensivity: 'base' });\r\n\t\t\t\t}\r\n\t\t\t\tif (a[sortBy] instanceof Array && b[sortBy] instanceof Array) {\r\n\t\t\t\t\tconst reducedA = a[sortBy].length ? a.filament.reduce((a, b) => a + b) : 0;\r\n\t\t\t\t\tconst reducedB = b[sortBy].length ? b.filament.reduce((a, b) => a + b) : 0;\r\n\t\t\t\t\treturn reducedA - reducedB;\r\n\t\t\t\t}\r\n\t\t\t\treturn a[sortBy] - b[sortBy];\r\n\t\t\t});\r\n\r\n\t\t\t// Deal with descending order\r\n\t\t\tif (sortDesc) {\r\n\t\t\t\titems.reverse();\r\n\t\t\t}\r\n\r\n\t\t\t// Then make sure directories come first\r\n\t\t\titems.sort((a, b) => (a.isDirectory === b.isDirectory) ? 0 : (a.isDirectory ? -1 : 1));\r\n\t\t\treturn items;\r\n\t\t},\r\n\t\tasync refresh() {\r\n\t\t\tawait this.loadDirectory(this.innerDirectory);\r\n\t\t},\r\n\t\tasync loadDirectory(directory) {\r\n\t\t\tif (!this.isConnected) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Update our path even if we're still busy loading\r\n\t\t\tthis.innerDirectory = directory;\r\n\t\t\tif (this.innerLoading) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Make sure the current volume is actually available\r\n\t\t\tconst volume = Path.getVolume(this.innerDirectory);\r\n\t\t\tif (volume < 0 || volume >= this.volumes.length || !this.volumes[volume].mounted) {\r\n\t\t\t\tthis.innerDirectory = (volume === 0) ? this.initialDirectory : `${volume}:`;\r\n\t\t\t\tthis.innerFilelist = [];\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Load file list\r\n\t\t\tthis.innerLoading = true;\r\n\t\t\ttry {\r\n\t\t\t\tconst files = await this.getFileList(directory);\r\n\r\n\t\t\t\t// Create missing props if required\r\n\t\t\t\tif (this.headers) {\r\n\t\t\t\t\tfiles.forEach(function(item) {\r\n\t\t\t\t\t\tthis.headers.forEach(function(header) {\r\n\t\t\t\t\t\t\tif (item[header.value] === undefined) {\r\n\t\t\t\t\t\t\t\tVue.set(item, header.value, undefined);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, this);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check if another directory was requested while files were being loaded\r\n\t\t\t\tif (directory !== this.innerDirectory) {\r\n\t\t\t\t\tthis.innerLoading = false;\r\n\t\t\t\t\tthis.loadDirectory(this.innerDirectory);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Assign new file list\r\n\t\t\t\tthis.innerFilelist = files;\r\n\t\t\t\tthis.innerValue = [];\r\n\t\t\t\tthis.$nextTick(function() {\r\n\t\t\t\t\tthis.$emit('directoryLoaded', directory);\r\n\t\t\t\t});\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!(e instanceof DisconnectedError)) {\r\n\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\tthis.$makeNotification('error', this.$t('error.filelistRequestFailed'), e.message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.innerLoading = false;\r\n\t\t},\r\n\t\tdisplayLoadingValue(item, prop, precision, unit = '') {\r\n\t\t\tif (item.isDirectory) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\tif (!item[prop]) {\r\n\t\t\t\treturn this.$t((item[prop] === undefined) ? 'generic.loading' : 'generic.noValue');\r\n\t\t\t}\r\n\r\n\t\t\tlet displayValue;\r\n\t\t\tif (item[prop] instanceof Array) {\r\n\t\t\t\tif (!item[prop].length) {\r\n\t\t\t\t\treturn this.$t('generic.noValue');\r\n\t\t\t\t}\r\n\t\t\t\tdisplayValue = item[prop].reduce((a, b) => a + b);\r\n\t\t\t} else {\r\n\t\t\t\tdisplayValue = item[prop];\r\n\t\t\t}\r\n\r\n\t\t\tif (precision !== undefined) {\r\n\t\t\t\tdisplayValue = displayValue.toFixed(precision);\r\n\t\t\t}\r\n\t\t\treturn `${displayValue} ${unit}`;\r\n\t\t},\r\n\t\tdisplayTimeValue(item, prop) {\r\n\t\t\tif (item.isDirectory) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn (item[prop] !== null) ? this.$displayTime(item[prop]) : this.$t('generic.noValue');\r\n\t\t},\r\n\t\tonItemTouchStart(props, e) {\r\n\t\t\tconst that = this;\r\n\t\t\tthis.contextMenu.touchTimer = setTimeout(function() {\r\n\t\t\t\tthat.contextMenu.touchTimer = undefined;\r\n\t\t\t\tthat.onItemContextmenu(props, { clientX: e.targetTouches[0].clientX, clientY: e.targetTouches[0].clientY });\r\n\t\t\t}, 1000);\r\n\t\t},\r\n\t\tonItemTouchEnd() {\r\n\t\t\tif (this.contextMenu.touchTimer) {\r\n\t\t\t\tclearTimeout(this.contextMenu.touchTimer);\r\n\t\t\t\tthis.contextMenu.touchTimer = undefined;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonItemClick(props) {\r\n\t\t\tif (props.item.isDirectory) {\r\n\t\t\t\tthis.loadDirectory(Path.combine(this.innerDirectory, props.item.name));\r\n\t\t\t} else {\r\n\t\t\t\tthis.$emit('fileClicked', props.item);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonItemContextmenu(props, e) {\r\n\t\t\tif (this.contextMenu.shown) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.onItemTouchEnd();\r\n\r\n\t\t\t// Deal with selection\r\n\t\t\tthis.prevSelection = this.innerValue;\r\n\t\t\tif (!props.isSelected) {\r\n\t\t\t\tthis.innerValue = [];\r\n\t\t\t\tthis.$nextTick(() => props.select(true));\r\n\t\t\t}\r\n\r\n\t\t\t// Open the context menu\r\n\t\t\tthis.contextMenu.shown = false;\r\n\t\t\tthis.contextMenu.x = e.clientX;\r\n\t\t\tthis.contextMenu.y = e.clientY;\r\n\t\t\tthis.$nextTick(() => {\r\n\t\t\t\tthis.contextMenu.shown = true;\r\n\t\t\t});\r\n\t\t},\r\n\t\tonItemDragStart(item, e) {\r\n\t\t\tif (this.noDragDrop || this.contextMenu.touchTimer || this.contextMenu.shown) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst itemsToDrag = this.innerValue;\r\n\t\t\tif (itemsToDrag.indexOf(item) === -1) {\r\n\t\t\t\titemsToDrag.push(item);\r\n\t\t\t}\r\n\t\t\te.dataTransfer.setData('application/json', JSON.stringify({\r\n\t\t\t\ttype: 'dwcFiles',\r\n\t\t\t\tdirectory: this.innerDirectory,\r\n\t\t\t\titems: itemsToDrag\r\n\t\t\t}));\r\n\t\t\te.dataTransfer.effectAllowed = 'move';\r\n\r\n\t\t\tconst table = this.$el.querySelector('table'), firstRow = table.tBodies[0].rows[0];\r\n\t\t\tconst tableClone = table.cloneNode(true), itemFilename = (item.isDirectory ? '*' : '') + item.name;\r\n\t\t\tlet offsetY = 0, countingOffset = true;\r\n\r\n\t\t\ttableClone.tHead.remove();\r\n\t\t\tArray.from(tableClone.tBodies[0].rows).forEach(function(row) {\r\n\t\t\t\tconst filename = row.dataset.filename;\r\n\t\t\t\tif (itemsToDrag.some(item => (item.isDirectory ? '*' : '') + item.name === filename)) {\r\n\t\t\t\t\tArray.from(row.children).forEach(function(td, index) {\r\n\t\t\t\t\t\tif (td.tagName === 'TD') {\r\n\t\t\t\t\t\t\ttd.style.width = `${firstRow.children[index].offsetWidth}px`;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttd.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (countingOffset) {\r\n\t\t\t\t\t\tif (filename === itemFilename) {\r\n\t\t\t\t\t\t\tcountingOffset = false;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toffsetY += firstRow.offsetHeight;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\trow.remove();\r\n\t\t\t\t}\r\n\t\t\t}, this);\r\n\t\t\ttableClone.style.backgroundColor = this.$vuetify.theme.isDark ? '#424242' : '#FFFFFF';\r\n\t\t\ttableClone.style.opacity = 0.7;\r\n\t\t\ttableClone.style.position = 'absolute';\r\n\t\t\ttableClone.style.pointerEvents = 'none';\r\n\t\t\tArray.from(tableClone.querySelectorAll('[class^=\"v-ripple\"]')).forEach(function(item) {\r\n\t\t\t\titem.classList = Array.from(item.classList).filter(c => !c.startsWith('v-ripple'));\r\n\t\t\t});\r\n\t\t\ttable.parentNode.append(tableClone);\r\n\r\n\t\t\tconst x = e.clientX - table.getClientRects()[0].left;\r\n\t\t\tconst y = e.clientY - e.target.closest('tr').getClientRects()[0].top + offsetY;\r\n\t\t\te.dataTransfer.setDragImage(tableClone, x, y);\r\n\r\n\t\t\tsetTimeout(() => tableClone.remove(), 0);\r\n\t\t},\r\n\t\tonItemDragOver(item, e) {\r\n\t\t\tif (!this.noDragDrop && item.isDirectory) {\r\n\t\t\t\tconst jsonData = e.dataTransfer.getData('application/json');\r\n\t\t\t\tif (jsonData) {\r\n\t\t\t\t\tconst data = JSON.parse(jsonData);\r\n\t\t\t\t\tif (data.type === 'dwcFiles' && !data.items.some(dataItem => dataItem.isDirectory && dataItem.name === item.name)) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Fix for Chrome: It does not grant access to dataTransfer on the same domain \"for security reasons\"...\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onItemDragDrop(item, e) {\r\n\t\t\tconst jsonData = e.dataTransfer.getData('application/json');\r\n\t\t\tif (jsonData) {\r\n\t\t\t\tconst data = JSON.parse(jsonData);\r\n\t\t\t\tif (data.type === 'dwcFiles' && !data.items.some(dataItem => dataItem.isDirectory && dataItem.name === item.name)) {\r\n\t\t\t\t\tconst directory = this.innerDirectory;\r\n\t\t\t\t\tfor (let i = 0; i < data.items.length; i++) {\r\n\t\t\t\t\t\tconst from = Path.combine(data.directory, data.items[i].name);\r\n\t\t\t\t\t\tconst to = Path.combine(directory, item.name, data.items[i].name);\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tawait this.machineMove({ from, to });\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tthis.$makeNotification('error', `Failed to move ${data.items[i].name} to ${directory}`, e.message);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync download(item) {\r\n\t\t\ttry {\r\n\t\t\t\tconst filename = (item && item.name) ? item.name : this.innerValue[0].name;\r\n\t\t\t\tconst blob = await this.machineDownload({ filename: Path.combine(this.innerDirectory, filename), type: 'blob' });\r\n\t\t\t\tsaveAs(blob, filename);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!(e instanceof DisconnectedError) && !(e instanceof OperationCancelledError)) {\r\n\t\t\t\t\t// should be handled before we get here\r\n\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync edit(item) {\r\n\t\t\ttry {\r\n\t\t\t\tconst filename = Path.combine(this.innerDirectory, item.name);\r\n\t\t\t\tconst response = await this.machineDownload({ filename, type: 'text', showSuccess: false });\r\n\t\t\t\tthis.editDialog.filename = filename;\r\n\t\t\t\tthis.editDialog.content = response;\r\n\t\t\t\tthis.editDialog.shown = true;\r\n\t\t\t} catch (e) {\r\n\t\t\t\tif (!(e instanceof DisconnectedError) && !(e instanceof OperationCancelledError)) {\r\n\t\t\t\t\t// should be handled before we get here\r\n\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync rename(item) {\r\n\t\t\tthis.renameDialog.directory = this.innerDirectory;\r\n\t\t\tthis.renameDialog.item = (item && item.name) ? item : this.innerValue[0];\r\n\t\t\tthis.renameDialog.shown = true;\r\n\t\t},\r\n\t\tasync renameCallback(newFilename) {\r\n\t\t\tconst oldFilename = this.renameDialog.item.name;\r\n\t\t\tif (this.innerDoingFileOperation) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.innerDoingFileOperation = true;\r\n\t\t\ttry {\r\n\t\t\t\tawait this.machineMove({\r\n\t\t\t\t\tfrom: Path.combine(this.renameDialog.directory, oldFilename),\r\n\t\t\t\t\tto: Path.combine(this.renameDialog.directory, newFilename)\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.innerFilelist.some(function(file) {\r\n\t\t\t\t\tif (file.isDirectory === this.isDirectory && file.name === this.name) {\r\n\t\t\t\t\t\tfile.name = newFilename;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}, this.renameDialog.item);\r\n\r\n\t\t\t\tthis.$makeNotification('success', this.$t('notification.rename.success', [oldFilename, newFilename]));\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.warn(e);\r\n\t\t\t\tthis.$log('error', this.$t('notification.rename.error', [oldFilename, newFilename]), e.message);\r\n\t\t\t}\r\n\t\t\tthis.innerDoingFileOperation = false;\r\n\t\t},\r\n\t\tasync remove(items) {\r\n\t\t\tif (!items || !(items instanceof Array)) {\r\n\t\t\t\titems = this.innerValue.slice();\r\n\t\t\t}\r\n\r\n\t\t\tif (this.innerDoingFileOperation) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.innerDoingFileOperation = true;\r\n\t\t\tconst deletedItems = [], directory = this.directory;\r\n\t\t\tfor (let i = 0; i < items.length; i++) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst item = items[i];\r\n\t\t\t\t\tawait this.machineDelete(Path.combine(directory, item.name));\r\n\r\n\t\t\t\t\tdeletedItems.push(items[i]);\r\n\t\t\t\t\tthis.innerFilelist = this.innerFilelist.filter(file => file.isDirectory !== item.isDirectory || file.name !== item.name);\r\n\t\t\t\t\tthis.innerValue = this.innerValue.filter(file => file.isDirectory !== item.isDirectory || file.name !== item.name);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tthis.$makeNotification('error', this.$t('notification.delete.errorTitle', [items[i].name]), items[i].isDirectory ? this.$t('notification.delete.errorMessageDirectory') : e.message);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (deletedItems.length) {\r\n\t\t\t\tthis.$log('success', (deletedItems.length > 1) ? this.$t('notification.delete.successMultiple', [deletedItems.length]) : this.$t('notification.delete.success', [deletedItems[0].name]));\r\n\t\t\t}\r\n\t\t\tthis.innerDoingFileOperation = false;\r\n\t\t},\r\n\t\tasync downloadZIP(items) {\r\n\t\t\tif (!items || !(items instanceof Array)) { items = this.innerValue.slice(); }\r\n\t\t\tconst directory = this.directory;\r\n\r\n\t\t\t// Download files\r\n\t\t\tconst zip = new JSZip();\r\n\t\t\tfor (let i = 0; i < items.length; i++) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst blob = await this.machineDownload({ filename: Path.combine(directory, items[i].name), type: 'blob', num: i + 1, count: items.length });\r\n\t\t\t\t\tzip.file(items[i].name, blob);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tif (!(e instanceof DisconnectedError) && !(e instanceof OperationCancelledError)) {\r\n\t\t\t\t\t\t// should be handled before we get here\r\n\t\t\t\t\t\tconsole.warn(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Compress files and save the new archive\r\n\t\t\tconst notification = this.$makeNotification('info', this.$t('notification.compress.title'), this.$t('notification.compress.message'));\r\n\t\t\ttry {\r\n\t\t\t\tconst zipBlob = await zip.generateAsync({ type: 'blob' });\r\n\t\t\t\tsaveAs(zipBlob, 'download.zip');\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.warn(e);\r\n\t\t\t\tthis.$makeNotification('error', this.$t('notification.compress.errorTitle'), e.message);\r\n\t\t\t}\r\n\t\t\tnotification.hide();\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\t// Perform initial load\r\n\t\tif (this.isConnected) {\r\n\t\t\tconst volume = Path.getVolume(this.innerDirectory);\r\n\t\t\tthis.wasMounted = (volume >= 0) && (volume >= this.volumes.length) && this.volumes[volume].mounted;\r\n\t\t\tthis.refresh();\r\n\t\t}\r\n\r\n\t\t// Keep track of file changes\r\n\t\tconst that = this;\r\n\t\tthis.unsubscribe = this.$store.subscribeAction(async function(action, state) {\r\n\t\t\tif (!that.doingFileOperation && !that.innerDoingFileOperation &&\r\n\t\t\t\tgetModifiedDirectories(action, state).some(directory => Path.equals(directory, that.innerDirectory))) {\r\n\t\t\t\t// Refresh the list when a file or directory has been changed\r\n\t\t\t\tawait that.refresh();\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tbeforeDestroy() {\r\n\t\tthis.unsubscribe();\r\n\t},\r\n\twatch: {\r\n\t\tisConnected(to) {\r\n\t\t\tif (to) {\r\n\t\t\t\tthis.refresh();\r\n\t\t\t} else {\r\n\t\t\t\tthis.innerDirectory = this.initialDirectory;\r\n\t\t\t\tthis.innerFilelist = [];\r\n\r\n\t\t\t\tthis.editDialog.shown = false;\r\n\t\t\t\tthis.renameDialog.shown = false;\r\n\t\t\t}\r\n\t\t},\r\n\t\tselectedMachine() {\r\n\t\t\t// TODO store current directory per selected machine\r\n\t\t\tthis.innerDirectory = this.initialDirectory;\r\n\t\t\tthis.innerFilelist = [];\r\n\r\n\t\t\tthis.editDialog.shown = false;\r\n\t\t\tthis.renameDialog.shown = false;\r\n\t\t},\r\n\t\tvolumes: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler() {\r\n\t\t\t\tif (this.isConnected) {\r\n\t\t\t\t\tconst volume = Path.getVolume(this.directory);\r\n\t\t\t\t\tif (volume >= 0 && volume < this.volumes.length) {\r\n\t\t\t\t\t\tconst mounted = this.volumes[volume].mounted;\r\n\t\t\t\t\t\tif (this.wasMounted !== mounted) {\r\n\t\t\t\t\t\t\tthis.wasMounted = mounted;\r\n\t\t\t\t\t\t\tthis.refresh();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.wasMounted = false;\r\n\t\t\t\t\t\tthis.refresh();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tdirectory(to) {\r\n\t\t\tif (to !== this.innerDirectory) {\r\n\t\t\t\tthis.loadDirectory(to);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinnerDirectory(to) {\r\n\t\t\tif (this.directory !== to) {\r\n\t\t\t\tthis.$emit('update:directory', to);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinnerFilelist(to) {\r\n\t\t\tif (this.filelist !== to) {\r\n\t\t\t\tthis.$emit('update:filelist', to);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinnerLoading(to) {\r\n\t\t\tif (this.loading !== to) {\r\n\t\t\t\tthis.$emit('update:loading', to);\r\n\t\t\t}\r\n\t\t},\r\n\t\tinnerValue(to) {\r\n\t\t\tif (this.value !== to) {\r\n\t\t\t\tthis.$emit('input', to);\r\n\t\t\t}\r\n\t\t},\r\n\t\t'contextMenu.shown'(to) {\r\n\t\t\tif (!to) {\r\n\t\t\t\t// Restore previously selected items\r\n\t\t\t\tthis.innerValue = this.prevSelection;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"]}]}