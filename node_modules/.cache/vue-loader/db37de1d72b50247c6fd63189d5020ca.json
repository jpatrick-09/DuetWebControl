{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\lists\\EventList.vue?vue&type=style&index=1&id=9a987d40&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\lists\\EventList.vue","mtime":1592248188540},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKDQoubWVzc2FnZSB7DQoJd2hpdGUtc3BhY2U6IHByZS13cmFwOw0KfQ0KDQp0aDpsYXN0LWNoaWxkIHsNCglwYWRkaW5nLXJpZ2h0OiAwICFpbXBvcnRhbnQ7DQoJd2lkdGg6IDElOw0KfQ0K"},{"version":3,"sources":["EventList.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"EventList.vue","sourceRoot":"src/components/lists","sourcesContent":["<style>\r\ntd.log-cell {\r\n\tpadding-top: 8px !important;\r\n\tpadding-bottom: 8px !important;\r\n\theight: auto !important;\r\n}\r\n\r\ntd.title-cell {\r\n\tvertical-align: top;\r\n}\r\n</style>\r\n\r\n<style scoped>\r\n.message {\r\n\twhite-space: pre-wrap;\r\n}\r\n\r\nth:last-child {\r\n\tpadding-right: 0 !important;\r\n\twidth: 1%;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<div class=\"component\">\r\n\t\t<v-data-table\r\n\t\t\t:headers=\"headers\" :items=\"events\" item-key=\"date\"\r\n\t\t\tdisable-pagination hide-default-footer :mobile-breakpoint=\"0\"\r\n\t\t\t:custom-sort=\"sort\" :sort-by.sync=\"sortBy\" :sort-desc.sync=\"sortDesc\" must-sort\r\n\t\t\tclass=\"elevation-3\" :class=\"{ 'empty-table-fix' : !events.length }\">\r\n\r\n\t\t\t<template #no-data>\r\n\t\t\t\t<v-alert :value=\"true\" type=\"info\" class=\"text-left ma-0\">\r\n\t\t\t\t\t{{ $t('list.eventLog.noEvents') }}\r\n\t\t\t\t</v-alert>\r\n\t\t\t</template>\r\n\r\n\t\t\t<template #header.btn>\r\n\t\t\t\t<v-menu offset-y>\r\n\t\t\t\t\t<template #activator=\"{ on }\">\r\n\t\t\t\t\t\t<v-btn v-on=\"on\" icon>\r\n\t\t\t\t\t\t\t<v-icon small>mdi-menu</v-icon>\r\n\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t</template>\r\n\r\n\t\t\t\t\t<v-list>\r\n\t\t\t\t\t\t<v-list-item @click=\"clearLog\">\r\n\t\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-notification-clear-all</v-icon> {{ $t('list.eventLog.clear') }}\r\n\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t\t<v-list-item :disabled=\"!events.length\" @click=\"downloadText\">\r\n\t\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-file-download</v-icon> {{ $t('list.eventLog.downloadText') }}\r\n\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t\t<v-list-item :disabled=\"!events.length\" @click=\"downloadCSV\">\r\n\t\t\t\t\t\t\t<v-icon class=\"mr-1\">mdi-cloud-download</v-icon> {{ $t('list.eventLog.downloadCSV') }}\r\n\t\t\t\t\t\t</v-list-item>\r\n\t\t\t\t\t</v-list>\r\n\t\t\t\t</v-menu>\r\n\t\t\t</template>\r\n\r\n\t\t\t<template #item=\"{ item }\">\r\n\t\t\t\t<tr :class=\"getClassByEvent(item.type)\">\r\n\t\t\t\t\t<td class=\"log-cell title-cell\">\r\n\t\t\t\t\t\t{{ item.date.toLocaleString() }}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td class=\"log-cell content-cell\" colspan=\"2\">\r\n\t\t\t\t\t\t<strong>{{ item.title }}</strong>\r\n\t\t\t\t\t\t<br v-if=\"item.title && item.message\">\r\n\t\t\t\t\t\t<span v-if=\"item.message\" class=\"message\" v-html=\"formatMessage(item.message)\"></span>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</template>\r\n\t\t</v-data-table>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport i18n from '../../i18n'\r\n\r\nimport saveAs from 'file-saver'\r\nimport { mapState, mapMutations } from 'vuex'\r\n\r\nexport default {\r\n\tcomputed: {\r\n\t\t...mapState('machine', ['events']),\r\n\t\t...mapState('machine/cache', ['sorting']),\r\n\t\t...mapState('settings', ['darkTheme']),\r\n\t\theaders() {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: i18n.t('list.eventLog.date'),\r\n\t\t\t\t\tvalue: 'date',\r\n\t\t\t\t\twidth: '15%'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: i18n.t('list.eventLog.message'),\r\n\t\t\t\t\tvalue: 'message',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\twidth: '74%'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: '',\r\n\t\t\t\t\tvalue: 'btn',\r\n\t\t\t\t\tsortable: false,\r\n\t\t\t\t\twidth: '1%'\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\tsortBy: {\r\n\t\t\tget() { return this.sorting.events.column; },\r\n\t\t\tset(value) {\r\n\t\t\t\tthis.setSorting({ table: 'events', column: value, descending: this.sortDesc });\r\n\t\t\t}\t\t\t\t\r\n\t\t},\r\n\t\tsortDesc: {\r\n\t\t\tget() { return this.sorting.events.descending; },\r\n\t\t\tset(value) {\r\n\t\t\t\tthis.setSorting({ table: 'events', column: this.sortBy, descending: value });\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapMutations('machine', ['clearLog']),\r\n\t\t...mapMutations('machine/cache', ['setSorting']),\r\n\t\tgetHeaderText: (header) => (header.text instanceof(Function)) ? header.text() : header.text,\r\n\t\tgetClassByEvent(type) {\r\n\t\t\tif (this.darkTheme) {\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tcase 'success': return 'green darken-1';\r\n\t\t\t\t\tcase 'warning': return 'amber darken-1';\r\n\t\t\t\t\tcase 'error': return 'red darken-1';\r\n\t\t\t\t}\r\n\t\t\t\treturn 'blue darken-1';\r\n\t\t\t} else {\r\n\t\t\t\tswitch (type) {\r\n\t\t\t\t\tcase 'success': return 'green accent-2';\r\n\t\t\t\t\tcase 'warning': return 'amber accent-1';\r\n\t\t\t\t\tcase 'error': return 'red accent-1';\r\n\t\t\t\t}\r\n\t\t\t\treturn 'light-blue accent-1';\r\n\t\t\t}\r\n\t\t},\r\n\t\tformatMessage(message) {\r\n\t\t\treturn message.replace(/Error:/g, '<strong>Error:</strong>').replace(/Warning:/g, '<strong>Warning:</strong>');\r\n\t\t},\r\n\t\tdownloadText() {\r\n\t\t\tlet textContent = '';\r\n\t\t\tthis.events.forEach(function(e) {\r\n\t\t\t\tconst title = e.title.replace(/\\n/g, '\\r\\n');\r\n\t\t\t\tconst message = e.message ? e.message.replace(/\\n/g, '\\r\\n') : '';\r\n\t\t\t\ttextContent += `${e.date.toLocaleString()}: ${message ? (title + \": \" + message) : title}\\r\\n`;\r\n\t\t\t});\r\n\r\n\t\t\tconst file = new File([textContent], 'console.txt', { type: 'text/plain;charset=utf-8' });\r\n\t\t\tsaveAs(file);\r\n\t\t},\r\n\t\tdownloadCSV() {\r\n\t\t\tvar csvContent = '\"date\",\"time\",\"title\",\"message\"\\r\\n';\r\n\t\t\tthis.events.forEach(function(e) {\r\n\t\t\t\tconst title = e.title.replace(/\"/g, '\"\"').replace(/\\n/g, '\\r\\n');\r\n\t\t\t\tconst message = e.message ? e.message.replace(/\"/g, '\"\"').replace(/\\n/g, '\\r\\n') : '';\r\n\t\t\t\tcsvContent += `\"${e.date.toLocaleDateString()}\",\"${e.date.toLocaleTimeString()}\",\"${title}\",\"${message}\"\\r\\n`;\r\n\t\t\t});\r\n\r\n\t\t\tconst file = new File([csvContent], 'console.csv', { type: 'text/csv;charset=utf-8' });\r\n\t\t\tsaveAs(file);\r\n\t\t},\r\n\t\tsort(items, sortBy, sortDesc) {\r\n\t\t\t// FIXME This method should not be needed but it appears like Vuetify's default\r\n\t\t\t// sort algorithm only takes into account times but not dates\r\n\r\n\t\t\t// Sort by datetime - everything else is unsupported\r\n\t\t\titems.sort(function(a, b) {\r\n\t\t\t\tif (a.date === b.date) {\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (a.date === null || a.date === undefined) {\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t}\r\n\t\t\t\tif (b.date === null || b.date === undefined) {\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn a.date - b.date;\r\n\t\t\t});\r\n\r\n\t\t\t// Deal with descending order\r\n\t\t\tif (sortDesc[0]) {\r\n\t\t\t\titems.reverse();\r\n\t\t\t}\r\n\t\t\treturn items;\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"]}]}