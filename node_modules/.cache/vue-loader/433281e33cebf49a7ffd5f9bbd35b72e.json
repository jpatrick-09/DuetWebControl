{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\dialogs\\FileEditDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\dialogs\\FileEditDialog.vue","mtime":1592248188521},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQondXNlIHN0cmljdCcNCg0KaW1wb3J0IHsgbWFwU3RhdGUsIG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4Jw0KDQppbXBvcnQgUGF0aCBmcm9tICcuLi8uLi91dGlscy9wYXRoLmpzJw0KDQpleHBvcnQgZGVmYXVsdCB7DQoJcHJvcHM6IHsNCgkJc2hvd246IHsNCgkJCXR5cGU6IEJvb2xlYW4sDQoJCQlyZXF1aXJlZDogdHJ1ZQ0KCQl9LA0KCQlmaWxlbmFtZTogew0KCQkJdHlwZTogU3RyaW5nLA0KCQkJcmVxdWlyZWQ6IHRydWUNCgkJfSwNCgkJdmFsdWU6IFN0cmluZw0KCX0sDQoJY29tcHV0ZWQ6IHsNCgkJLi4ubWFwU3RhdGUoJ21hY2hpbmUvbW9kZWwnLCB7DQoJCQltYWNyb3NEaXJlY3Rvcnk6IHN0YXRlID0+IHN0YXRlLmRpcmVjdG9yaWVzLm1hY3JvcywNCgkJCW1lbnVEaXJlY3Rvcnk6IHN0YXRlID0+IHN0YXRlLmRpcmVjdG9yaWVzLm1lbnUNCgkJfSksDQoJCXNob3dHQ29kZUhlbHAoKSB7DQoJCQlpZiAoUGF0aC5zdGFydHNXaXRoKHRoaXMuZmlsZW5hbWUsIHRoaXMubWFjcm9zRGlyZWN0b3J5KSkgew0KCQkJCXJldHVybiB0cnVlOw0KCQkJfQ0KCQkJY29uc3QgbWF0Y2hlcyA9IC9cLiguKikkLy5leGVjKHRoaXMuZmlsZW5hbWUudG9Mb3dlckNhc2UoKSk7DQoJCQlyZXR1cm4gbWF0Y2hlcyAmJiBbJy5nJywgJy5nY29kZScsICcuZ2MnLCAnLmdjbycsICcubmMnLCAnLm5nYycsICcudGFwJ10uaW5kZXhPZihtYXRjaGVzWzFdKTsNCgkJfSwNCgkJc2hvd0Rpc3BsYXlIZWxwKCkgew0KCQkJcmV0dXJuIFBhdGguc3RhcnRzV2l0aCh0aGlzLmZpbGVuYW1lLCB0aGlzLm1lbnVEaXJlY3RvcnkpOw0KCQl9DQoJfSwNCglkYXRhKCkgew0KCQlyZXR1cm4gew0KCQkJaW5uZXJWYWx1ZTogJycsDQoJCQl2YWx1ZUNoYW5nZWQ6IGZhbHNlDQoJCX0NCgl9LA0KCW1ldGhvZHM6IHsNCgkJLi4ubWFwQWN0aW9ucygnbWFjaGluZScsIFsndXBsb2FkJ10pLA0KCQljbG9zZShmaWxlU2F2ZWQpIHsNCgkJCWlmICh0aGlzLnZhbHVlQ2hhbmdlZCAmJiAhZmlsZVNhdmVkICYmICFjb25maXJtKHRoaXMuJHQoJ2RpYWxvZy5maWxlRWRpdC5jb25maXJtQ2xvc2UnKSkpIHsNCgkJCQlyZXR1cm47DQoJCQl9DQoNCgkJCXRoaXMuJGVtaXQoJ2lucHV0JywgJycpOw0KCQkJdGhpcy4kZW1pdCgndXBkYXRlOnNob3duJywgZmFsc2UpOw0KCQkJdGhpcy4kcm9vdC4kZW1pdCgnZGlhbG9nLWNsb3NpbmcnKQ0KCQl9LA0KCQlhc3luYyBzYXZlKCkgew0KCQkJY29uc3QgY29udGVudCA9IG5ldyBCbG9iKFt0aGlzLmlubmVyVmFsdWVdKTsNCgkJCXRoaXMuY2xvc2UodHJ1ZSk7DQoNCgkJCXRyeSB7DQoJCQkJYXdhaXQgdGhpcy51cGxvYWQoeyBmaWxlbmFtZTogdGhpcy5maWxlbmFtZSwgY29udGVudCB9KTsNCgkJCQl0aGlzLiRlbWl0KCdlZGl0Q29tcGxldGUnLCB0aGlzLmZpbGVuYW1lKTsNCgkJCX0gY2F0Y2ggKGUpIHsNCgkJCQkvLyBUT0RPIE9wdGlvbmFsbHkgYXNrIHVzZXIgdG8gc2F2ZSBmaWxlIHNvbWV3aGVyZSBlbHNlDQoJCQl9DQoJCX0sDQoJCW9uQmVmb3JlTGVhdmUoZSkgew0KCQkJaWYgKHRoaXMudmFsdWVDaGFuZ2VkKSB7DQoJCQkJLy8gQ2FuY2VsIHRoZSBldmVudC4gQ2hyb21lIGFsc28gcmVxdWlyZXMgcmV0dXJuVmFsdWUgdG8gYmUgc2V0DQoJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJCWUucmV0dXJuVmFsdWUgPSAnJzsNCgkJCX0NCgkJfSwNCgkJb25UZXh0YXJlYVRhYihlKSB7DQoJCQljb25zdCBvcmlnaW5hbFNlbGVjdGlvblN0YXJ0ID0gZS50YXJnZXQuc2VsZWN0aW9uU3RhcnQ7DQoJCQljb25zdCB0ZXh0U3RhcnQgPSBlLnRhcmdldC52YWx1ZS5zbGljZSgwLCBvcmlnaW5hbFNlbGVjdGlvblN0YXJ0KSwgdGV4dEVuZCA9IGUudGFyZ2V0LnZhbHVlLnNsaWNlKG9yaWdpbmFsU2VsZWN0aW9uU3RhcnQpOw0KCQkJdGhpcy5pbm5lclZhbHVlID0gYCR7dGV4dFN0YXJ0fVx0JHt0ZXh0RW5kfWA7DQoJCQllLnRhcmdldC52YWx1ZSA9IHRoaXMuaW5uZXJWYWx1ZTsNCgkJCWUudGFyZ2V0LnNlbGVjdGlvbkVuZCA9IGUudGFyZ2V0LnNlbGVjdGlvblN0YXJ0ID0gb3JpZ2luYWxTZWxlY3Rpb25TdGFydCArIDE7DQoJCX0NCgl9LA0KCXdhdGNoOiB7DQoJCXNob3duKHRvKSB7DQoJCQkvLyBTZXQgdGV4dGFyZWEgY29udGVudA0KCQkJdGhpcy52YWx1ZUNoYW5nZWQgPSBmYWxzZTsNCgkJCXRoaXMuaW5uZXJWYWx1ZSA9IHRoaXMudmFsdWUgfHwgJyc7DQoNCgkJCWlmICh0bykgew0KCQkJCS8vIEFkZCBub3RpZmljYXRpb24gZm9yIHVzZXJzIGluIGNhc2UgY2hhbmdlcyBoYXZlIG5vdCBiZWVuIHNhdmVkIHlldA0KCQkJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCB0aGlzLm9uQmVmb3JlTGVhdmUpOw0KCQkJfSBlbHNlIHsNCgkJCQkvLyAuLi4gYW5kIHR1cm4gaXQgb2ZmIGFnYWluIHdoZW4gdGhlIGRpYWxvZyBpcyBoaWRkZW4NCgkJCQl3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgdGhpcy5vbkJlZm9yZUxlYXZlKTsNCgkJCX0NCgkJfQ0KCX0NCn0NCg=="},{"version":3,"sources":["FileEditDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FileEditDialog.vue","sourceRoot":"src/components/dialogs","sourcesContent":["<style>\r\n.edit-textarea {\r\n\talign-items: stretch !important;\r\n}\r\n.edit-textarea > div > div {\r\n\talign-items: stretch;\r\n\tflex-grow: 1;\r\n\tpadding-left: 0 !important;\r\n}\r\n.edit-textarea > div > div > div {\r\n\talign-items: stretch !important;\r\n}\r\n.edit-textarea textarea {\r\n\tdisplay: flex;\r\n\tflex-grow: 1;\r\n\tfont-family: monospace;\r\n\tpadding-left: 12px !important;\r\n\tmargin-top: 0 !important;\r\n\tresize: none;\r\n\t-moz-tab-size: 4;\r\n\t-o-tab-size: 4;\r\n\ttab-size: 4;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-dialog :value=\"shown\" @input=\"$emit('update:shown', $event)\" fullscreen hide-overlay transition=\"dialog-bottom-transition\">\r\n\t\t<v-card class=\"d-flex flex-column\">\r\n\t\t\t<v-app-bar flat dark color=\"primary\" class=\"flex-grow-0 flex-shrink-1\">\r\n\t\t\t\t<v-btn icon dark @click=\"close(false)\">\r\n\t\t\t\t\t<v-icon>mdi-close</v-icon>\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-toolbar-title>{{ filename }}</v-toolbar-title>\r\n\r\n\t\t\t\t<v-spacer></v-spacer>\r\n\r\n\t\t\t\t<v-btn v-if=\"showGCodeHelp\" dark text href=\"https://duet3d.dozuki.com/Wiki/Gcode\" target=\"_blank\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-help</v-icon> {{ $t('dialog.fileEdit.gcodeReference') }}\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-btn v-if=\"showDisplayHelp\" dark text href=\"https://duet3d.dozuki.com/Wiki/Duet_2_Maestro_12864_display_menu_system\" target=\"_blank\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-help</v-icon> {{ $t('dialog.fileEdit.menuReference') }}\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-btn dark text @click=\"save\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-floppy</v-icon> {{ $t('dialog.fileEdit.save') }}\r\n\t\t\t\t</v-btn>\r\n\t\t\t</v-app-bar>\r\n\r\n\t\t\t<v-textarea ref=\"textarea\" hide-details solo :rows=\"null\" class=\"edit-textarea\"\r\n\t\t\t\t\t\tautocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\r\n\t\t\t\t\t\t:value=\"innerValue\" @input.passive=\"valueChanged = true\" @blur=\"innerValue = $event.target.value\"\r\n\t\t\t\t\t\t@keydown.tab.exact.prevent=\"onTextareaTab\" @keydown.esc.prevent.stop=\"close(false)\"></v-textarea>\r\n\t\t</v-card>\r\n\t</v-dialog>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapState, mapActions } from 'vuex'\r\n\r\nimport Path from '../../utils/path.js'\r\n\r\nexport default {\r\n\tprops: {\r\n\t\tshown: {\r\n\t\t\ttype: Boolean,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tfilename: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tvalue: String\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState('machine/model', {\r\n\t\t\tmacrosDirectory: state => state.directories.macros,\r\n\t\t\tmenuDirectory: state => state.directories.menu\r\n\t\t}),\r\n\t\tshowGCodeHelp() {\r\n\t\t\tif (Path.startsWith(this.filename, this.macrosDirectory)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst matches = /\\.(.*)$/.exec(this.filename.toLowerCase());\r\n\t\t\treturn matches && ['.g', '.gcode', '.gc', '.gco', '.nc', '.ngc', '.tap'].indexOf(matches[1]);\r\n\t\t},\r\n\t\tshowDisplayHelp() {\r\n\t\t\treturn Path.startsWith(this.filename, this.menuDirectory);\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tinnerValue: '',\r\n\t\t\tvalueChanged: false\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['upload']),\r\n\t\tclose(fileSaved) {\r\n\t\t\tif (this.valueChanged && !fileSaved && !confirm(this.$t('dialog.fileEdit.confirmClose'))) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.$emit('input', '');\r\n\t\t\tthis.$emit('update:shown', false);\r\n\t\t\tthis.$root.$emit('dialog-closing')\r\n\t\t},\r\n\t\tasync save() {\r\n\t\t\tconst content = new Blob([this.innerValue]);\r\n\t\t\tthis.close(true);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait this.upload({ filename: this.filename, content });\r\n\t\t\t\tthis.$emit('editComplete', this.filename);\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// TODO Optionally ask user to save file somewhere else\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBeforeLeave(e) {\r\n\t\t\tif (this.valueChanged) {\r\n\t\t\t\t// Cancel the event. Chrome also requires returnValue to be set\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.returnValue = '';\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTextareaTab(e) {\r\n\t\t\tconst originalSelectionStart = e.target.selectionStart;\r\n\t\t\tconst textStart = e.target.value.slice(0, originalSelectionStart), textEnd = e.target.value.slice(originalSelectionStart);\r\n\t\t\tthis.innerValue = `${textStart}\\t${textEnd}`;\r\n\t\t\te.target.value = this.innerValue;\r\n\t\t\te.target.selectionEnd = e.target.selectionStart = originalSelectionStart + 1;\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tshown(to) {\r\n\t\t\t// Set textarea content\r\n\t\t\tthis.valueChanged = false;\r\n\t\t\tthis.innerValue = this.value || '';\r\n\r\n\t\t\tif (to) {\r\n\t\t\t\t// Add notification for users in case changes have not been saved yet\r\n\t\t\t\twindow.addEventListener('beforeunload', this.onBeforeLeave);\r\n\t\t\t} else {\r\n\t\t\t\t// ... and turn it off again when the dialog is hidden\r\n\t\t\t\twindow.removeEventListener('beforeunload', this.onBeforeLeave);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"]}]}