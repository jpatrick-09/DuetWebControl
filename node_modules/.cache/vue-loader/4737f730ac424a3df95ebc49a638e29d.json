{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\dialogs\\FileEditDialog.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\dialogs\\FileEditDialog.vue","mtime":1592248188521},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZWRpdC10ZXh0YXJlYSB7DQoJYWxpZ24taXRlbXM6IHN0cmV0Y2ggIWltcG9ydGFudDsNCn0NCi5lZGl0LXRleHRhcmVhID4gZGl2ID4gZGl2IHsNCglhbGlnbi1pdGVtczogc3RyZXRjaDsNCglmbGV4LWdyb3c6IDE7DQoJcGFkZGluZy1sZWZ0OiAwICFpbXBvcnRhbnQ7DQp9DQouZWRpdC10ZXh0YXJlYSA+IGRpdiA+IGRpdiA+IGRpdiB7DQoJYWxpZ24taXRlbXM6IHN0cmV0Y2ggIWltcG9ydGFudDsNCn0NCi5lZGl0LXRleHRhcmVhIHRleHRhcmVhIHsNCglkaXNwbGF5OiBmbGV4Ow0KCWZsZXgtZ3JvdzogMTsNCglmb250LWZhbWlseTogbW9ub3NwYWNlOw0KCXBhZGRpbmctbGVmdDogMTJweCAhaW1wb3J0YW50Ow0KCW1hcmdpbi10b3A6IDAgIWltcG9ydGFudDsNCglyZXNpemU6IG5vbmU7DQoJLW1vei10YWItc2l6ZTogNDsNCgktby10YWItc2l6ZTogNDsNCgl0YWItc2l6ZTogNDsNCn0NCg=="},{"version":3,"sources":["FileEditDialog.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FileEditDialog.vue","sourceRoot":"src/components/dialogs","sourcesContent":["<style>\r\n.edit-textarea {\r\n\talign-items: stretch !important;\r\n}\r\n.edit-textarea > div > div {\r\n\talign-items: stretch;\r\n\tflex-grow: 1;\r\n\tpadding-left: 0 !important;\r\n}\r\n.edit-textarea > div > div > div {\r\n\talign-items: stretch !important;\r\n}\r\n.edit-textarea textarea {\r\n\tdisplay: flex;\r\n\tflex-grow: 1;\r\n\tfont-family: monospace;\r\n\tpadding-left: 12px !important;\r\n\tmargin-top: 0 !important;\r\n\tresize: none;\r\n\t-moz-tab-size: 4;\r\n\t-o-tab-size: 4;\r\n\ttab-size: 4;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-dialog :value=\"shown\" @input=\"$emit('update:shown', $event)\" fullscreen hide-overlay transition=\"dialog-bottom-transition\">\r\n\t\t<v-card class=\"d-flex flex-column\">\r\n\t\t\t<v-app-bar flat dark color=\"primary\" class=\"flex-grow-0 flex-shrink-1\">\r\n\t\t\t\t<v-btn icon dark @click=\"close(false)\">\r\n\t\t\t\t\t<v-icon>mdi-close</v-icon>\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-toolbar-title>{{ filename }}</v-toolbar-title>\r\n\r\n\t\t\t\t<v-spacer></v-spacer>\r\n\r\n\t\t\t\t<v-btn v-if=\"showGCodeHelp\" dark text href=\"https://duet3d.dozuki.com/Wiki/Gcode\" target=\"_blank\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-help</v-icon> {{ $t('dialog.fileEdit.gcodeReference') }}\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-btn v-if=\"showDisplayHelp\" dark text href=\"https://duet3d.dozuki.com/Wiki/Duet_2_Maestro_12864_display_menu_system\" target=\"_blank\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-help</v-icon> {{ $t('dialog.fileEdit.menuReference') }}\r\n\t\t\t\t</v-btn>\r\n\t\t\t\t<v-btn dark text @click=\"save\">\r\n\t\t\t\t\t<v-icon class=\"mr-1\">mdi-floppy</v-icon> {{ $t('dialog.fileEdit.save') }}\r\n\t\t\t\t</v-btn>\r\n\t\t\t</v-app-bar>\r\n\r\n\t\t\t<v-textarea ref=\"textarea\" hide-details solo :rows=\"null\" class=\"edit-textarea\"\r\n\t\t\t\t\t\tautocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\"\r\n\t\t\t\t\t\t:value=\"innerValue\" @input.passive=\"valueChanged = true\" @blur=\"innerValue = $event.target.value\"\r\n\t\t\t\t\t\t@keydown.tab.exact.prevent=\"onTextareaTab\" @keydown.esc.prevent.stop=\"close(false)\"></v-textarea>\r\n\t\t</v-card>\r\n\t</v-dialog>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapState, mapActions } from 'vuex'\r\n\r\nimport Path from '../../utils/path.js'\r\n\r\nexport default {\r\n\tprops: {\r\n\t\tshown: {\r\n\t\t\ttype: Boolean,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tfilename: {\r\n\t\t\ttype: String,\r\n\t\t\trequired: true\r\n\t\t},\r\n\t\tvalue: String\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState('machine/model', {\r\n\t\t\tmacrosDirectory: state => state.directories.macros,\r\n\t\t\tmenuDirectory: state => state.directories.menu\r\n\t\t}),\r\n\t\tshowGCodeHelp() {\r\n\t\t\tif (Path.startsWith(this.filename, this.macrosDirectory)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst matches = /\\.(.*)$/.exec(this.filename.toLowerCase());\r\n\t\t\treturn matches && ['.g', '.gcode', '.gc', '.gco', '.nc', '.ngc', '.tap'].indexOf(matches[1]);\r\n\t\t},\r\n\t\tshowDisplayHelp() {\r\n\t\t\treturn Path.startsWith(this.filename, this.menuDirectory);\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tinnerValue: '',\r\n\t\t\tvalueChanged: false\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['upload']),\r\n\t\tclose(fileSaved) {\r\n\t\t\tif (this.valueChanged && !fileSaved && !confirm(this.$t('dialog.fileEdit.confirmClose'))) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis.$emit('input', '');\r\n\t\t\tthis.$emit('update:shown', false);\r\n\t\t\tthis.$root.$emit('dialog-closing')\r\n\t\t},\r\n\t\tasync save() {\r\n\t\t\tconst content = new Blob([this.innerValue]);\r\n\t\t\tthis.close(true);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait this.upload({ filename: this.filename, content });\r\n\t\t\t\tthis.$emit('editComplete', this.filename);\r\n\t\t\t} catch (e) {\r\n\t\t\t\t// TODO Optionally ask user to save file somewhere else\r\n\t\t\t}\r\n\t\t},\r\n\t\tonBeforeLeave(e) {\r\n\t\t\tif (this.valueChanged) {\r\n\t\t\t\t// Cancel the event. Chrome also requires returnValue to be set\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\te.returnValue = '';\r\n\t\t\t}\r\n\t\t},\r\n\t\tonTextareaTab(e) {\r\n\t\t\tconst originalSelectionStart = e.target.selectionStart;\r\n\t\t\tconst textStart = e.target.value.slice(0, originalSelectionStart), textEnd = e.target.value.slice(originalSelectionStart);\r\n\t\t\tthis.innerValue = `${textStart}\\t${textEnd}`;\r\n\t\t\te.target.value = this.innerValue;\r\n\t\t\te.target.selectionEnd = e.target.selectionStart = originalSelectionStart + 1;\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tshown(to) {\r\n\t\t\t// Set textarea content\r\n\t\t\tthis.valueChanged = false;\r\n\t\t\tthis.innerValue = this.value || '';\r\n\r\n\t\t\tif (to) {\r\n\t\t\t\t// Add notification for users in case changes have not been saved yet\r\n\t\t\t\twindow.addEventListener('beforeunload', this.onBeforeLeave);\r\n\t\t\t} else {\r\n\t\t\t\t// ... and turn it off again when the dialog is hidden\r\n\t\t\t\twindow.removeEventListener('beforeunload', this.onBeforeLeave);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"]}]}