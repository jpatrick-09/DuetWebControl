{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\panels\\FanPanel.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\panels\\FanPanel.vue","mtime":1592248188561},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQondXNlIHN0cmljdCcNCg0KaW1wb3J0IHsgbWFwU3RhdGUsIG1hcEdldHRlcnMsIG1hcEFjdGlvbnMgfSBmcm9tICd2dWV4Jw0KDQpleHBvcnQgZGVmYXVsdCB7DQoJY29tcHV0ZWQ6IHsNCgkJLi4ubWFwU3RhdGUoJ21hY2hpbmUvbW9kZWwnLCBbJ2ZhbnMnXSksDQoJCS4uLm1hcEdldHRlcnMoWyd1aUZyb3plbiddKSwNCgkJLi4ubWFwR2V0dGVycygnbWFjaGluZS9tb2RlbCcsIFsnY3VycmVudFRvb2wnXSksDQoJCWNhbkNvbnRyb2xGYW5zKCkgew0KCQkJcmV0dXJuICF0aGlzLnVpRnJvemVuICYmICgodGhpcy5jdXJyZW50VG9vbCAmJiB0aGlzLmN1cnJlbnRUb29sLmZhbnMubGVuZ3RoID4gMCkgfHwgKHRoaXMuZmFucy5zb21lKGZhbiA9PiBmYW4gJiYgIWZhbi50aGVybW9zdGF0aWMuY29udHJvbCkpKTsNCgkJfSwNCgkJZmFuVmFsdWU6IHsNCgkJCWdldCgpIHsNCgkJCQkvLyBFdmVuIHRob3VnaCBSUkYgYWxsb3dzIG11bHRpcGxlIGZhbnMgdG8gYmUgYXNzaWduZWQgdG8gYSB0b29sLA0KCQkJCS8vIHdlIGFzc3VtZSB0aGV5IGFsbCBzaGFyZSB0aGUgc2FtZSBmYW4gdmFsdWUgaWYgc3VjaCBhIGNvbmZpZyBpcyBzZXQNCgkJCQljb25zdCBmYW4gPSAodGhpcy5mYW4gPT09IC0xKQ0KCQkJCQk/ICgodGhpcy5jdXJyZW50VG9vbCAmJiB0aGlzLmN1cnJlbnRUb29sLmZhbnMubGVuZ3RoID4gMCkgPyB0aGlzLmN1cnJlbnRUb29sLmZhbnNbMF0gOiAtMSkNCgkJCQkJOiB0aGlzLmZhbjsNCgkJCQlyZXR1cm4gKGZhbiA+PSAwICYmIGZhbiA8IHRoaXMuZmFucy5sZW5ndGggJiYgdGhpcy5mYW5zW2Zhbl0pID8gTWF0aC5yb3VuZCh0aGlzLmZhbnNbZmFuXS5yZXF1ZXN0ZWRWYWx1ZSAqIDEwMCkgOiAwOw0KCQkJfSwNCgkJCXNldCh2YWx1ZSkgew0KCQkJCXZhbHVlID0gTWF0aC5taW4oMTAwLCBNYXRoLm1heCgwLCB2YWx1ZSkpIC8gMTAwOw0KCQkJCWlmICh0aGlzLmZhbiA9PT0gLTEpIHsNCgkJCQkJdGhpcy5zZW5kQ29kZShgTTEwNiBTJHt2YWx1ZS50b0ZpeGVkKDIpfWApOw0KCQkJCX0gZWxzZSB7DQoJCQkJCXRoaXMuc2VuZENvZGUoYE0xMDYgUCR7dGhpcy5mYW59IFMke3ZhbHVlLnRvRml4ZWQoMil9YCk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfSwNCglkYXRhKCkgew0KCQlyZXR1cm4gew0KCQkJZmFuOiAtMQ0KCQl9DQoJfSwNCgltZXRob2RzOiB7DQoJCS4uLm1hcEFjdGlvbnMoJ21hY2hpbmUnLCBbJ3NlbmRDb2RlJ10pLA0KCQl1cGRhdGVGYW5TZWxlY3Rpb24oKSB7DQoJCQlpZiAodGhpcy5mYW4gPT09IC0xKSB7DQoJCQkJaWYgKCF0aGlzLmN1cnJlbnRUb29sKSB7DQoJCQkJCS8vIFRvb2wgbm8gbG9uZ2VyIHNlbGVjdGVkLCB0cnkgdG8gY2hhbmdlIHRvIHRoZSBmaXJzdCBhdmFpbGFibGUgZmFuDQoJCQkJCXRoaXMuZmFuID0gdGhpcy5mYW5zLmZpbmRJbmRleChmYW4gPT4gZmFuICYmICFmYW4udGhlcm1vc3RhdGljLmNvbnRyb2wpOw0KCQkJCX0NCgkJCX0gZWxzZSBpZiAodGhpcy5mYW4gPj0gdGhpcy5mYW5zLmxlbmd0aCB8fCAodGhpcy5mYW4gIT09IC0xICYmIHRoaXMuZmFuc1t0aGlzLmZhbl0gJiYgdGhpcy5mYW5zW3RoaXMuZmFuXS50aGVybW9zdGF0aWMuY29udHJvbCkpIHsNCgkJCQkvLyBTZWxlY3RlZCBmYW4gaXMgbm8gbG9uZ2VyIGNvbnRyb2xsYWJsZSwgdHJ5IHRvIGNoYW5nZSB0byBhbm90aGVyIG9uZQ0KCQkJCWlmICh0aGlzLmN1cnJlbnRUb29sKSB7DQoJCQkJCXRoaXMuZmFuID0gLTE7DQoJCQkJfSBlbHNlIHsNCgkJCQkJdGhpcy5mYW4gPSB0aGlzLmZhbnMuZmluZEluZGV4KGZhbiA9PiBmYW4gJiYgIWZhbi50aGVybW9zdGF0aWMuY29udHJvbCk7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfSwNCgltb3VudGVkKCkgew0KCQl0aGlzLnVwZGF0ZUZhblNlbGVjdGlvbigpOw0KCX0sDQoJd2F0Y2g6IHsNCgkJY3VycmVudFRvb2woKSB7DQoJCQl0aGlzLnVwZGF0ZUZhblNlbGVjdGlvbigpOw0KCQl9LA0KCQlmYW5zOiB7DQoJCQlkZWVwOiB0cnVlLA0KCQkJaGFuZGxlcigpIHsNCgkJCQl0aGlzLnVwZGF0ZUZhblNlbGVjdGlvbigpOw0KCQkJfQ0KCQl9DQoJfQ0KfQ0K"},{"version":3,"sources":["FanPanel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"FanPanel.vue","sourceRoot":"src/components/panels","sourcesContent":["<style scoped>\r\n.v-btn-toggle {\r\n\tdisplay: flex;\r\n}\r\n.v-btn-toggle > button {\r\n\tdisplay: flex;\r\n\tflex: 1 1 auto;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-card v-show=\"canControlFans\">\r\n\t\t<v-card-title class=\"pb-0\">\r\n\t\t\t<v-icon small class=\"mr-1\">mdi-fan</v-icon> {{ $t('panel.fan.caption') }}\r\n\t\t</v-card-title>\r\n\r\n\t\t<v-card-text class=\"py-0\">\r\n\t\t\t<v-row align=\"start\">\r\n\t\t\t\t<v-col cols=\"12\" sm=\"auto\" order=\"1\" order-sm=\"0\">\r\n\t\t\t\t\t<p class=\"mb-1\">\r\n\t\t\t\t\t\t{{ $t('panel.fan.selection') }}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<v-btn-toggle v-model=\"fan\" mandatory>\r\n\t\t\t\t\t\t<v-btn v-if=\"currentTool && currentTool.fans.length > 0\" :value=\"-1\">\r\n\t\t\t\t\t\t\t{{ $t('panel.fan.toolFan') }}\r\n\t\t\t\t\t\t</v-btn>\r\n\r\n\r\n\t\t\t\t\t\t<template v-for=\"(fan, index) in fans\">\r\n\t\t\t\t\t\t\t<v-btn v-if=\"fan && fan.thermostatic.heaters.length === 0\" :key=\"index\" :value=\"index\" :disabled=\"uiFrozen\">\r\n\t\t\t\t\t\t\t\t{{ fan.name ? fan.name : $t('panel.fan.fan', [index]) }}\r\n\t\t\t\t\t\t\t</v-btn>\r\n\t\t\t\t\t\t</template>\r\n\t\t\t\t\t</v-btn-toggle>\r\n\t\t\t\t</v-col>\r\n\r\n\t\t\t\t<v-col cols=\"12\" sm=\"auto\" order=\"0\" order-sm=\"1\" class=\"flex-sm-grow-1\">\r\n\t\t\t\t\t<slider v-model=\"fanValue\" :disabled=\"uiFrozen\"></slider>\r\n\t\t\t\t</v-col>\r\n\t\t\t</v-row>\r\n\t\t</v-card-text>\r\n\t</v-card>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapState, mapGetters, mapActions } from 'vuex'\r\n\r\nexport default {\r\n\tcomputed: {\r\n\t\t...mapState('machine/model', ['fans']),\r\n\t\t...mapGetters(['uiFrozen']),\r\n\t\t...mapGetters('machine/model', ['currentTool']),\r\n\t\tcanControlFans() {\r\n\t\t\treturn !this.uiFrozen && ((this.currentTool && this.currentTool.fans.length > 0) || (this.fans.some(fan => fan && !fan.thermostatic.control)));\r\n\t\t},\r\n\t\tfanValue: {\r\n\t\t\tget() {\r\n\t\t\t\t// Even though RRF allows multiple fans to be assigned to a tool,\r\n\t\t\t\t// we assume they all share the same fan value if such a config is set\r\n\t\t\t\tconst fan = (this.fan === -1)\r\n\t\t\t\t\t? ((this.currentTool && this.currentTool.fans.length > 0) ? this.currentTool.fans[0] : -1)\r\n\t\t\t\t\t: this.fan;\r\n\t\t\t\treturn (fan >= 0 && fan < this.fans.length && this.fans[fan]) ? Math.round(this.fans[fan].requestedValue * 100) : 0;\r\n\t\t\t},\r\n\t\t\tset(value) {\r\n\t\t\t\tvalue = Math.min(100, Math.max(0, value)) / 100;\r\n\t\t\t\tif (this.fan === -1) {\r\n\t\t\t\t\tthis.sendCode(`M106 S${value.toFixed(2)}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.sendCode(`M106 P${this.fan} S${value.toFixed(2)}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tfan: -1\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['sendCode']),\r\n\t\tupdateFanSelection() {\r\n\t\t\tif (this.fan === -1) {\r\n\t\t\t\tif (!this.currentTool) {\r\n\t\t\t\t\t// Tool no longer selected, try to change to the first available fan\r\n\t\t\t\t\tthis.fan = this.fans.findIndex(fan => fan && !fan.thermostatic.control);\r\n\t\t\t\t}\r\n\t\t\t} else if (this.fan >= this.fans.length || (this.fan !== -1 && this.fans[this.fan] && this.fans[this.fan].thermostatic.control)) {\r\n\t\t\t\t// Selected fan is no longer controllable, try to change to another one\r\n\t\t\t\tif (this.currentTool) {\r\n\t\t\t\t\tthis.fan = -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.fan = this.fans.findIndex(fan => fan && !fan.thermostatic.control);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.updateFanSelection();\r\n\t},\r\n\twatch: {\r\n\t\tcurrentTool() {\r\n\t\t\tthis.updateFanSelection();\r\n\t\t},\r\n\t\tfans: {\r\n\t\t\tdeep: true,\r\n\t\t\thandler() {\r\n\t\t\t\tthis.updateFanSelection();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"]}]}