{"remainingRequest":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\inputs\\CodeInput.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\src\\components\\inputs\\CodeInput.vue","mtime":1592248188531},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\jpatrick\\Documents\\GitHub\\DuetWebControl_Fork\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQondXNlIHN0cmljdCcNCg0KaW1wb3J0IHsgbWFwU3RhdGUsIG1hcEdldHRlcnMsIG1hcEFjdGlvbnMsIG1hcE11dGF0aW9ucyB9IGZyb20gJ3Z1ZXgnDQoNCmNvbnN0IGNvbmRpdGlvbmFsS2V5d29yZHMgPSBbJ2Fib3J0JywgJ2VjaG8nLCAnaWYnLCAnZWxpZicsICdlbHNlJywgJ3doaWxlJywgJ2JyZWFrJywgJ3ZhcicsICdzZXQnXTsNCg0KZXhwb3J0IGRlZmF1bHQgew0KCWNvbXB1dGVkOiB7DQoJCS4uLm1hcEdldHRlcnMoWyd1aUZyb3plbiddKSwNCgkJLi4ubWFwU3RhdGUoJ21hY2hpbmUvc2V0dGluZ3MnLCBbJ2NvZGVzJ10pLA0KCQkuLi5tYXBTdGF0ZSgnc2V0dGluZ3MnLCBbJ2Rpc2FibGVBdXRvQ29tcGxldGUnXSksDQoJCWRpc3BsYXllZENvZGVzKCkgew0KCQkJaWYgKHRoaXMuc2hvd0l0ZW1zICYmICF0aGlzLmRpc2FibGVBdXRvQ29tcGxldGUpIHsNCgkJCQljb25zdCBjdXJyZW50Q29kZSA9IHRoaXMuY29kZSA/IHRoaXMuY29kZS50b0xvd2VyQ2FzZSgpIDogJyc7DQoJCQkJcmV0dXJuIHRoaXMuY29kZXMNCgkJCQkJLmZpbHRlcihjb2RlID0+IChjdXJyZW50Q29kZSA9PT0gJycpIHx8IChjb2RlLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihjdXJyZW50Q29kZSkgIT09IC0xKSkNCgkJCQkJLm1hcChjb2RlID0+ICh7IHRleHQ6IGNvZGUsIHZhbHVlOiBjb2RlIH0pKTsNCgkJCX0NCgkJCXJldHVybiBbXTsNCgkJfQ0KCX0sDQoJZGF0YSgpIHsNCgkJcmV0dXJuIHsNCgkJCWNvZGU6ICcnLA0KCQkJd2FzRm9jdXNlZDogZmFsc2UsDQoJCQlzaG93SXRlbXM6IGZhbHNlLA0KCQkJc2VsZWN0ZWRJdGVtOiAnJywNCgkJCXNlbmRQZW5kaW5nOiBmYWxzZSwNCgkJCWRvaW5nQ29kZTogZmFsc2UNCgkJfQ0KCX0sDQoJcHJvcHM6IHsNCgkJZ3JvdzogQm9vbGVhbiwNCgkJc29sbzogQm9vbGVhbg0KCX0sDQoJbWV0aG9kczogew0KCQkuLi5tYXBBY3Rpb25zKCdtYWNoaW5lJywgWydzZW5kQ29kZSddKSwNCgkJLi4ubWFwTXV0YXRpb25zKCdtYWNoaW5lL3NldHRpbmdzJywgWydhZGRDb2RlJywgJ3JlbW92ZUNvZGUnXSksDQoJCWNsaWNrKCkgew0KCQkJaWYgKHRoaXMud2FzRm9jdXNlZCkgew0KCQkJCXRoaXMuc2hvd0l0ZW1zID0gIXRoaXMuc2hvd0l0ZW1zOw0KCQkJfSBlbHNlIHsNCgkJCQl0aGlzLndhc0ZvY3VzZWQgPSB0cnVlOw0KCQkJfQ0KCQl9LA0KCQl1cGRhdGVTZWxlY3Rpb24oc2VsZWN0aW9uKSB7DQoJCQlpZiAoc2VsZWN0aW9uIGluc3RhbmNlb2YgQXJyYXkpIHsNCgkJCQlzZWxlY3Rpb24gPSAoc2VsZWN0aW9uLmxlbmd0aCA+IDApID8gc2VsZWN0aW9uWzBdIDogLTE7DQoJCQl9DQoNCgkJCWNvbnN0IGl0ZW1zID0gdGhpcy5kaXNwbGF5ZWRDb2RlczsNCgkJCWlmIChzZWxlY3Rpb24gPj0gMCAmJiBzZWxlY3Rpb24gPCBpdGVtcy5sZW5ndGgpIHsNCgkJCQl0aGlzLnNlbGVjdGVkSXRlbSA9IGl0ZW1zW3NlbGVjdGlvbl0udmFsdWU7DQoJCQl9IGVsc2Ugew0KCQkJCXRoaXMuc2VsZWN0ZWRJdGVtID0gJyc7DQoJCQl9DQoJCX0sDQoJCXNlbGVjdEl0ZW0oZSkgew0KCQkJaWYgKHRoaXMuc2VsZWN0ZWRJdGVtICE9PSAnJykgew0KCQkJCXRoaXMuY29kZSA9IHRoaXMuc2VsZWN0ZWRJdGVtOw0KCQkJCXRoaXMuc2hvd0l0ZW1zID0gZmFsc2U7DQoJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOw0KCQkJfQ0KCQl9LA0KCQljaGFuZ2UodmFsdWUpIHsNCgkJCWlmICh2YWx1ZSAmJiAhKHZhbHVlIGluc3RhbmNlb2YgU3RyaW5nKSkgew0KCQkJCXRoaXMuY29kZSA9IHZhbHVlLnZhbHVlOw0KCQkJfQ0KCQl9LA0KCQlkb1NlbmQoKSB7DQoJCQlpZiAodGhpcy4kcmVmcy5pbnB1dC5pc01lbnVBY3RpdmUpIHsNCgkJCQl0aGlzLiRyZWZzLmlucHV0LmlzTWVudUFjdGl2ZSA9IGZhbHNlOwkJLy8gRklYTUUgVGhlcmUgbXVzdCBiZSBhIGJldHRlciBzb2x1dGlvbiB0aGFuIHRoaXMNCgkJCQl0aGlzLnNlbmRQZW5kaW5nID0gdHJ1ZTsNCgkJCX0gZWxzZSB7DQoJCQkJdGhpcy5zZW5kKCk7DQoJCQl9DQoJCX0sDQoJCWhhc1VucHJlY2VkZW50ZWRQYXJhbWV0ZXJzOiAoY29kZSkgPT4gIWNvZGUgfHwgLyhNMjN8TTI4fE0zMHxNMzJ8TTM2fE0xMTcpW14wLTldL2kudGVzdChjb2RlKSwNCgkJYXN5bmMgc2VuZCgpIHsNCgkJCXRoaXMuJHJlZnMuaW5wdXQuaXNNZW51QWN0aXZlID0gZmFsc2U7CQkJLy8gRklYTUUgVGhlcmUgbXVzdCBiZSBhIGJldHRlciBzb2x1dGlvbiB0aGFuIHRoaXMNCg0KCQkJY29uc3QgY29kZSA9ICh0aGlzLmNvZGUuY29uc3RydWN0b3IgPT09IFN0cmluZykgPyB0aGlzLmNvZGUgOiB0aGlzLmNvZGUudmFsdWU7DQoJCQlpZiAoY29kZSAmJiBjb2RlLnRyaW0oKSAhPT0gJycgJiYgIXRoaXMuZG9pbmdDb2RlKSB7DQoJCQkJbGV0IGNvZGVUb1NlbmQgPSAnJywgYmFyZUNvZGUgPSAnJywgaW5RdW90ZXMgPSBmYWxzZSwgaW5FeHByZXNzaW9uID0gZmFsc2UsIGluV2hpdGVTcGFjZSA9IGZhbHNlLCBpbkNvbW1lbnQgPSBmYWxzZTsNCgkJCQlpZiAoIXRoaXMuaGFzVW5wcmVjZWRlbnRlZFBhcmFtZXRlcnMoY29kZVRvU2VuZCkgJiYNCgkJCQkJIWNvbmRpdGlvbmFsS2V5d29yZHMuc29tZShrZXl3b3JkID0+IGNvZGUudHJpbSgpLnN0YXJ0c1dpdGgoa2V5d29yZCkpKSB7DQoJCQkJCS8vIENvbnZlcnQgY29kZSB0byB1cHBlci1jYXNlIGFuZCByZW1vdmUgY29tbWVudHMNCgkJCQkJZm9yIChsZXQgaSA9IDA7IGkgPCBjb2RlLmxlbmd0aDsgaSsrKSB7DQoJCQkJCQljb25zdCBjaGFyID0gY29kZVtpXTsNCgkJCQkJCWlmIChpblF1b3Rlcykgew0KCQkJCQkJCWlmIChpIDwgY29kZS5sZW5ndGggLSAxICYmIGNoYXIgPT09ICdcXCcgJiYgY29kZVtpICsgMV0gPT09ICciJykgew0KCQkJCQkJCQljb2RlVG9TZW5kICs9ICdcXCInOw0KCQkJCQkJCQlpKys7DQoJCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkJaWYgKGNoYXIgPT09ICciJykgew0KCQkJCQkJCQkJaW5RdW90ZXMgPSBmYWxzZTsNCgkJCQkJCQkJfQ0KCQkJCQkJCQljb2RlVG9TZW5kICs9IGNoYXI7DQoJCQkJCQkJfQ0KCQkJCQkJfSBlbHNlIGlmIChpbkV4cHJlc3Npb24pIHsNCgkJCQkJCQljb2RlVG9TZW5kICs9IGNoYXI7DQoJCQkJCQkJaW5FeHByZXNzaW9uID0gKGNoYXIgIT09ICd9Jyk7DQoJCQkJCQl9IGVsc2UgaWYgKGluQ29tbWVudCkgew0KCQkJCQkJCWNvZGVUb1NlbmQgKz0gY2hhcjsNCgkJCQkJCQlpbkNvbW1lbnQgPSAoY2hhciAhPT0gJyknKTsNCgkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJaWYgKGNoYXIgPT09ICciJykgew0KCQkJCQkJCQkvLyBkb24ndCBjb252ZXJ0IGVzY2FwZWQgc3RyaW5ncw0KCQkJCQkJCQlpblF1b3RlcyA9IHRydWU7DQoJCQkJCQkJfSBlbHNlIGlmIChjaGFyID09PSAnICcgfHwgY2hhciA9PT0gJ1x0Jykgew0KCQkJCQkJCQkvLyByZW1vdmUgZHVwbGljYXRlIHdoaXRlIHNwYWNlcw0KCQkJCQkJCQlpZiAoaW5XaGl0ZVNwYWNlKSB7DQoJCQkJCQkJCQljb250aW51ZTsNCgkJCQkJCQkJfQ0KCQkJCQkJCQlpbldoaXRlU3BhY2UgPSB0cnVlOw0KCQkJCQkJCX0gZWxzZSBpZiAoY2hhciA9PT0gJzsnKSB7DQoJCQkJCQkJCS8vIHN0b3Agd2hlbiBmaW5hbCBjb21tZW50cyBzdGFydA0KCQkJCQkJCQlicmVhazsNCgkJCQkJCQl9IGVsc2UgaWYgKGNoYXIgPT09ICcoJykgew0KCQkJCQkJCQkvLyBkb24ndCBwcm9jZXNzIGNoYXJzIGZyb20gZW5jYXBzdWxhdGVkIGNvbW1lbnRzDQoJCQkJCQkJCWluQ29tbWVudCA9IHRydWU7DQoJCQkJCQkJfSBlbHNlIGlmIChjaGFyID09PSAneycpIHsNCgkJCQkJCQkJLy8gZG9uJ3QgcHJvY2VzcyBjaGFycyBmcm9tIGV4cHJlc3Npb25zDQoJCQkJCQkJCWluRXhwcmVzc2lvbiA9IHRydWU7DQoJCQkJCQkJfQ0KCQkJCQkJCWluV2hpdGVTcGFjZSA9IGZhbHNlOw0KCQkJCQkJCWNvZGVUb1NlbmQgKz0gY2hhci50b1VwcGVyQ2FzZSgpOw0KCQkJCQkJCWJhcmVDb2RlICs9IGNvZGUudG9VcHBlckNhc2UoKTsNCgkJCQkJCX0NCgkJCQkJfQ0KCQkJCX0gZWxzZSB7DQoJCQkJCS8vIERvbid0IG1vZGlmeSB0aGUgdXNlciBpbnB1dA0KCQkJCQljb2RlVG9TZW5kID0gY29kZTsNCgkJCQl9DQoNCgkJCQkvLyBTZW5kIHRoZSBjb2RlIGFuZCB3YWl0IGZvciBjb21wbGV0aW9uDQoJCQkJdGhpcy5kb2luZ0NvZGUgPSB0cnVlOw0KCQkJCXRyeSB7DQoJCQkJCWNvbnN0IHJlcGx5ID0gYXdhaXQgdGhpcy5zZW5kQ29kZSh7IGNvZGU6IGNvZGVUb1NlbmQsIGZyb21JbnB1dDogdHJ1ZSB9KTsNCgkJCQkJaWYgKCFpblF1b3RlcyAmJiAhcmVwbHkuc3RhcnRzV2l0aCgnRXJyb3I6ICcpICYmICFyZXBseS5zdGFydHNXaXRoKCdXYXJuaW5nOiAnKSAmJg0KCQkJCQkJYmFyZUNvZGUuaW5kZXhPZignTTU4NycpID09PSAtMSAmJiBiYXJlQ29kZS5pbmRleE9mKCdNNTg5JykgPT09IC0xICYmDQoJCQkJCQkhdGhpcy5kaXNhYmxlQXV0b0NvbXBsZXRlICYmIHRoaXMuY29kZXMuaW5kZXhPZihjb2RlVG9TZW5kLnRyaW0oKSkgPT09IC0xKSB7DQoJCQkJCQkvLyBBdXRvbWF0aWNhbGx5IHJlbWVtYmVyIHN1Y2Nlc3NmdWwgY29kZXMNCgkJCQkJCXRoaXMuYWRkQ29kZShjb2RlVG9TZW5kLnRyaW0oKSk7DQoJCQkJCX0NCgkJCQl9IGNhdGNoIHsNCgkJCQkJLy8gaGFuZGxlZCBiZWZvcmUgd2UgZ2V0IGhlcmUNCgkJCQl9DQoJCQkJdGhpcy5kb2luZ0NvZGUgPSBmYWxzZTsNCgkJCX0NCgkJfQ0KCX0sDQoJd2F0Y2g6IHsNCgkJY29kZSh0bykgew0KCQkJaWYgKHRvICYmIHRvLmxlbmd0aCA+PSAyKSB7DQoJCQkJdGhpcy5zaG93SXRlbXMgPSB0cnVlOw0KCQkJfQ0KCQl9LA0KCQl1aUZyb3plbih0bykgew0KCQkJaWYgKHRvKSB7DQoJCQkJLy8gQ2xlYXIgaW5wdXQgd2hlbiB0aGUgVUkgaXMgZnJvemVuDQoJCQkJdGhpcy5jb2RlID0gJyc7DQoJCQl9DQoJCX0NCgl9DQp9DQo="},{"version":3,"sources":["CodeInput.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CodeInput.vue","sourceRoot":"src/components/inputs","sourcesContent":["<style scoped>\r\n.grow {\r\n\tflex-grow: 1;\r\n}\r\n</style>\r\n\r\n<template>\r\n\t<v-row class=\"component flex-shrink-1\" :class=\"{ 'mt-2' : solo, 'grow' : grow }\" no-gutters align=\"center\">\r\n\t\t<v-col>\r\n\t\t\t<v-combobox ref=\"input\" :solo=\"solo\" hide-details :disabled=\"uiFrozen\" :placeholder=\"$t('input.code.placeholder')\"\r\n\t\t\t\t\t\t:search-input.sync=\"code\" @click=\"click\" :loading=\"doingCode\" @keyup.enter=\"send\" @change=\"change\" @blur=\"wasFocused = showItems = false\"\r\n\t\t\t\t\t\t:items=\"displayedCodes\" @update:list-index=\"updateSelection\" @keyup.down=\"showItems = true\" @keyup.tab.exact=\"selectItem\" hide-selected>\r\n\t\t\t\t<template #item=\"{ item }\">\r\n\t\t\t\t\t<code>{{ item.text }}</code>\r\n\t\t\t\t\t<v-spacer></v-spacer>\r\n\t\t\t\t\t<v-btn icon @click.prevent.stop=\"removeCode(item.value)\">\r\n\t\t\t\t\t\t<v-icon>mdi-delete</v-icon>\r\n\t\t\t\t\t</v-btn>\r\n\t\t\t\t</template>\r\n\t\t\t</v-combobox>\r\n\t\t</v-col>\r\n\r\n\t\t<v-col class=\"ml-2 flex-shrink-1\" cols=\"auto\">\r\n\t\t\t<v-btn color=\"info\" :disabled=\"uiFrozen\" :loading=\"doingCode\" @click=\"doSend\">\r\n\t\t\t\t<v-icon class=\"mr-2\">mdi-send</v-icon> {{ $t('input.code.send') }} \r\n\t\t\t</v-btn>\r\n\t\t</v-col>\r\n\t</v-row>\r\n</template>\r\n\r\n<script>\r\n'use strict'\r\n\r\nimport { mapState, mapGetters, mapActions, mapMutations } from 'vuex'\r\n\r\nconst conditionalKeywords = ['abort', 'echo', 'if', 'elif', 'else', 'while', 'break', 'var', 'set'];\r\n\r\nexport default {\r\n\tcomputed: {\r\n\t\t...mapGetters(['uiFrozen']),\r\n\t\t...mapState('machine/settings', ['codes']),\r\n\t\t...mapState('settings', ['disableAutoComplete']),\r\n\t\tdisplayedCodes() {\r\n\t\t\tif (this.showItems && !this.disableAutoComplete) {\r\n\t\t\t\tconst currentCode = this.code ? this.code.toLowerCase() : '';\r\n\t\t\t\treturn this.codes\r\n\t\t\t\t\t.filter(code => (currentCode === '') || (code.toLowerCase().indexOf(currentCode) !== -1))\r\n\t\t\t\t\t.map(code => ({ text: code, value: code }));\r\n\t\t\t}\r\n\t\t\treturn [];\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tcode: '',\r\n\t\t\twasFocused: false,\r\n\t\t\tshowItems: false,\r\n\t\t\tselectedItem: '',\r\n\t\t\tsendPending: false,\r\n\t\t\tdoingCode: false\r\n\t\t}\r\n\t},\r\n\tprops: {\r\n\t\tgrow: Boolean,\r\n\t\tsolo: Boolean\r\n\t},\r\n\tmethods: {\r\n\t\t...mapActions('machine', ['sendCode']),\r\n\t\t...mapMutations('machine/settings', ['addCode', 'removeCode']),\r\n\t\tclick() {\r\n\t\t\tif (this.wasFocused) {\r\n\t\t\t\tthis.showItems = !this.showItems;\r\n\t\t\t} else {\r\n\t\t\t\tthis.wasFocused = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tupdateSelection(selection) {\r\n\t\t\tif (selection instanceof Array) {\r\n\t\t\t\tselection = (selection.length > 0) ? selection[0] : -1;\r\n\t\t\t}\r\n\r\n\t\t\tconst items = this.displayedCodes;\r\n\t\t\tif (selection >= 0 && selection < items.length) {\r\n\t\t\t\tthis.selectedItem = items[selection].value;\r\n\t\t\t} else {\r\n\t\t\t\tthis.selectedItem = '';\r\n\t\t\t}\r\n\t\t},\r\n\t\tselectItem(e) {\r\n\t\t\tif (this.selectedItem !== '') {\r\n\t\t\t\tthis.code = this.selectedItem;\r\n\t\t\t\tthis.showItems = false;\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t},\r\n\t\tchange(value) {\r\n\t\t\tif (value && !(value instanceof String)) {\r\n\t\t\t\tthis.code = value.value;\r\n\t\t\t}\r\n\t\t},\r\n\t\tdoSend() {\r\n\t\t\tif (this.$refs.input.isMenuActive) {\r\n\t\t\t\tthis.$refs.input.isMenuActive = false;\t\t// FIXME There must be a better solution than this\r\n\t\t\t\tthis.sendPending = true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.send();\r\n\t\t\t}\r\n\t\t},\r\n\t\thasUnprecedentedParameters: (code) => !code || /(M23|M28|M30|M32|M36|M117)[^0-9]/i.test(code),\r\n\t\tasync send() {\r\n\t\t\tthis.$refs.input.isMenuActive = false;\t\t\t// FIXME There must be a better solution than this\r\n\r\n\t\t\tconst code = (this.code.constructor === String) ? this.code : this.code.value;\r\n\t\t\tif (code && code.trim() !== '' && !this.doingCode) {\r\n\t\t\t\tlet codeToSend = '', bareCode = '', inQuotes = false, inExpression = false, inWhiteSpace = false, inComment = false;\r\n\t\t\t\tif (!this.hasUnprecedentedParameters(codeToSend) &&\r\n\t\t\t\t\t!conditionalKeywords.some(keyword => code.trim().startsWith(keyword))) {\r\n\t\t\t\t\t// Convert code to upper-case and remove comments\r\n\t\t\t\t\tfor (let i = 0; i < code.length; i++) {\r\n\t\t\t\t\t\tconst char = code[i];\r\n\t\t\t\t\t\tif (inQuotes) {\r\n\t\t\t\t\t\t\tif (i < code.length - 1 && char === '\\\\' && code[i + 1] === '\"') {\r\n\t\t\t\t\t\t\t\tcodeToSend += '\\\\\"';\r\n\t\t\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (char === '\"') {\r\n\t\t\t\t\t\t\t\t\tinQuotes = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcodeToSend += char;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (inExpression) {\r\n\t\t\t\t\t\t\tcodeToSend += char;\r\n\t\t\t\t\t\t\tinExpression = (char !== '}');\r\n\t\t\t\t\t\t} else if (inComment) {\r\n\t\t\t\t\t\t\tcodeToSend += char;\r\n\t\t\t\t\t\t\tinComment = (char !== ')');\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (char === '\"') {\r\n\t\t\t\t\t\t\t\t// don't convert escaped strings\r\n\t\t\t\t\t\t\t\tinQuotes = true;\r\n\t\t\t\t\t\t\t} else if (char === ' ' || char === '\\t') {\r\n\t\t\t\t\t\t\t\t// remove duplicate white spaces\r\n\t\t\t\t\t\t\t\tif (inWhiteSpace) {\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tinWhiteSpace = true;\r\n\t\t\t\t\t\t\t} else if (char === ';') {\r\n\t\t\t\t\t\t\t\t// stop when final comments start\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t} else if (char === '(') {\r\n\t\t\t\t\t\t\t\t// don't process chars from encapsulated comments\r\n\t\t\t\t\t\t\t\tinComment = true;\r\n\t\t\t\t\t\t\t} else if (char === '{') {\r\n\t\t\t\t\t\t\t\t// don't process chars from expressions\r\n\t\t\t\t\t\t\t\tinExpression = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tinWhiteSpace = false;\r\n\t\t\t\t\t\t\tcodeToSend += char.toUpperCase();\r\n\t\t\t\t\t\t\tbareCode += code.toUpperCase();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Don't modify the user input\r\n\t\t\t\t\tcodeToSend = code;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Send the code and wait for completion\r\n\t\t\t\tthis.doingCode = true;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst reply = await this.sendCode({ code: codeToSend, fromInput: true });\r\n\t\t\t\t\tif (!inQuotes && !reply.startsWith('Error: ') && !reply.startsWith('Warning: ') &&\r\n\t\t\t\t\t\tbareCode.indexOf('M587') === -1 && bareCode.indexOf('M589') === -1 &&\r\n\t\t\t\t\t\t!this.disableAutoComplete && this.codes.indexOf(codeToSend.trim()) === -1) {\r\n\t\t\t\t\t\t// Automatically remember successful codes\r\n\t\t\t\t\t\tthis.addCode(codeToSend.trim());\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch {\r\n\t\t\t\t\t// handled before we get here\r\n\t\t\t\t}\r\n\t\t\t\tthis.doingCode = false;\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tcode(to) {\r\n\t\t\tif (to && to.length >= 2) {\r\n\t\t\t\tthis.showItems = true;\r\n\t\t\t}\r\n\t\t},\r\n\t\tuiFrozen(to) {\r\n\t\t\tif (to) {\r\n\t\t\t\t// Clear input when the UI is frozen\r\n\t\t\t\tthis.code = '';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n"]}]}